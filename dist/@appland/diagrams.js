!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3")):"function"==typeof define&&define.amd?define(["exports","d3"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).Appmap={},t.d3)}(this,(function(t,e){"use strict";function n(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var r=n(e),i=function(t){return function(t){return!!t&&"object"==typeof t}(t)&&!function(t){var e=Object.prototype.toString.call(t);return"[object RegExp]"===e||"[object Date]"===e||function(t){return t.$$typeof===o}(t)}(t)};var o="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function a(t,e){return!1!==e.clone&&e.isMergeableObject(t)?h((n=t,Array.isArray(n)?[]:{}),t,e):t;var n}function s(t,e,n){return t.concat(e).map((function(t){return a(t,n)}))}function u(t){return Object.keys(t).concat(function(t){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter((function(e){return t.propertyIsEnumerable(e)})):[]}(t))}function c(t,e){try{return e in t}catch(t){return!1}}function l(t,e,n){var r={};return n.isMergeableObject(t)&&u(t).forEach((function(e){r[e]=a(t[e],n)})),u(e).forEach((function(i){(function(t,e){return c(t,e)&&!(Object.hasOwnProperty.call(t,e)&&Object.propertyIsEnumerable.call(t,e))})(t,i)||(c(t,i)&&n.isMergeableObject(e[i])?r[i]=function(t,e){if(!e.customMerge)return h;var n=e.customMerge(t);return"function"==typeof n?n:h}(i,n)(t[i],e[i],n):r[i]=a(e[i],n))})),r}function h(t,e,n){(n=n||{}).arrayMerge=n.arrayMerge||s,n.isMergeableObject=n.isMergeableObject||i,n.cloneUnlessOtherwiseSpecified=a;var r=Array.isArray(e);return r===Array.isArray(t)?r?n.arrayMerge(t,e,n):l(t,e,n):a(e,n)}h.all=function(t,e){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce((function(t,n){return h(t,n,e)}),{})};var f=h;class d{constructor(t=0,e=0,n=1){this.x=t,this.y=e,this.k=n}toString(){return[0!==this.x?`translateX(${this.x}px)`:null,0!==this.y?`translateY(${this.y}px)`:null,1!==this.k?`scale(${this.k}`:null].join(" ")}}var p={contains:(t,e)=>t.top<=e.top&&t.bottom>=e.bottom&&t.left<=e.left&&t.right>=e.right,delta(t,e){let n=0,r=0;return t.left>=e.left?n=t.left-e.left:t.right<=e.right&&(n=t.right-e.right),t.top>=e.top?r=t.top-e.top:t.bottom<=e.bottom&&(r=t.bottom-e.bottom),{x:n,y:r}},shift:(t,e)=>new d(t.x-e.x,t.y-e.y),Transform:d};e.scaleOrdinal().range(e.schemeCategory10.map((t=>{const n=e.rgb(t);return n.opacity=.05,n}))),e.scaleOrdinal().range(e.schemeCategory10.map((t=>{const n=e.rgb(t);return n.opacity=.8,n})));const v=Object.prototype.hasOwnProperty,g=t=>"string"!=typeof t?"":t.slice(0,1).toUpperCase()+t.slice(1).toLowerCase(),E=t=>null===/[A-Z]/.exec(t)?16:1,m=t=>{const e=t.length;if(e<1)return[];const n=(t=>t.length<=2?null:{firstCase:E(t[0]),secondCase:E(t[1])})(t);if(!n)return[t];const{firstCase:r,secondCase:i}=n,o=[];let a=!1;for(let n=2;n<e;n+=1){const e=E(t[n]);if(1===e){if(16===r||16===i){const e=t.slice(0,n);o.push(e),o.push(...m(t.slice(n))),a=!0;break}}else if(16===e&&1===r&&1===i){const e=t.slice(0,n-1);o.push(e),o.push(...m(t.slice(n-1))),a=!0;break}}return a||o.push(t),o},y=new Set(["insert","update","select","delete","alter","create","drop","rename","truncate","replace","savepoint","release","rollback","lock","unlock","set","start","call","delete","do","perform","handler","load","purge","reset","prepare","execute","deallocate","xa"]),_=t=>{let e=(t=>{if(!1===v.call(t,"http_server_request"))return null;const e=t.http_server_request.request_method,n=t.http_server_request.path_info;let r;try{r=`${e} ${new URL(n,"http://hostname").pathname}`}catch(t){r="HTTP Request"}return r})(t);return e||(e=(t=>{if(!1===v.call(t,"sql_query"))return null;const e=[...(t.sql_query.normalized_sql||t.sql_query.sql||"").trimLeft()];e.length>0&&"("===e[0]&&e.shift();let n=0;const r=e.reduce(((t,e)=>("("===e&&++n,0===n&&t.push(e),")"===e&&--n,t)),[]).join("");let i=null;return i=-1===r.search(/\s/)?r:r.replace(/[^\w]+/g," ").toLowerCase().split(" ").find((t=>y.has(t))),["SQL",g(i)||null].join(" ")})(t)),e};const N={github:t=>{const e=t.url.match(/github.com[:|/]?(.*).git/);if(!e||e.length<=1)return;const n="number"==typeof t.lineNumber?`#L${t.lineNumber}`:"";return`https://github.com/${e[1]}/blob/${t.commit}/${t.path}${n}`}};function T(t){const e={...t};return Object.keys(t).forEach((n=>{const r=t[n];Array.isArray(r)?e[n]=new Set(r):r instanceof Set?e[n]=r:e[n]=r&&"object"==typeof r?T(r):r})),e}function w(t,e){return!!e&&p.contains(t.element.getBoundingClientRect(),e.getBoundingClientRect())}function b(t,e=document,n=""){const r=Array.from(e.querySelectorAll(n));let i=t;for(;i&&!r.includes(i);)i=i.parentNode;return i}var A="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function R(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function O(t,e,n){return t(n={path:e,exports:{},require:function(t,e){return S(null==e&&n.path)}},n.exports),n.exports}function S(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var I=O((function(t,e){!function(t){function e(t,e){let n=t.listeners[e];return n||(n=[],t.listeners[e]=n),n}class n{constructor(){this.listeners={},this.anyListeners=[]}once(t,n){return e(this,t).push({fn:n,once:!0}),this}on(t,n){return e(this,t).push({fn:n}),this}off(t,e){const n=this.listeners[t];if(n){const r=n.filter((t=>t.fn&&t.fn!==e));0===r.length?delete this.listeners[t]:r.length!==n.length&&(this.listeners[t]=r)}return this}emit(t,e){const n=this.listeners[t];if(n){let r=!1;n.forEach((n=>{n.once&&(r=!0);try{n.fn(e)}catch(e){console.error(`error occurred while executing event ${t}`),console.error(e)}})),r&&(this.listeners[t]=this.listeners[t].filter((t=>!t.once)))}return this.anyListeners.forEach((n=>n.emit(t,e))),this}pipe(t,...e){return e.length?(e.forEach((e=>t.on(e,(t=>this.emit(t))))),this):(t.any(this),this)}any(t){return this.anyListeners.push(t),this}}class r{constructor(t,e){this.data=t,this.parent=e,this.children=[],this.parent&&this.parent.children.push(this)}get id(){const t=this.buildId();if(this.parent&&"function"===this.type){const e=this.static?".":"#";t[t.length-2]=e}return t.join("")}get name(){return this.data.name}get type(){return this.data.type}get static(){return this.data.static}get location(){return this.data.location}get locations(){switch(this.type){case"package":return[];case"class":return Array.from(this.classLocations()).sort();case"function":return[this.location]}}get packageOf(){const t=this.collectAncestors("package");return 0===t.length?null:t.join("/")}get classOf(){const t=this.collectAncestors("class");return 0===t.length?null:t.join("::")}visit(t,e=[]){e.push(this),t(this,e),this.children.forEach((n=>n.visit(t,e))),e.pop()}buildId(t=[]){if(this.parent){let e;switch(this.parent.buildId(t),this.parent.type){case"package":e="/";break;case"class":e="::"}t.push(e)}return t.push(this.name),t}collectAncestors(t,e=[]){return this.parent&&this.parent.collectAncestors(t,e),this.type===t&&e.push(this.name),e}classLocations(t=new Set){if(this.children.forEach((e=>e.classLocations(t))),"function"===this.type){const e=this.data.location.split(":",2);t.add(e[0])}return t}toJSON(){const t={name:this.data.name,type:this.data.type};return"function"===this.data.type&&(t.static=this.data.static,t.location=this.data.location),this.children.length>0&&(t.children=this.children),t}}class i{constructor(t){function e(t,n=null){const i=new r(t,n);return this.codeObjects.push(i),this.codeObjectsById[i.id]=i,(t.children||[]).forEach((t=>{e.bind(this)(t,i)})),"package"!==i.type&&i.locations.forEach((t=>{let e=this.codeObjectsByLocation[t];e||(e=[],this.codeObjectsByLocation[t]=e),e.push(i)})),i}this.codeObjectsByLocation={},this.codeObjects=[],this.codeObjectsById={},this.roots=t.map((t=>e.bind(this)(t)))}visit(t){this.roots.forEach((e=>e.visit(t)))}search(t){const e=t.toLowerCase();return this.codeObjects.filter((t=>-1!==t.id.toLowerCase().indexOf(e)))}codeObjectFromId(t){return this.codeObjectsById[t]}codeObjectsAtLocation(t){return this.codeObjectsByLocation[t]||[]}codeObjectFromEvent(t){if(!t)return null;const e=this.codeObjectsByLocation[`${t.path}:${t.lineno}`];return e?e.find((e=>e.data.name===t.method_id&&e.data.static===t.static)):null}toJSON(){return this.codeObjects}}class o{constructor(t={},e={},n=null,r=[]){this.input=t,this.output=e,this.caller=n,this.children=[],this.labels=r}clone(){const t=Object.assign({},this.input),e=Object.assign({},this.output),n=Object.assign([],this.labels),r=new o(t,e,null,n);return this.displayName&&(r.displayName=this.displayName),this.children.forEach((t=>{const e=t.clone();r.addChild(e),e.caller=r})),r}addChild(t){this.children.push(t)}replaceChild(t,e){const n=this.children.indexOf(t);if(-1===n)throw new Error(`${t} not found in call tree`);this.children.splice(n,1,...e),e.forEach((t=>t.caller=this)),t.caller=null}removeChild(t){const e=this.children.indexOf(t);if(e<0)throw new Error(`${t} found orphaned by ${this} !`);this.children.splice(e,1)}postOrderForEach(t,e=[]){e.push(this),[...this.children].forEach((n=>n.postOrderForEach(t,e))),t(this,e),e.pop(this)}preOrderForEach(t,e=[]){e.push(this),t(this,e),[...this.children].forEach((n=>n.preOrderForEach(t,e))),e.pop(this)}forEach(t){this.postOrderForEach(t)}filter(t){const e=this.clone();return e.forEach(((e,n)=>{e.isRoot()||t(e,n)||e.caller.replaceChild(e,e.children)})),e}include(t){const e=this.clone();return e.postOrderForEach(((e,n)=>{e.isRoot()||(e.marked_include&&e.caller?e.caller.marked_include=!0:(e.marked_include=t(e,n),e.marked_include?e.caller&&(e.caller.marked_include=!0):e.caller&&e.caller.removeChild(e)))})),e.postOrderForEach((t=>{delete t.marked_include})),e}exclude(t){const e=this.clone();return e.forEach(((e,n)=>{!e.isRoot()&&t(e,n)&&e.caller.removeChild(e)})),e}toArray(){const t=this.children.map((t=>t.toArray())).flat();return this.isRoot()?t:[this,...t]}find(t){if(t(this))return this;for(let e=0;e<this.children.length;e+=1){const n=this.children[e].find(t);if(n)return n}return null}depth(){return this.ancestors().length}ancestors(){const t=[];let e=this.caller;for(;e;)t.push(e),e=e.caller;return t}hasAncestor(t){let e=this;for(;e;){if(e===t)return!0;e=e.caller}return!1}descendants(){return[this,...this.children.map((t=>t.descendants())).flat()]}next(){if(this.children.length>0)return this.children[0];let t=this,e=this.caller;const n=e=>e===t;for(;e;){const r=e.children.findIndex(n);if(r<0)throw new Error(`${this} found orphaned by ${e}!`);if(r<e.children.length-1)return e.children[r+1];t=e,e=e.caller}return null}previous(){const t=this.caller;if(!t)return null;if(1===t.children.length)return t;const e=t.children.findIndex((t=>t===this));if(e<0)throw new Error(`${this.input.id} found orphaned by ${t.input.id}!`);if(e>0){let n=t.children[e-1];for(;n.children.length>0;)n=n.children[n.children.length-1];return n}return t}left(t){const e=t||this.depth();let n=this;for(;;){const t=n.caller;if(!t)return this;const e=t.children.indexOf(n);if(0!==e){n=t.children[e-1];break}n=t}for(;n.depth()!==e;){const{children:t}=n;if(0===t.length)break;n=t[t.length-1]}return n}right(t){const e=t||this.depth();let n=this;for(;;){const t=n.caller;if(!t)return this;const e=t.children,r=e.indexOf(n);if(r!==e.length-1){n=t.children[r+1];break}n=t}for(;n.depth()!==e;){const{children:t}=n;if(0===t.length)break;[n]=t}return n}isRoot(){return null===this.caller}count(){let t=0;return this.forEach((()=>t+=1)),t}get id(){return this.input&&this.input.id?this.input.id:null}}class a extends n{constructor(t,e=(t=>[])){super(),this.dataStore={rootEvent:this.rootNode,selectedEvent:this.rootNode},this.rootEvent=new o;const n=[this.rootEvent];return t.forEach((t=>{if("call"!==t.event)return void(n.length>1&&n.pop());const r=n[n.length-1],i=new o(t,t._return,r,e(t));r.addChild(i),n.push(i)})),this}get rootEvent(){return this.dataStore.rootEvent}set rootEvent(t){this.dataStore.rootEvent=t,this.emit("rootEvent",t)}get selectedEvent(){return this.dataStore.selectedEvent}set selectedEvent(t){this.dataStore.selectedEvent=t,this.emit("selectedEvent",t)}}function s(t,...e){const n={...t};return e.forEach((t=>delete n[t])),n}class u{constructor(t){this.data={...t||{}},this.events=this.data.events,this.classMap=new i(this.data.classMap),this.callTree=new a(this.events),delete this.data.events,delete this.data.classMap}get version(){return this.data.version}get metadata(){return this.data.metadata||{}}get name(){return this.metadata.name}get rootEvent(){return this.callTree.rootEvent}toJSON(){return{...this.data,events:this.events.map((t=>s(t,"_call","_return"))),classMap:this.classMap}}}function c(t){return Object.keys(t.activeStacks).length+t.finalizedStacks.length}function l(t,e){const n="call"===e.event?e:e._call,r=t.codeObjectFromEvent(n);return r?r.id:`${n.defined_class}${n.static?"#":"."}${n.method_id}`}class h{constructor(t){this.events=[],this.stack=[],this.id=t,this.eventMap={}}add(t){if("return"!==t.event||0!==this.events.length){if("call"===t.event)this.stack.push(t),this.eventMap[t.id]=t;else{if(void 0===t.parent_id){const e=this.stack[this.stack.length-1];if(!e||e.defined_class!==t.defined_class||e.method_id!==t.method_id||e.path!==t.path||e.static!==t.static)return;t.parent_id=e.id}const e=this.eventMap[t.parent_id];if(!e)throw`return #${t.id} is missing call #${t.parent_id}`;e._return=t,t._call=e,this.stack.pop()}this.events.push(t)}}unwound(){return this.events.length>0&&0===this.stack.length}}class f{constructor(){this.activeStacks={},this.finalizedStacks=[]}add(t){let e=this.activeStacks[t.thread_id];if(!e){const n=c(this);e=new h(n),this.activeStacks[t.thread_id]=e}e.add(t),e.unwound()&&(this.finalizedStacks.splice(e.id,0,e.events),delete this.activeStacks[t.thread_id])}size(){let t=p(Object.values(this.activeStacks));return t+=p(this.finalizedStacks),t}collect(){const t=[...this.finalizedStacks];return Object.values(this.activeStacks).forEach((e=>t.splice(e.id,0,e.events))),t.reduce(((t,e)=>{if(0===e.length)return t;if(0===t.length)return t.push([e]),t;if(e[0].http_server_request)return t.push([e]),t;const n=t[t.length-1];return n[n.length-1][0].http_server_request?t.push([e]):n.push(e),t}),[])}}const d=new Set(["parent","_call","_return"]);function p(t){return JSON.stringify(t,((t,e)=>{if(!d.has(t))return e})).length}const v=(t,e,...n)=>t.reduce(((t,e)=>e(t,...n)),e);class g extends n{constructor(){super(),this.sorter=new f,this.transforms={event:[],stack:[],chunk:[]}}source(t){const e=typeof t;if("object"===e)this.data={...t};else{if("string"!==e)throw`got invalid type ${e}, expected object or string`;this.data=JSON.parse(t)}return this.data.events.forEach((t=>this.sorter.add(t))),delete this.data.events,this}event(t){return console.assert("function"==typeof t),this.transforms.event.push(t),this}stack(t){return console.assert("function"==typeof t),this.transforms.stack.push(t),this}chunk(t){return console.assert("function"==typeof t),this.transforms.chunk.push(t),this}normalize(){let t=0;return this.event((e=>(e.id=++t,e._return&&(e._return.parent_id=e.id),e))),this.stack((t=>(t.filter((t=>"call"===t.event&!t._return)).reverse().map((t=>{const e={event:"return",thread_id:t.thread_id,parent_id:t.id,_call:t};return t._return=e,e})).forEach((e=>t.push(e))),t)))}prune(t){let e;console.assert("number"==typeof t);let n=0;return this.on("preprocess",(r=>{e=new i(r.data.classMap),n=Math.min(t/r.size,1)})).chunk((t=>{e.visit((t=>{t.size=0,t.count=0})),t.flat(2).forEach((t=>{if("call"!==t.event||t.sql_query||t.http_server_request)return;const n=e.codeObjectFromEvent(t);if(n){const e=p(t);n.size=n.size+e||e,n.count=n.count+1||1}}));let r=0;const i=e.codeObjects.filter((t=>t.size)).sort(((t,e)=>t.size-e.size)).map((t=>({id:t.id,count:t.count,size:t.size,totalBytes:r+=t.size}))).reverse(),o=new Set;for(let t=0;t<i.length;++t){const e=i[t];if(e.totalBytes<=r*n)break;o.add(e.id)}return t.map((t=>t.filter((t=>{const n="call"===t.event?t:t._call;if(!n)return!1;if(n.http_server_request||n.sql_query)return!0;const r=l(e,t);return!o.has(r)}))))}))}build(){const t=this.sorter.size();this.emit("preprocess",{size:t,data:this.data});const e=this.sorter.collect().map((t=>v(this.transforms.chunk,t).map((t=>v(this.transforms.stack,t).map((t=>v(this.transforms.event,t))))))).flat(2);return new u({...this.data,events:e})}}function E(){return new g}const m=t=>"string"!=typeof t?"":t.slice(0,1).toUpperCase()+t.slice(1).toLowerCase(),y=Object.prototype.hasOwnProperty,_=t=>{if(!1===y.call(t,"http_server_request"))return null;const e=t.http_server_request.request_method,n=t.http_server_request.path_info;let r;try{r=`${e} ${new URL(n,"http://hostname").pathname}`}catch(t){r="HTTP Request"}return r},N=new Set(["insert","update","select","delete","alter","create","drop","rename","truncate","replace","savepoint","release","rollback","lock","unlock","set","start","call","delete","do","perform","handler","load","purge","reset","prepare","execute","deallocate","xa"]),T=t=>{if(!1===y.call(t,"sql_query"))return null;const e=[...(t.sql_query.normalized_sql||t.sql_query.sql||"").trimLeft()];e.length>0&&"("===e[0]&&e.shift();let n=0;const r=e.reduce(((t,e)=>("("===e&&++n,0===n&&t.push(e),")"===e&&--n,t)),[]).join("");let i=null;return i=-1===r.search(/\s/)?r:r.replace(/[^\w]+/g," ").toLowerCase().split(" ").find((t=>N.has(t))),["SQL",m(i)||null].join(" ")},w=t=>{let e=_(t);return e||(e=T(t)),e};function b(t,e){return"function"===e.type&&(t[e.location]=e),e.children&&e.children.reduce(b,t),t}class A{constructor(t){this.functionObjects=t.reduce(b,{})}getName(t){const e=w(t);if(e)return e;const n=this.getCodeObject(t);if(n)return n.display_name;const r=t.static?".":"#";return[t.defined_class,r,t.method_id].join("")}getLabels(t){const e=[];t.labels&&e.push(...t.labels);const n=this.getCodeObject(t);return n&&n.labels.length&&e.push(...n.labels),e}getCodeObject(t){return this.functionObjects[`${t.path}:${t.lineno}`]}}const R="HTTP",O="SQL";class S{constructor(t){const e={},n={},r={},i={},o={},a=new Set,s=new Set,u=new Set,c={},l={},h={},f=[],d=[];function p(t){if("class"===t.type&&d.push(t.name),"package"===t.type&&f.push(t.name),"function"===t.type){const e=[t.location||"<path>:<line>",t.name].join("#"),n=d.join("::"),r=f.join("/");h[e]={className:n,packageName:r}}(t.children||[]).forEach(p),"class"===t.type&&d.pop(),"package"===t.type&&f.pop()}t.classMap.forEach(p);const v=[],g=new Set,E=[];return t.events.forEach((t=>{if("return"===t.event)return v.pop();const e=[[t.path||"<path>",t.lineno||"<line>"].join(":"),t.method_id].join("#");let n;if(t.sql_query?n={className:O,packageName:O}:t.http_server_request?n={className:`${t.http_server_request.request_method} ${t.http_server_request.path_info}`,packageName:R}:(n=h[e],n||(n={className:t.defined_class,packageName:t.defined_class.split("::")[0]})),v.length>0){const t=[v[v.length-1],n],e=JSON.stringify(t);g.add(e)&&E.push(t)}return v.push(n),null})),E.forEach((t=>{t.forEach((t=>{u.add(t.packageName),i[t.packageName]||(i[t.packageName]=new Set),i[t.packageName].add(t.className),o[t.className]=t.packageName}));const[c,l]=t;c.packageName===R&&a.add(l.packageName),l.packageName===O&&s.add(c.packageName),e[c.packageName]||(e[c.packageName]=new Set),e[c.packageName].add(l.packageName),n[c.className]||(n[c.className]=new Set),n[c.className].add(l.className),r[l.className]||(r[l.className]=new Set),r[l.className].add(c.className)})),{package_calls:e,class_calls:n,class_callers:r,package_classes:i,class_package:o,controller_packages:a,querying_packages:s,packages:u,class_locations:c,source_control:l}}}t.CallTree=a,t.ClassMap=i,t.Components=S,t.EventInfo=A,t.EventSource=n,t.buildAppMap=E,t.getLabel=w,Object.defineProperty(t,"__esModule",{value:!0})}(e)}));const C={ClassMap:I.ClassMap,CallTree:I.CallTree,Components:I.Components,EventInfo:I.EventInfo,EventSource:I.EventSource,getLabel:I.getLabel};function L(t){let e=Date.now();for(let n=t.values.length-1;n>=0;--n){const r=t.values[n];if((e-r.time)/60>t.staleTime){t.values.splice(0,t.values.length);break}e=r.time}}class M{constructor(t,e=.33){this.maxSamples=t,this.staleTime=e,this.reset()}add(t){L(this),this.values.length>=this.maxSamples&&this.values.splice(0,this.values.length-this.maxSamples+1),this.values.push({value:t,time:Date.now()})}reset(){this.values=[]}get length(){return this.values.length}get value(){L(this);const t=this.values.length-1;return 0!==t?this.values.reduce(((t,e)=>t+e.value),0)/t:0}}class x{constructor(t,e){this.vX=new M(8),this.vY=new M(8),this.transform={x:0,y:0,k:0},this.velocity={x:0,y:0},this.selection=e,this.node=e.node(),this.zoom=t,this.active=!1,this.ticking=!1}cancel(){this.lastTick&&delete this.lastTick,this.active=!1,this.ticking=!1}hold(){this.active=!1,this.holding=!0,this.vX.reset(),this.vY.reset()}release(){this.holding&&(this.holding=!1,this.impulse(this.vX.value,this.vY.value))}impulse(t,e,n=1){Math.abs(t)+Math.abs(e)<n||(this.velocity.x=t/this.transform.k,this.velocity.y=e/this.transform.k,this.ticking||(this.active=!0,this.tick()))}tick(){this.moving&&this.active?(this.ticking=!0,requestAnimationFrame((t=>{if(!this.active)return void this.cancel();this.lastTick||(this.lastTick=t-1);const e=(t-this.lastTick)/1e3;this.zoom.translateBy(this.selection,this.velocity.x,this.velocity.y),this.velocity.x-=2.5*this.velocity.x*e,this.velocity.y-=2.5*this.velocity.y*e,this.lastTick=t,this.tick()}))):this.cancel()}updateTransform(t){this.active||t.k!==this.transform.k||(this.vX.add(t.x-this.transform.x),this.vY.add(t.y-this.transform.y)),this.transform.x=t.x,this.transform.y=t.y,this.transform.k=t.k}get moving(){return Math.abs(this.velocity.x)+Math.abs(this.velocity.y)>.2}}function k(t,e){const{controls:n}=t;if(!t.maxZoomBarValue){const e=n.zoomBar.getBoundingClientRect().height,r=n.zoomGrab.getBoundingClientRect().height;t.maxZoomBarValue=e-r}const{maxZoomBarValue:r}=t,i=r-r*e;t.zoomScale=e,n.zoomGrab.style.top=`${i}px`}class P extends C.EventSource{constructor(t,e){super(),this.container=t.element,this.step=e.step,this.controls={},this.maxZoomBarValue=null,this.dragStart=null,this.zoomGrabPosition=null,this.isDragging=!1,this.zoomGrabTimeout=null,function(t){const e=document.createElement("div");e.className="appmap__zoom";const{controls:n}=t;n.buttonZoomIn=document.createElement("button"),n.buttonZoomIn.setAttribute("type","button"),n.buttonZoomIn.className="appmap__zoom-button",n.buttonZoomIn.innerHTML="&plus;",e.appendChild(n.buttonZoomIn),n.zoomBar=document.createElement("div"),n.zoomBar.className="appmap__zoom-bar",n.zoomGrab=document.createElement("div"),n.zoomGrab.className="appmap__zoom-grab",n.zoomBar.appendChild(n.zoomGrab),e.appendChild(n.zoomBar),n.buttonZoomOut=document.createElement("button"),n.buttonZoomOut.setAttribute("type","button"),n.buttonZoomOut.className="appmap__zoom-button",n.buttonZoomOut.innerHTML="&minus;",e.appendChild(n.buttonZoomOut),t.container.appendChild(e),t.element=e,n.buttonZoomIn.addEventListener("click",(()=>{t.zoomScale=Math.min(1,t.zoomScale+t.step),t.emit("zoom",t.zoomScale)})),n.buttonZoomOut.addEventListener("click",(()=>{t.zoomScale=Math.max(0,t.zoomScale-t.step),t.emit("zoom",t.zoomScale)})),n.zoomBar.addEventListener("click",(e=>{if(e.target!==n.zoomBar)return!1;const r=n.zoomBar.getBoundingClientRect().height,i=e.clientY-Math.round(n.zoomBar.getBoundingClientRect().top);return t.emit("zoom",1-i/r),!0})),n.zoomBar.addEventListener("mousedown",(e=>{document.body.style.cursor="grabbing",t.zoomGrabPosition=n.zoomGrab.offsetTop,t.dragStart=e.clientY,t.isDragging=!0,e.stopPropagation()})),document.body.addEventListener("mousemove",(e=>{if(t.isDragging){const r=n.zoomBar.getBoundingClientRect().height,i=t.zoomGrabPosition+(e.clientY-t.dragStart);t.emit("zoom",1-i/r),e.preventDefault()}})),document.body.addEventListener("mouseup",(()=>{document.body.style.cursor=null,t.isDragging=!1}))}(this),k(this,t.transform.k),t.on("move",(t=>k(this,(t.k-e.minRatio)/(e.maxRatio-e.minRatio))))}}class D extends I.EventSource{constructor(){super(),this._text="Untitled item"}text(t){return this._text=t,this}selector(t){return this._selector=t,this}condition(t){return this._condition=t,this}transform(t){return this._transform=t,this}match(t){if(!(!this._selector||t.matches(this._selector)))return!1;const e=(r=t,"function"==typeof(n=this)._transform?n._transform(r):r);var n,r;if(!e)return!1;return!this._condition||this._condition(e)}}class U extends I.EventSource{constructor(t,e=null){super(),this.parent=t,this.activeArea=e||t,this.elements=function(t){const e=document.createElement("div");e.classList.add("appmap__context-menu"),e.style.display="none";const n=document.createElement("div");n.classList.add("dropdown-menu"),e.appendChild(n),e.addEventListener("mousedown",(t=>t.stopPropagation())),e.addEventListener("pointerdown",(t=>t.stopPropagation())),e.addEventListener("touchstart",(t=>t.stopPropagation()));const r=document.createElement("p");return r.innerText="No actions available",r.style.display="none",n.appendChild(r),t.appendChild(e),{dropdown:e,menu:n,emptyMessage:r}}(t),this.activeArea.addEventListener("contextmenu",(t=>{!function(t,e){let n=0;const r=e.composedPath().slice(0,e.composedPath().findIndex((e=>e===t.activeArea)));t.items.forEach((t=>{const e=r.find((e=>t.match(e)));e?(t.element.listener&&t.element.removeEventListener("click",t.element.listener),t.element.listener=()=>t.emit("execute",function(t,e){return"function"==typeof t._transform?t._transform(e):e}(t,e)),t.element.addEventListener("click",t.element.listener),t.element.style.display="",t.emit("show"),n+=1):t.element.style.display="none"})),t.elements.emptyMessage.style.display=n>0?"none":"";const{x:i,y:o}=t.parent.getBoundingClientRect();t.elements.menu.style.transform=`translate(${e.x-i}px, ${e.y-o}px)`,t.elements.dropdown.style.display="block"}(this,t),t.preventDefault(),this.emit("show")})),this.selectors={},this.items=[]}divider(){return function(t){const e=document.createElement("div");e.classList.add("dropdown-divider"),t.elements.menu.appendChild(e)}(this),this}add(t){const e=t(new D);return e?(function(t,e){const n=document.createElement("a");n.classList.add("dropdown-item"),n.innerText=e._text,t.elements.menu.appendChild(n),e.element=n}(this,e),this.items.push(e),this):this}get visible(){return!(!this.elements||!this.elements.menu)&&this.elements.menu.offsetWidth>0}close(){const t=this.visible;return t&&(this.elements.dropdown.style.display="none"),t}isEventSource(t){if(!t)return!1;const e=t.composedPath();return!(!e||!this.elements)&&e.includes(this.elements.menu)}}const j=["light","dark"],G="light",B={contextMenu:!1,pan:{momentum:!0,boundary:{contain:null,overlap:300},tweenTime:250},theme:G,zoom:{controls:!1,step:.1,minRatio:.1,maxRatio:1,requireActive:!1}},F=(t,e,n)=>Math.min(Math.max(t,e),n);class H extends C.EventSource{constructor(t,n={}){super();const r=e.select(t).node();this.options=f(B,n);let{theme:i}=this.options;return-1===j.indexOf(i)&&(i=G),this.element=document.createElement("div"),this.element.className=`appmap appmap--theme-${i}`,this.contentElement=document.createElement("div"),this.contentElement.className="appmap__content",this.contentElement.containerController=this,this.element.appendChild(this.contentElement),r.appendChild(this.element),this.options.zoom&&(this.options.zoom.controls&&(this.zoomController=new P(this,this.options.zoom).on("zoom",(t=>{const{minRatio:e,maxRatio:n}=this.options.zoom;this.scaleTo((n-e)*t+e),this.active=!0}))),this.zoom=e.zoom().scaleExtent([this.options.zoom.minRatio,this.options.zoom.maxRatio]).interpolate(e.interpolate).filter((()=>"wheel"===e.event.type?this.active||!this.options.zoom.requireActive:(this.active=!0,!0))).on("zoom",(()=>{const{transform:t}=e.event,{offsetHeight:n,offsetWidth:i}=r;t.x=F(t.x,(this.options.pan.boundary.overlap-this.contentElement.offsetWidth)*t.k,i-this.options.pan.boundary.overlap*t.k),t.y=F(t.y,(this.options.pan.boundary.overlap-this.contentElement.offsetHeight)*t.k,n-this.options.pan.boundary.overlap*t.k),this.contentElement.style.transform=`translate(${t.x}px, ${t.y}px) scale(${t.k})`,this.contentElement.style.transformOrigin="0 0",this.emit("move",t)})),this.options.pan.momentum&&function(t,n){const r=new x(t,n),i=t.on("zoom"),o=window.onblur;n.on("mousedown",(()=>r.hold())).on("mouseup",(()=>r.release())).on("pointerdown",(()=>r.hold())).on("pointerup",(()=>r.release())).on("touchstart",(()=>r.hold())).on("touchend",(()=>r.release())).on("touchcancel",(()=>r.release())),window.addEventListener("mouseup",(()=>r.release())),window.addEventListener("pointerup",(()=>r.release())),window.onblur=()=>{o&&o(),r.cancel()},t.on("zoom",(()=>{r.updateTransform(e.event.transform),i&&i()}));const a=t.translateTo;t.translateTo=(...t)=>(r.cancel(),a(...t));const s=t.translate;t.translate=(...t)=>(r.cancel(),s(...t))}(this.zoom,e.select(this.element)),e.select(this.element).call(this.zoom).on("dblclick.zoom",null)),this.contentElement}setContextMenu(t){if(!1===this.options.contextMenu||"function"!=typeof this.options.contextMenu)return;this.contextMenu=new U(this.element);this.options.contextMenu(t).forEach((t=>this.contextMenu.add(t)))}fitViewport(t){const n=t.offsetHeight,r=t.offsetWidth,{clientWidth:i,clientHeight:o}=this.element.parentNode,{minRatio:a,maxRatio:s}=this.options.zoom,u=Math.min(o/n,i/r),c=Math.max(Math.min(Math.max(u,a),s),.8),l=e.zoomIdentity.translate(.5*(i-r*c),.5*(o-n*c)).scale(c);this.transform=l}translateTo(t,n,r=null){e.select(this.element).transition().duration(this.options.pan.tweenTime).call(this.zoom.translateTo,t,n,r)}translateBy(t,n){e.select(this.element).transition().duration(this.options.pan.tweenTime).call(this.zoom.translateBy,t,n)}scaleTo(t){e.select(this.element).transition().duration(100).call(this.zoom.scaleTo,t)}get transform(){return e.zoomTransform(this.element)}set transform(t){e.select(this.element).call(this.zoom.transform,t)}}var V=function(){this.__data__=[],this.size=0};var W=function(t,e){return t===e||t!=t&&e!=e};var z=function(t,e){for(var n=t.length;n--;)if(W(t[n][0],e))return n;return-1},Y=Array.prototype.splice;var $=function(t){var e=this.__data__,n=z(e,t);return!(n<0)&&(n==e.length-1?e.pop():Y.call(e,n,1),--this.size,!0)};var X=function(t){var e=this.__data__,n=z(e,t);return n<0?void 0:e[n][1]};var q=function(t){return z(this.__data__,t)>-1};var K=function(t,e){var n=this.__data__,r=z(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this};function Q(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Q.prototype.clear=V,Q.prototype.delete=$,Q.prototype.get=X,Q.prototype.has=q,Q.prototype.set=K;var Z=Q;var J=function(){this.__data__=new Z,this.size=0};var tt=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n};var et=function(t){return this.__data__.get(t)};var nt=function(t){return this.__data__.has(t)},rt="object"==typeof A&&A&&A.Object===Object&&A,it="object"==typeof self&&self&&self.Object===Object&&self,ot=rt||it||Function("return this")(),at=ot.Symbol,st=Object.prototype,ut=st.hasOwnProperty,ct=st.toString,lt=at?at.toStringTag:void 0;var ht=function(t){var e=ut.call(t,lt),n=t[lt];try{t[lt]=void 0;var r=!0}catch(t){}var i=ct.call(t);return r&&(e?t[lt]=n:delete t[lt]),i},ft=Object.prototype.toString;var dt=function(t){return ft.call(t)},pt=at?at.toStringTag:void 0;var vt=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":pt&&pt in Object(t)?ht(t):dt(t)};var gt=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)};var Et,mt=function(t){if(!gt(t))return!1;var e=vt(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},yt=ot["__core-js_shared__"],_t=(Et=/[^.]+$/.exec(yt&&yt.keys&&yt.keys.IE_PROTO||""))?"Symbol(src)_1."+Et:"";var Nt=function(t){return!!_t&&_t in t},Tt=Function.prototype.toString;var wt=function(t){if(null!=t){try{return Tt.call(t)}catch(t){}try{return t+""}catch(t){}}return""},bt=/^\[object .+?Constructor\]$/,At=Function.prototype,Rt=Object.prototype,Ot=At.toString,St=Rt.hasOwnProperty,It=RegExp("^"+Ot.call(St).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var Ct=function(t){return!(!gt(t)||Nt(t))&&(mt(t)?It:bt).test(wt(t))};var Lt=function(t,e){return null==t?void 0:t[e]};var Mt=function(t,e){var n=Lt(t,e);return Ct(n)?n:void 0},xt=Mt(ot,"Map"),kt=Mt(Object,"create");var Pt=function(){this.__data__=kt?kt(null):{},this.size=0};var Dt=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Ut=Object.prototype.hasOwnProperty;var jt=function(t){var e=this.__data__;if(kt){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return Ut.call(e,t)?e[t]:void 0},Gt=Object.prototype.hasOwnProperty;var Bt=function(t){var e=this.__data__;return kt?void 0!==e[t]:Gt.call(e,t)};var Ft=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=kt&&void 0===e?"__lodash_hash_undefined__":e,this};function Ht(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Ht.prototype.clear=Pt,Ht.prototype.delete=Dt,Ht.prototype.get=jt,Ht.prototype.has=Bt,Ht.prototype.set=Ft;var Vt=Ht;var Wt=function(){this.size=0,this.__data__={hash:new Vt,map:new(xt||Z),string:new Vt}};var zt=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};var Yt=function(t,e){var n=t.__data__;return zt(e)?n["string"==typeof e?"string":"hash"]:n.map};var $t=function(t){var e=Yt(this,t).delete(t);return this.size-=e?1:0,e};var Xt=function(t){return Yt(this,t).get(t)};var qt=function(t){return Yt(this,t).has(t)};var Kt=function(t,e){var n=Yt(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this};function Qt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Qt.prototype.clear=Wt,Qt.prototype.delete=$t,Qt.prototype.get=Xt,Qt.prototype.has=qt,Qt.prototype.set=Kt;var Zt=Qt;var Jt=function(t,e){var n=this.__data__;if(n instanceof Z){var r=n.__data__;if(!xt||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Zt(r)}return n.set(t,e),this.size=n.size,this};function te(t){var e=this.__data__=new Z(t);this.size=e.size}te.prototype.clear=J,te.prototype.delete=tt,te.prototype.get=et,te.prototype.has=nt,te.prototype.set=Jt;var ee=te;var ne=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t},re=function(){try{var t=Mt(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();var ie=function(t,e,n){"__proto__"==e&&re?re(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n},oe=Object.prototype.hasOwnProperty;var ae=function(t,e,n){var r=t[e];oe.call(t,e)&&W(r,n)&&(void 0!==n||e in t)||ie(t,e,n)};var se=function(t,e,n,r){var i=!n;n||(n={});for(var o=-1,a=e.length;++o<a;){var s=e[o],u=r?r(n[s],t[s],s,n,t):void 0;void 0===u&&(u=t[s]),i?ie(n,s,u):ae(n,s,u)}return n};var ue=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r};var ce=function(t){return null!=t&&"object"==typeof t};var le=function(t){return ce(t)&&"[object Arguments]"==vt(t)},he=Object.prototype,fe=he.hasOwnProperty,de=he.propertyIsEnumerable,pe=le(function(){return arguments}())?le:function(t){return ce(t)&&fe.call(t,"callee")&&!de.call(t,"callee")},ve=Array.isArray;var ge=function(){return!1},Ee=O((function(t,e){var n=e&&!e.nodeType&&e,r=n&&t&&!t.nodeType&&t,i=r&&r.exports===n?ot.Buffer:void 0,o=(i?i.isBuffer:void 0)||ge;t.exports=o})),me=/^(?:0|[1-9]\d*)$/;var ye=function(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&me.test(t))&&t>-1&&t%1==0&&t<e};var _e=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991},Ne={};Ne["[object Float32Array]"]=Ne["[object Float64Array]"]=Ne["[object Int8Array]"]=Ne["[object Int16Array]"]=Ne["[object Int32Array]"]=Ne["[object Uint8Array]"]=Ne["[object Uint8ClampedArray]"]=Ne["[object Uint16Array]"]=Ne["[object Uint32Array]"]=!0,Ne["[object Arguments]"]=Ne["[object Array]"]=Ne["[object ArrayBuffer]"]=Ne["[object Boolean]"]=Ne["[object DataView]"]=Ne["[object Date]"]=Ne["[object Error]"]=Ne["[object Function]"]=Ne["[object Map]"]=Ne["[object Number]"]=Ne["[object Object]"]=Ne["[object RegExp]"]=Ne["[object Set]"]=Ne["[object String]"]=Ne["[object WeakMap]"]=!1;var Te=function(t){return ce(t)&&_e(t.length)&&!!Ne[vt(t)]};var we=function(t){return function(e){return t(e)}},be=O((function(t,e){var n=e&&!e.nodeType&&e,r=n&&t&&!t.nodeType&&t,i=r&&r.exports===n&&rt.process,o=function(){try{var t=r&&r.require&&r.require("util").types;return t||i&&i.binding&&i.binding("util")}catch(t){}}();t.exports=o})),Ae=be&&be.isTypedArray,Re=Ae?we(Ae):Te,Oe=Object.prototype.hasOwnProperty;var Se=function(t,e){var n=ve(t),r=!n&&pe(t),i=!n&&!r&&Ee(t),o=!n&&!r&&!i&&Re(t),a=n||r||i||o,s=a?ue(t.length,String):[],u=s.length;for(var c in t)!e&&!Oe.call(t,c)||a&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||ye(c,u))||s.push(c);return s},Ie=Object.prototype;var Ce=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Ie)};var Le=function(t,e){return function(n){return t(e(n))}},Me=Le(Object.keys,Object),xe=Object.prototype.hasOwnProperty;var ke=function(t){if(!Ce(t))return Me(t);var e=[];for(var n in Object(t))xe.call(t,n)&&"constructor"!=n&&e.push(n);return e};var Pe=function(t){return null!=t&&_e(t.length)&&!mt(t)};var De=function(t){return Pe(t)?Se(t):ke(t)};var Ue=function(t,e){return t&&se(e,De(e),t)};var je=function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e},Ge=Object.prototype.hasOwnProperty;var Be=function(t){if(!gt(t))return je(t);var e=Ce(t),n=[];for(var r in t)("constructor"!=r||!e&&Ge.call(t,r))&&n.push(r);return n};var Fe=function(t){return Pe(t)?Se(t,!0):Be(t)};var He=function(t,e){return t&&se(e,Fe(e),t)},Ve=O((function(t,e){var n=e&&!e.nodeType&&e,r=n&&t&&!t.nodeType&&t,i=r&&r.exports===n?ot.Buffer:void 0,o=i?i.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var n=t.length,r=o?o(n):new t.constructor(n);return t.copy(r),r}}));var We=function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e};var ze=function(t,e){for(var n=-1,r=null==t?0:t.length,i=0,o=[];++n<r;){var a=t[n];e(a,n,t)&&(o[i++]=a)}return o};var Ye=function(){return[]},$e=Object.prototype.propertyIsEnumerable,Xe=Object.getOwnPropertySymbols,qe=Xe?function(t){return null==t?[]:(t=Object(t),ze(Xe(t),(function(e){return $e.call(t,e)})))}:Ye;var Ke=function(t,e){return se(t,qe(t),e)};var Qe=function(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t},Ze=Le(Object.getPrototypeOf,Object),Je=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)Qe(e,qe(t)),t=Ze(t);return e}:Ye;var tn=function(t,e){return se(t,Je(t),e)};var en=function(t,e,n){var r=e(t);return ve(t)?r:Qe(r,n(t))};var nn=function(t){return en(t,De,qe)};var rn=function(t){return en(t,Fe,Je)},on=Mt(ot,"DataView"),an=Mt(ot,"Promise"),sn=Mt(ot,"Set"),un=Mt(ot,"WeakMap"),cn="[object Map]",ln="[object Promise]",hn="[object Set]",fn="[object WeakMap]",dn="[object DataView]",pn=wt(on),vn=wt(xt),gn=wt(an),En=wt(sn),mn=wt(un),yn=vt;(on&&yn(new on(new ArrayBuffer(1)))!=dn||xt&&yn(new xt)!=cn||an&&yn(an.resolve())!=ln||sn&&yn(new sn)!=hn||un&&yn(new un)!=fn)&&(yn=function(t){var e=vt(t),n="[object Object]"==e?t.constructor:void 0,r=n?wt(n):"";if(r)switch(r){case pn:return dn;case vn:return cn;case gn:return ln;case En:return hn;case mn:return fn}return e});var _n=yn,Nn=Object.prototype.hasOwnProperty;var Tn=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&Nn.call(t,"index")&&(n.index=t.index,n.input=t.input),n},wn=ot.Uint8Array;var bn=function(t){var e=new t.constructor(t.byteLength);return new wn(e).set(new wn(t)),e};var An=function(t,e){var n=e?bn(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)},Rn=/\w*$/;var On=function(t){var e=new t.constructor(t.source,Rn.exec(t));return e.lastIndex=t.lastIndex,e},Sn=at?at.prototype:void 0,In=Sn?Sn.valueOf:void 0;var Cn=function(t){return In?Object(In.call(t)):{}};var Ln=function(t,e){var n=e?bn(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)};var Mn=function(t,e,n){var r=t.constructor;switch(e){case"[object ArrayBuffer]":return bn(t);case"[object Boolean]":case"[object Date]":return new r(+t);case"[object DataView]":return An(t,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return Ln(t,n);case"[object Map]":return new r;case"[object Number]":case"[object String]":return new r(t);case"[object RegExp]":return On(t);case"[object Set]":return new r;case"[object Symbol]":return Cn(t)}},xn=Object.create,kn=function(){function t(){}return function(e){if(!gt(e))return{};if(xn)return xn(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();var Pn=function(t){return"function"!=typeof t.constructor||Ce(t)?{}:kn(Ze(t))};var Dn=function(t){return ce(t)&&"[object Map]"==_n(t)},Un=be&&be.isMap,jn=Un?we(Un):Dn;var Gn=function(t){return ce(t)&&"[object Set]"==_n(t)},Bn=be&&be.isSet,Fn=Bn?we(Bn):Gn,Hn="[object Arguments]",Vn="[object Function]",Wn="[object Object]",zn={};zn[Hn]=zn["[object Array]"]=zn["[object ArrayBuffer]"]=zn["[object DataView]"]=zn["[object Boolean]"]=zn["[object Date]"]=zn["[object Float32Array]"]=zn["[object Float64Array]"]=zn["[object Int8Array]"]=zn["[object Int16Array]"]=zn["[object Int32Array]"]=zn["[object Map]"]=zn["[object Number]"]=zn[Wn]=zn["[object RegExp]"]=zn["[object Set]"]=zn["[object String]"]=zn["[object Symbol]"]=zn["[object Uint8Array]"]=zn["[object Uint8ClampedArray]"]=zn["[object Uint16Array]"]=zn["[object Uint32Array]"]=!0,zn["[object Error]"]=zn[Vn]=zn["[object WeakMap]"]=!1;var Yn=function t(e,n,r,i,o,a){var s,u=1&n,c=2&n,l=4&n;if(r&&(s=o?r(e,i,o,a):r(e)),void 0!==s)return s;if(!gt(e))return e;var h=ve(e);if(h){if(s=Tn(e),!u)return We(e,s)}else{var f=_n(e),d=f==Vn||"[object GeneratorFunction]"==f;if(Ee(e))return Ve(e,u);if(f==Wn||f==Hn||d&&!o){if(s=c||d?{}:Pn(e),!u)return c?tn(e,He(s,e)):Ke(e,Ue(s,e))}else{if(!zn[f])return o?e:{};s=Mn(e,f,u)}}a||(a=new ee);var p=a.get(e);if(p)return p;a.set(e,s),Fn(e)?e.forEach((function(i){s.add(t(i,n,r,i,e,a))})):jn(e)&&e.forEach((function(i,o){s.set(o,t(i,n,r,o,e,a))}));var v=h?void 0:(l?c?rn:nn:c?Fe:De)(e);return ne(v||e,(function(i,o){v&&(i=e[o=i]),ae(s,o,t(i,n,r,o,e,a))})),s};var $n=function(t){return Yn(t,4)};var Xn=function(t){return function(){return t}};var qn=function(t){return function(e,n,r){for(var i=-1,o=Object(e),a=r(e),s=a.length;s--;){var u=a[t?s:++i];if(!1===n(o[u],u,o))break}return e}}();var Kn=function(t,e){return t&&qn(t,e,De)};var Qn=function(t,e){return function(n,r){if(null==n)return n;if(!Pe(n))return t(n,r);for(var i=n.length,o=e?i:-1,a=Object(n);(e?o--:++o<i)&&!1!==r(a[o],o,a););return n}}(Kn);var Zn=function(t){return t};var Jn=function(t){return"function"==typeof t?t:Zn};var tr=function(t,e){return(ve(t)?ne:Qn)(t,Jn(e))},er=tr;var nr=function(t,e){var n=[];return Qn(t,(function(t,r,i){e(t,r,i)&&n.push(t)})),n};var rr=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this};var ir=function(t){return this.__data__.has(t)};function or(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new Zt;++e<n;)this.add(t[e])}or.prototype.add=or.prototype.push=rr,or.prototype.has=ir;var ar=or;var sr=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1};var ur=function(t,e){return t.has(e)};var cr=function(t,e,n,r,i,o){var a=1&n,s=t.length,u=e.length;if(s!=u&&!(a&&u>s))return!1;var c=o.get(t),l=o.get(e);if(c&&l)return c==e&&l==t;var h=-1,f=!0,d=2&n?new ar:void 0;for(o.set(t,e),o.set(e,t);++h<s;){var p=t[h],v=e[h];if(r)var g=a?r(v,p,h,e,t,o):r(p,v,h,t,e,o);if(void 0!==g){if(g)continue;f=!1;break}if(d){if(!sr(e,(function(t,e){if(!ur(d,e)&&(p===t||i(p,t,n,r,o)))return d.push(e)}))){f=!1;break}}else if(p!==v&&!i(p,v,n,r,o)){f=!1;break}}return o.delete(t),o.delete(e),f};var lr=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n};var hr=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n},fr=at?at.prototype:void 0,dr=fr?fr.valueOf:void 0;var pr=function(t,e,n,r,i,o,a){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!o(new wn(t),new wn(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return W(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var s=lr;case"[object Set]":var u=1&r;if(s||(s=hr),t.size!=e.size&&!u)return!1;var c=a.get(t);if(c)return c==e;r|=2,a.set(t,e);var l=cr(s(t),s(e),r,i,o,a);return a.delete(t),l;case"[object Symbol]":if(dr)return dr.call(t)==dr.call(e)}return!1},vr=Object.prototype.hasOwnProperty;var gr=function(t,e,n,r,i,o){var a=1&n,s=nn(t),u=s.length;if(u!=nn(e).length&&!a)return!1;for(var c=u;c--;){var l=s[c];if(!(a?l in e:vr.call(e,l)))return!1}var h=o.get(t),f=o.get(e);if(h&&f)return h==e&&f==t;var d=!0;o.set(t,e),o.set(e,t);for(var p=a;++c<u;){var v=t[l=s[c]],g=e[l];if(r)var E=a?r(g,v,l,e,t,o):r(v,g,l,t,e,o);if(!(void 0===E?v===g||i(v,g,n,r,o):E)){d=!1;break}p||(p="constructor"==l)}if(d&&!p){var m=t.constructor,y=e.constructor;m==y||!("constructor"in t)||!("constructor"in e)||"function"==typeof m&&m instanceof m&&"function"==typeof y&&y instanceof y||(d=!1)}return o.delete(t),o.delete(e),d},Er="[object Arguments]",mr="[object Array]",yr="[object Object]",_r=Object.prototype.hasOwnProperty;var Nr=function(t,e,n,r,i,o){var a=ve(t),s=ve(e),u=a?mr:_n(t),c=s?mr:_n(e),l=(u=u==Er?yr:u)==yr,h=(c=c==Er?yr:c)==yr,f=u==c;if(f&&Ee(t)){if(!Ee(e))return!1;a=!0,l=!1}if(f&&!l)return o||(o=new ee),a||Re(t)?cr(t,e,n,r,i,o):pr(t,e,u,n,r,i,o);if(!(1&n)){var d=l&&_r.call(t,"__wrapped__"),p=h&&_r.call(e,"__wrapped__");if(d||p){var v=d?t.value():t,g=p?e.value():e;return o||(o=new ee),i(v,g,n,r,o)}}return!!f&&(o||(o=new ee),gr(t,e,n,r,i,o))};var Tr=function t(e,n,r,i,o){return e===n||(null==e||null==n||!ce(e)&&!ce(n)?e!=e&&n!=n:Nr(e,n,r,i,t,o))};var wr=function(t,e,n,r){var i=n.length,o=i,a=!r;if(null==t)return!o;for(t=Object(t);i--;){var s=n[i];if(a&&s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++i<o;){var u=(s=n[i])[0],c=t[u],l=s[1];if(a&&s[2]){if(void 0===c&&!(u in t))return!1}else{var h=new ee;if(r)var f=r(c,l,u,t,e,h);if(!(void 0===f?Tr(l,c,3,r,h):f))return!1}}return!0};var br=function(t){return t==t&&!gt(t)};var Ar=function(t){for(var e=De(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,br(i)]}return e};var Rr=function(t,e){return function(n){return null!=n&&(n[t]===e&&(void 0!==e||t in Object(n)))}};var Or=function(t){var e=Ar(t);return 1==e.length&&e[0][2]?Rr(e[0][0],e[0][1]):function(n){return n===t||wr(n,t,e)}};var Sr=function(t){return"symbol"==typeof t||ce(t)&&"[object Symbol]"==vt(t)},Ir=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Cr=/^\w*$/;var Lr=function(t,e){if(ve(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!Sr(t))||(Cr.test(t)||!Ir.test(t)||null!=e&&t in Object(e))};function Mr(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=t.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(Mr.Cache||Zt),n}Mr.Cache=Zt;var xr=Mr;var kr=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Pr=/\\(\\)?/g,Dr=function(t){var e=xr(t,(function(t){return 500===n.size&&n.clear(),t})),n=e.cache;return e}((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(kr,(function(t,n,r,i){e.push(r?i.replace(Pr,"$1"):n||t)})),e}));var Ur=function(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i},jr=at?at.prototype:void 0,Gr=jr?jr.toString:void 0;var Br=function t(e){if("string"==typeof e)return e;if(ve(e))return Ur(e,t)+"";if(Sr(e))return Gr?Gr.call(e):"";var n=e+"";return"0"==n&&1/e==-Infinity?"-0":n};var Fr=function(t){return null==t?"":Br(t)};var Hr=function(t,e){return ve(t)?t:Lr(t,e)?[t]:Dr(Fr(t))};var Vr=function(t){if("string"==typeof t||Sr(t))return t;var e=t+"";return"0"==e&&1/t==-Infinity?"-0":e};var Wr=function(t,e){for(var n=0,r=(e=Hr(e,t)).length;null!=t&&n<r;)t=t[Vr(e[n++])];return n&&n==r?t:void 0};var zr=function(t,e,n){var r=null==t?void 0:Wr(t,e);return void 0===r?n:r};var Yr=function(t,e){return null!=t&&e in Object(t)};var $r=function(t,e,n){for(var r=-1,i=(e=Hr(e,t)).length,o=!1;++r<i;){var a=Vr(e[r]);if(!(o=null!=t&&n(t,a)))break;t=t[a]}return o||++r!=i?o:!!(i=null==t?0:t.length)&&_e(i)&&ye(a,i)&&(ve(t)||pe(t))};var Xr=function(t,e){return null!=t&&$r(t,e,Yr)};var qr=function(t,e){return Lr(t)&&br(e)?Rr(Vr(t),e):function(n){var r=zr(n,t);return void 0===r&&r===e?Xr(n,t):Tr(e,r,3)}};var Kr=function(t){return function(e){return null==e?void 0:e[t]}};var Qr=function(t){return function(e){return Wr(e,t)}};var Zr=function(t){return Lr(t)?Kr(Vr(t)):Qr(t)};var Jr=function(t){return"function"==typeof t?t:null==t?Zn:"object"==typeof t?ve(t)?qr(t[0],t[1]):Or(t):Zr(t)};var ti=function(t,e){return(ve(t)?ze:nr)(t,Jr(e))},ei=Object.prototype.hasOwnProperty;var ni=function(t,e){return null!=t&&ei.call(t,e)};var ri=function(t,e){return null!=t&&$r(t,e,ni)},ii=Object.prototype.hasOwnProperty;var oi=function(t){if(null==t)return!0;if(Pe(t)&&(ve(t)||"string"==typeof t||"function"==typeof t.splice||Ee(t)||Re(t)||pe(t)))return!t.length;var e=_n(t);if("[object Map]"==e||"[object Set]"==e)return!t.size;if(Ce(t))return!ke(t).length;for(var n in t)if(ii.call(t,n))return!1;return!0};var ai=function(t){return void 0===t};var si=function(t,e){var n=-1,r=Pe(t)?Array(t.length):[];return Qn(t,(function(t,i,o){r[++n]=e(t,i,o)})),r};var ui=function(t,e){return(ve(t)?Ur:si)(t,Jr(e))};var ci=function(t,e,n,r){var i=-1,o=null==t?0:t.length;for(r&&o&&(n=t[++i]);++i<o;)n=e(n,t[i],i,t);return n};var li=function(t,e,n,r,i){return i(t,(function(t,i,o){n=r?(r=!1,t):e(n,t,i,o)})),n};var hi=function(t,e,n){var r=ve(t)?ci:li,i=arguments.length<3;return r(t,Jr(e),n,i,Qn)};var fi=function(t){return"string"==typeof t||!ve(t)&&ce(t)&&"[object String]"==vt(t)},di=Kr("length"),pi=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var vi=function(t){return pi.test(t)},gi="[\\ud800-\\udfff]",Ei="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",mi="\\ud83c[\\udffb-\\udfff]",yi="[^\\ud800-\\udfff]",_i="(?:\\ud83c[\\udde6-\\uddff]){2}",Ni="[\\ud800-\\udbff][\\udc00-\\udfff]",Ti="(?:"+Ei+"|"+mi+")"+"?",wi="[\\ufe0e\\ufe0f]?",bi=wi+Ti+("(?:\\u200d(?:"+[yi,_i,Ni].join("|")+")"+wi+Ti+")*"),Ai="(?:"+[yi+Ei+"?",Ei,_i,Ni,gi].join("|")+")",Ri=RegExp(mi+"(?="+mi+")|"+Ai+bi,"g");var Oi=function(t){for(var e=Ri.lastIndex=0;Ri.test(t);)++e;return e};var Si=function(t){return vi(t)?Oi(t):di(t)};var Ii=function(t){if(null==t)return 0;if(Pe(t))return fi(t)?Si(t):t.length;var e=_n(t);return"[object Map]"==e||"[object Set]"==e?t.size:ke(t).length};var Ci=function(t,e,n){var r=ve(t),i=r||Ee(t)||Re(t);if(e=Jr(e),null==n){var o=t&&t.constructor;n=i?r?new o:[]:gt(t)&&mt(o)?kn(Ze(t)):{}}return(i?ne:Kn)(t,(function(t,r,i){return e(n,t,r,i)})),n},Li=at?at.isConcatSpreadable:void 0;var Mi=function(t){return ve(t)||pe(t)||!!(Li&&t&&t[Li])};var xi=function t(e,n,r,i,o){var a=-1,s=e.length;for(r||(r=Mi),o||(o=[]);++a<s;){var u=e[a];n>0&&r(u)?n>1?t(u,n-1,r,i,o):Qe(o,u):i||(o[o.length]=u)}return o};var ki=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)},Pi=Math.max;var Di=function(t,e,n){return e=Pi(void 0===e?t.length-1:e,0),function(){for(var r=arguments,i=-1,o=Pi(r.length-e,0),a=Array(o);++i<o;)a[i]=r[e+i];i=-1;for(var s=Array(e+1);++i<e;)s[i]=r[i];return s[e]=n(a),ki(t,this,s)}},Ui=re?function(t,e){return re(t,"toString",{configurable:!0,enumerable:!1,value:Xn(e),writable:!0})}:Zn,ji=Date.now;var Gi=function(t){var e=0,n=0;return function(){var r=ji(),i=16-(r-n);if(n=r,i>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(Ui);var Bi=function(t,e){return Gi(Di(t,e,Zn),t+"")};var Fi=function(t,e,n,r){for(var i=t.length,o=n+(r?1:-1);r?o--:++o<i;)if(e(t[o],o,t))return o;return-1};var Hi=function(t){return t!=t};var Vi=function(t,e,n){for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1};var Wi=function(t,e,n){return e==e?Vi(t,e,n):Fi(t,Hi,n)};var zi=function(t,e){return!!(null==t?0:t.length)&&Wi(t,e,0)>-1};var Yi=function(t,e,n){for(var r=-1,i=null==t?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1};var $i=function(){},Xi=sn&&1/hr(new sn([,-0]))[1]==1/0?function(t){return new sn(t)}:$i;var qi=function(t,e,n){var r=-1,i=zi,o=t.length,a=!0,s=[],u=s;if(n)a=!1,i=Yi;else if(o>=200){var c=e?null:Xi(t);if(c)return hr(c);a=!1,i=ur,u=new ar}else u=e?[]:s;t:for(;++r<o;){var l=t[r],h=e?e(l):l;if(l=n||0!==l?l:0,a&&h==h){for(var f=u.length;f--;)if(u[f]===h)continue t;e&&u.push(h),s.push(l)}else i(u,h,n)||(u!==s&&u.push(h),s.push(l))}return s};var Ki=function(t){return ce(t)&&Pe(t)},Qi=Bi((function(t){return qi(xi(t,1,Ki,!0))}));var Zi=function(t,e){return Ur(e,(function(e){return t[e]}))};var Ji,to=function(t){return null==t?[]:Zi(t,De(t))};try{Ji={clone:$n,constant:Xn,each:er,filter:ti,has:ri,isArray:ve,isEmpty:oi,isFunction:mt,isUndefined:ai,keys:De,map:ui,reduce:hi,size:Ii,transform:Ci,union:Qi,values:to}}catch(t){}Ji||(Ji=window._);var eo=Ji,no=io,ro="\0";function io(t){this._isDirected=!eo.has(t,"directed")||t.directed,this._isMultigraph=!!eo.has(t,"multigraph")&&t.multigraph,this._isCompound=!!eo.has(t,"compound")&&t.compound,this._label=void 0,this._defaultNodeLabelFn=eo.constant(void 0),this._defaultEdgeLabelFn=eo.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children["\0"]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function oo(t,e){t[e]?t[e]++:t[e]=1}function ao(t,e){--t[e]||delete t[e]}function so(t,e,n,r){var i=""+e,o=""+n;if(!t&&i>o){var a=i;i=o,o=a}return i+""+o+""+(eo.isUndefined(r)?"\0":r)}function uo(t,e,n,r){var i=""+e,o=""+n;if(!t&&i>o){var a=i;i=o,o=a}var s={v:i,w:o};return r&&(s.name=r),s}function co(t,e){return so(t,e.v,e.w,e.name)}io.prototype._nodeCount=0,io.prototype._edgeCount=0,io.prototype.isDirected=function(){return this._isDirected},io.prototype.isMultigraph=function(){return this._isMultigraph},io.prototype.isCompound=function(){return this._isCompound},io.prototype.setGraph=function(t){return this._label=t,this},io.prototype.graph=function(){return this._label},io.prototype.setDefaultNodeLabel=function(t){return eo.isFunction(t)||(t=eo.constant(t)),this._defaultNodeLabelFn=t,this},io.prototype.nodeCount=function(){return this._nodeCount},io.prototype.nodes=function(){return eo.keys(this._nodes)},io.prototype.sources=function(){var t=this;return eo.filter(this.nodes(),(function(e){return eo.isEmpty(t._in[e])}))},io.prototype.sinks=function(){var t=this;return eo.filter(this.nodes(),(function(e){return eo.isEmpty(t._out[e])}))},io.prototype.setNodes=function(t,e){var n=arguments,r=this;return eo.each(t,(function(t){n.length>1?r.setNode(t,e):r.setNode(t)})),this},io.prototype.setNode=function(t,e){return eo.has(this._nodes,t)?(arguments.length>1&&(this._nodes[t]=e),this):(this._nodes[t]=arguments.length>1?e:this._defaultNodeLabelFn(t),this._isCompound&&(this._parent[t]=ro,this._children[t]={},this._children["\0"][t]=!0),this._in[t]={},this._preds[t]={},this._out[t]={},this._sucs[t]={},++this._nodeCount,this)},io.prototype.node=function(t){return this._nodes[t]},io.prototype.hasNode=function(t){return eo.has(this._nodes,t)},io.prototype.removeNode=function(t){var e=this;if(eo.has(this._nodes,t)){var n=function(t){e.removeEdge(e._edgeObjs[t])};delete this._nodes[t],this._isCompound&&(this._removeFromParentsChildList(t),delete this._parent[t],eo.each(this.children(t),(function(t){e.setParent(t)})),delete this._children[t]),eo.each(eo.keys(this._in[t]),n),delete this._in[t],delete this._preds[t],eo.each(eo.keys(this._out[t]),n),delete this._out[t],delete this._sucs[t],--this._nodeCount}return this},io.prototype.setParent=function(t,e){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(eo.isUndefined(e))e=ro;else{for(var n=e+="";!eo.isUndefined(n);n=this.parent(n))if(n===t)throw new Error("Setting "+e+" as parent of "+t+" would create a cycle");this.setNode(e)}return this.setNode(t),this._removeFromParentsChildList(t),this._parent[t]=e,this._children[e][t]=!0,this},io.prototype._removeFromParentsChildList=function(t){delete this._children[this._parent[t]][t]},io.prototype.parent=function(t){if(this._isCompound){var e=this._parent[t];if(e!==ro)return e}},io.prototype.children=function(t){if(eo.isUndefined(t)&&(t=ro),this._isCompound){var e=this._children[t];if(e)return eo.keys(e)}else{if(t===ro)return this.nodes();if(this.hasNode(t))return[]}},io.prototype.predecessors=function(t){var e=this._preds[t];if(e)return eo.keys(e)},io.prototype.successors=function(t){var e=this._sucs[t];if(e)return eo.keys(e)},io.prototype.neighbors=function(t){var e=this.predecessors(t);if(e)return eo.union(e,this.successors(t))},io.prototype.isLeaf=function(t){return 0===(this.isDirected()?this.successors(t):this.neighbors(t)).length},io.prototype.filterNodes=function(t){var e=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});e.setGraph(this.graph());var n=this;eo.each(this._nodes,(function(n,r){t(r)&&e.setNode(r,n)})),eo.each(this._edgeObjs,(function(t){e.hasNode(t.v)&&e.hasNode(t.w)&&e.setEdge(t,n.edge(t))}));var r={};function i(t){var o=n.parent(t);return void 0===o||e.hasNode(o)?(r[t]=o,o):o in r?r[o]:i(o)}return this._isCompound&&eo.each(e.nodes(),(function(t){e.setParent(t,i(t))})),e},io.prototype.setDefaultEdgeLabel=function(t){return eo.isFunction(t)||(t=eo.constant(t)),this._defaultEdgeLabelFn=t,this},io.prototype.edgeCount=function(){return this._edgeCount},io.prototype.edges=function(){return eo.values(this._edgeObjs)},io.prototype.setPath=function(t,e){var n=this,r=arguments;return eo.reduce(t,(function(t,i){return r.length>1?n.setEdge(t,i,e):n.setEdge(t,i),i})),this},io.prototype.setEdge=function(){var t,e,n,r,i=!1,o=arguments[0];"object"==typeof o&&null!==o&&"v"in o?(t=o.v,e=o.w,n=o.name,2===arguments.length&&(r=arguments[1],i=!0)):(t=o,e=arguments[1],n=arguments[3],arguments.length>2&&(r=arguments[2],i=!0)),t=""+t,e=""+e,eo.isUndefined(n)||(n=""+n);var a=so(this._isDirected,t,e,n);if(eo.has(this._edgeLabels,a))return i&&(this._edgeLabels[a]=r),this;if(!eo.isUndefined(n)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(t),this.setNode(e),this._edgeLabels[a]=i?r:this._defaultEdgeLabelFn(t,e,n);var s=uo(this._isDirected,t,e,n);return t=s.v,e=s.w,Object.freeze(s),this._edgeObjs[a]=s,oo(this._preds[e],t),oo(this._sucs[t],e),this._in[e][a]=s,this._out[t][a]=s,this._edgeCount++,this},io.prototype.edge=function(t,e,n){var r=1===arguments.length?co(this._isDirected,arguments[0]):so(this._isDirected,t,e,n);return this._edgeLabels[r]},io.prototype.hasEdge=function(t,e,n){var r=1===arguments.length?co(this._isDirected,arguments[0]):so(this._isDirected,t,e,n);return eo.has(this._edgeLabels,r)},io.prototype.removeEdge=function(t,e,n){var r=1===arguments.length?co(this._isDirected,arguments[0]):so(this._isDirected,t,e,n),i=this._edgeObjs[r];return i&&(t=i.v,e=i.w,delete this._edgeLabels[r],delete this._edgeObjs[r],ao(this._preds[e],t),ao(this._sucs[t],e),delete this._in[e][r],delete this._out[t][r],this._edgeCount--),this},io.prototype.inEdges=function(t,e){var n=this._in[t];if(n){var r=eo.values(n);return e?eo.filter(r,(function(t){return t.v===e})):r}},io.prototype.outEdges=function(t,e){var n=this._out[t];if(n){var r=eo.values(n);return e?eo.filter(r,(function(t){return t.w===e})):r}},io.prototype.nodeEdges=function(t,e){var n=this.inEdges(t,e);if(n)return n.concat(this.outEdges(t,e))};var lo={Graph:no,version:"2.1.8"},ho={write:function(t){var e={options:{directed:t.isDirected(),multigraph:t.isMultigraph(),compound:t.isCompound()},nodes:fo(t),edges:po(t)};eo.isUndefined(t.graph())||(e.value=eo.clone(t.graph()));return e},read:function(t){var e=new no(t.options).setGraph(t.value);return eo.each(t.nodes,(function(t){e.setNode(t.v,t.value),t.parent&&e.setParent(t.v,t.parent)})),eo.each(t.edges,(function(t){e.setEdge({v:t.v,w:t.w,name:t.name},t.value)})),e}};function fo(t){return eo.map(t.nodes(),(function(e){var n=t.node(e),r=t.parent(e),i={v:e};return eo.isUndefined(n)||(i.value=n),eo.isUndefined(r)||(i.parent=r),i}))}function po(t){return eo.map(t.edges(),(function(e){var n=t.edge(e),r={v:e.v,w:e.w};return eo.isUndefined(e.name)||(r.name=e.name),eo.isUndefined(n)||(r.value=n),r}))}var vo=function(t){var e,n={},r=[];function i(r){eo.has(n,r)||(n[r]=!0,e.push(r),eo.each(t.successors(r),i),eo.each(t.predecessors(r),i))}return eo.each(t.nodes(),(function(t){e=[],i(t),e.length&&r.push(e)})),r};var go=Eo;function Eo(){this._arr=[],this._keyIndices={}}Eo.prototype.size=function(){return this._arr.length},Eo.prototype.keys=function(){return this._arr.map((function(t){return t.key}))},Eo.prototype.has=function(t){return eo.has(this._keyIndices,t)},Eo.prototype.priority=function(t){var e=this._keyIndices[t];if(void 0!==e)return this._arr[e].priority},Eo.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},Eo.prototype.add=function(t,e){var n=this._keyIndices;if(t=String(t),!eo.has(n,t)){var r=this._arr,i=r.length;return n[t]=i,r.push({key:t,priority:e}),this._decrease(i),!0}return!1},Eo.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var t=this._arr.pop();return delete this._keyIndices[t.key],this._heapify(0),t.key},Eo.prototype.decrease=function(t,e){var n=this._keyIndices[t];if(e>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+t+" Old: "+this._arr[n].priority+" New: "+e);this._arr[n].priority=e,this._decrease(n)},Eo.prototype._heapify=function(t){var e=this._arr,n=2*t,r=n+1,i=t;n<e.length&&(i=e[n].priority<e[i].priority?n:i,r<e.length&&(i=e[r].priority<e[i].priority?r:i),i!==t&&(this._swap(t,i),this._heapify(i)))},Eo.prototype._decrease=function(t){for(var e,n=this._arr,r=n[t].priority;0!==t&&!(n[e=t>>1].priority<r);)this._swap(t,e),t=e},Eo.prototype._swap=function(t,e){var n=this._arr,r=this._keyIndices,i=n[t],o=n[e];n[t]=o,n[e]=i,r[o.key]=t,r[i.key]=e};var mo=function(t,e,n,r){return function(t,e,n,r){var i,o,a={},s=new go,u=function(t){var e=t.v!==i?t.v:t.w,r=a[e],u=n(t),c=o.distance+u;if(u<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+t+" Weight: "+u);c<r.distance&&(r.distance=c,r.predecessor=i,s.decrease(e,c))};t.nodes().forEach((function(t){var n=t===e?0:Number.POSITIVE_INFINITY;a[t]={distance:n},s.add(t,n)}));for(;s.size()>0&&(i=s.removeMin(),(o=a[i]).distance!==Number.POSITIVE_INFINITY);)r(i).forEach(u);return a}(t,String(e),n||yo,r||function(e){return t.outEdges(e)})},yo=eo.constant(1);var _o=function(t,e,n){return eo.transform(t.nodes(),(function(r,i){r[i]=mo(t,i,e,n)}),{})};var No=function(t){var e=0,n=[],r={},i=[];function o(a){var s=r[a]={onStack:!0,lowlink:e,index:e++};if(n.push(a),t.successors(a).forEach((function(t){eo.has(r,t)?r[t].onStack&&(s.lowlink=Math.min(s.lowlink,r[t].index)):(o(t),s.lowlink=Math.min(s.lowlink,r[t].lowlink))})),s.lowlink===s.index){var u,c=[];do{u=n.pop(),r[u].onStack=!1,c.push(u)}while(a!==u);i.push(c)}}return t.nodes().forEach((function(t){eo.has(r,t)||o(t)})),i};var To=function(t){return eo.filter(No(t),(function(e){return e.length>1||1===e.length&&t.hasEdge(e[0],e[0])}))};var wo=function(t,e,n){return function(t,e,n){var r={},i=t.nodes();return i.forEach((function(t){r[t]={},r[t][t]={distance:0},i.forEach((function(e){t!==e&&(r[t][e]={distance:Number.POSITIVE_INFINITY})})),n(t).forEach((function(n){var i=n.v===t?n.w:n.v,o=e(n);r[t][i]={distance:o,predecessor:t}}))})),i.forEach((function(t){var e=r[t];i.forEach((function(n){var o=r[n];i.forEach((function(n){var r=o[t],i=e[n],a=o[n],s=r.distance+i.distance;s<a.distance&&(a.distance=s,a.predecessor=i.predecessor)}))}))})),r}(t,e||bo,n||function(e){return t.outEdges(e)})},bo=eo.constant(1);var Ao=Ro;function Ro(t){var e={},n={},r=[];if(eo.each(t.sinks(),(function i(o){if(eo.has(n,o))throw new Oo;eo.has(e,o)||(n[o]=!0,e[o]=!0,eo.each(t.predecessors(o),i),delete n[o],r.push(o))})),eo.size(e)!==t.nodeCount())throw new Oo;return r}function Oo(){}Ro.CycleException=Oo,Oo.prototype=new Error;var So=function(t,e,n){eo.isArray(e)||(e=[e]);var r=(t.isDirected()?t.successors:t.neighbors).bind(t),i=[],o={};return eo.each(e,(function(e){if(!t.hasNode(e))throw new Error("Graph does not have node: "+e);Io(t,e,"post"===n,o,r,i)})),i};function Io(t,e,n,r,i,o){eo.has(r,e)||(r[e]=!0,n||o.push(e),eo.each(i(e),(function(e){Io(t,e,n,r,i,o)})),n&&o.push(e))}var Co,Lo={Graph:lo.Graph,json:ho,alg:{components:vo,dijkstra:mo,dijkstraAll:_o,findCycles:To,floydWarshall:wo,isAcyclic:function(t){try{Ao(t)}catch(t){if(t instanceof Ao.CycleException)return!1;throw t}return!0},postorder:function(t,e){return So(t,e,"post")},preorder:function(t,e){return So(t,e,"pre")},prim:function(t,e){var n,r=new no,i={},o=new go;function a(t){var r=t.v===n?t.w:t.v,a=o.priority(r);if(void 0!==a){var s=e(t);s<a&&(i[r]=n,o.decrease(r,s))}}if(0===t.nodeCount())return r;eo.each(t.nodes(),(function(t){o.add(t,Number.POSITIVE_INFINITY),r.setNode(t)})),o.decrease(t.nodes()[0],0);var s=!1;for(;o.size()>0;){if(n=o.removeMin(),eo.has(i,n))r.setEdge(n,i[n]);else{if(s)throw new Error("Input graph is not connected: "+t);s=!0}t.nodeEdges(n).forEach(a)}return r},tarjan:No,topsort:Ao},version:lo.version};try{Co=Lo}catch(t){}Co||(Co=window.graphlib);var Mo=Co;var xo=function(t){return Yn(t,5)};var ko=function(t,e,n){if(!gt(n))return!1;var r=typeof e;return!!("number"==r?Pe(n)&&ye(e,n.length):"string"==r&&e in n)&&W(n[e],t)},Po=Object.prototype,Do=Po.hasOwnProperty,Uo=Bi((function(t,e){t=Object(t);var n=-1,r=e.length,i=r>2?e[2]:void 0;for(i&&ko(e[0],e[1],i)&&(r=1);++n<r;)for(var o=e[n],a=Fe(o),s=-1,u=a.length;++s<u;){var c=a[s],l=t[c];(void 0===l||W(l,Po[c])&&!Do.call(t,c))&&(t[c]=o[c])}return t}));var jo=function(t){return function(e,n,r){var i=Object(e);if(!Pe(e)){var o=Jr(n);e=De(e),n=function(t){return o(i[t],t,i)}}var a=t(e,n,r);return a>-1?i[o?e[a]:a]:void 0}},Go=/^\s+|\s+$/g,Bo=/^[-+]0x[0-9a-f]+$/i,Fo=/^0b[01]+$/i,Ho=/^0o[0-7]+$/i,Vo=parseInt;var Wo=function(t){if("number"==typeof t)return t;if(Sr(t))return NaN;if(gt(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=gt(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(Go,"");var n=Fo.test(t);return n||Ho.test(t)?Vo(t.slice(2),n?2:8):Bo.test(t)?NaN:+t},zo=1/0;var Yo=function(t){return t?(t=Wo(t))===zo||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0};var $o=function(t){var e=Yo(t),n=e%1;return e==e?n?e-n:e:0},Xo=Math.max;var qo=jo((function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:$o(n);return i<0&&(i=Xo(r+i,0)),Fi(t,Jr(e),i)}));var Ko=function(t){return(null==t?0:t.length)?xi(t,1):[]};var Qo=function(t,e){return null==t?t:qn(t,Jn(e),Fe)};var Zo=function(t){var e=null==t?0:t.length;return e?t[e-1]:void 0};var Jo=function(t,e){var n={};return e=Jr(e),Kn(t,(function(t,r,i){ie(n,r,e(t,r,i))})),n};var ta=function(t,e,n){for(var r=-1,i=t.length;++r<i;){var o=t[r],a=e(o);if(null!=a&&(void 0===s?a==a&&!Sr(a):n(a,s)))var s=a,u=o}return u};var ea=function(t,e){return t>e};var na=function(t){return t&&t.length?ta(t,Zn,ea):void 0};var ra=function(t,e,n){(void 0!==n&&!W(t[e],n)||void 0===n&&!(e in t))&&ie(t,e,n)},ia=Function.prototype,oa=Object.prototype,aa=ia.toString,sa=oa.hasOwnProperty,ua=aa.call(Object);var ca=function(t){if(!ce(t)||"[object Object]"!=vt(t))return!1;var e=Ze(t);if(null===e)return!0;var n=sa.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&aa.call(n)==ua};var la=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]};var ha=function(t){return se(t,Fe(t))};var fa=function(t,e,n,r,i,o,a){var s=la(t,n),u=la(e,n),c=a.get(u);if(c)ra(t,n,c);else{var l=o?o(s,u,n+"",t,e,a):void 0,h=void 0===l;if(h){var f=ve(u),d=!f&&Ee(u),p=!f&&!d&&Re(u);l=u,f||d||p?ve(s)?l=s:Ki(s)?l=We(s):d?(h=!1,l=Ve(u,!0)):p?(h=!1,l=Ln(u,!0)):l=[]:ca(u)||pe(u)?(l=s,pe(s)?l=ha(s):gt(s)&&!mt(s)||(l=Pn(u))):h=!1}h&&(a.set(u,l),i(l,u,r,o,a),a.delete(u)),ra(t,n,l)}};var da=function t(e,n,r,i,o){e!==n&&qn(n,(function(a,s){if(o||(o=new ee),gt(a))fa(e,n,s,r,t,i,o);else{var u=i?i(la(e,s),a,s+"",e,n,o):void 0;void 0===u&&(u=a),ra(e,s,u)}}),Fe)};var pa=function(t){return Bi((function(e,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;for(o=t.length>3&&"function"==typeof o?(i--,o):void 0,a&&ko(n[0],n[1],a)&&(o=i<3?void 0:o,i=1),e=Object(e);++r<i;){var s=n[r];s&&t(e,s,r,o)}return e}))}((function(t,e,n){da(t,e,n)}));var va=function(t,e){return t<e};var ga=function(t){return t&&t.length?ta(t,Zn,va):void 0};var Ea=function(t,e){return t&&t.length?ta(t,Jr(e),va):void 0},ma=function(){return ot.Date.now()};var ya=function(t,e,n,r){if(!gt(t))return t;for(var i=-1,o=(e=Hr(e,t)).length,a=o-1,s=t;null!=s&&++i<o;){var u=Vr(e[i]),c=n;if("__proto__"===u||"constructor"===u||"prototype"===u)return t;if(i!=a){var l=s[u];void 0===(c=r?r(l,u,s):void 0)&&(c=gt(l)?l:ye(e[i+1])?[]:{})}ae(s,u,c),s=s[u]}return t};var _a=function(t,e,n){for(var r=-1,i=e.length,o={};++r<i;){var a=e[r],s=Wr(t,a);n(s,a)&&ya(o,Hr(a,t),s)}return o};var Na=function(t,e){return _a(t,e,(function(e,n){return Xr(t,n)}))};var Ta=function(t){return Gi(Di(t,void 0,Ko),t+"")}((function(t,e){return null==t?{}:Na(t,e)})),wa=Math.ceil,ba=Math.max;var Aa=function(t,e,n,r){for(var i=-1,o=ba(wa((e-t)/(n||1)),0),a=Array(o);o--;)a[r?o:++i]=t,t+=n;return a};var Ra=function(t){return function(e,n,r){return r&&"number"!=typeof r&&ko(e,n,r)&&(n=r=void 0),e=Yo(e),void 0===n?(n=e,e=0):n=Yo(n),r=void 0===r?e<n?1:-1:Yo(r),Aa(e,n,r,t)}}();var Oa=function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t};var Sa=function(t,e){if(t!==e){var n=void 0!==t,r=null===t,i=t==t,o=Sr(t),a=void 0!==e,s=null===e,u=e==e,c=Sr(e);if(!s&&!c&&!o&&t>e||o&&a&&u&&!s&&!c||r&&a&&u||!n&&u||!i)return 1;if(!r&&!o&&!c&&t<e||c&&n&&i&&!r&&!o||s&&n&&i||!a&&i||!u)return-1}return 0};var Ia=function(t,e,n){for(var r=-1,i=t.criteria,o=e.criteria,a=i.length,s=n.length;++r<a;){var u=Sa(i[r],o[r]);if(u)return r>=s?u:u*("desc"==n[r]?-1:1)}return t.index-e.index};var Ca=function(t,e,n){e=e.length?Ur(e,(function(t){return ve(t)?function(e){return Wr(e,1===t.length?t[0]:t)}:t})):[Zn];var r=-1;e=Ur(e,we(Jr));var i=si(t,(function(t,n,i){return{criteria:Ur(e,(function(e){return e(t)})),index:++r,value:t}}));return Oa(i,(function(t,e){return Ia(t,e,n)}))},La=Bi((function(t,e){if(null==t)return[];var n=e.length;return n>1&&ko(t,e[0],e[1])?e=[]:n>2&&ko(e[0],e[1],e[2])&&(e=[e[0]]),Ca(t,xi(e,1),[])})),Ma=0;var xa=function(t){var e=++Ma;return Fr(t)+e};var ka=function(t,e,n){for(var r=-1,i=t.length,o=e.length,a={};++r<i;){var s=r<o?e[r]:void 0;n(a,t[r],s)}return a};var Pa,Da=function(t,e){return ka(t||[],e||[],ae)};try{Pa={cloneDeep:xo,constant:Xn,defaults:Uo,each:er,filter:ti,find:qo,flatten:Ko,forEach:tr,forIn:Qo,has:ri,isUndefined:ai,last:Zo,map:ui,mapValues:Jo,max:na,merge:pa,min:ga,minBy:Ea,now:ma,pick:Ta,range:Ra,reduce:hi,sortBy:La,uniqueId:xa,values:to,zipObject:Da}}catch(t){}Pa||(Pa=window._);var Ua=Pa,ja=Ga;function Ga(){var t={};t._next=t._prev=t,this._sentinel=t}function Ba(t){t._prev._next=t._next,t._next._prev=t._prev,delete t._next,delete t._prev}function Fa(t,e){if("_next"!==t&&"_prev"!==t)return e}Ga.prototype.dequeue=function(){var t=this._sentinel,e=t._prev;if(e!==t)return Ba(e),e},Ga.prototype.enqueue=function(t){var e=this._sentinel;t._prev&&t._next&&Ba(t),t._next=e._next,e._next._prev=t,e._next=t,t._prev=e},Ga.prototype.toString=function(){for(var t=[],e=this._sentinel,n=e._prev;n!==e;)t.push(JSON.stringify(n,Fa)),n=n._prev;return"["+t.join(", ")+"]"};var Ha=Mo.Graph,Va=function(t,e){if(t.nodeCount()<=1)return[];var n=function(t,e){var n=new Ha,r=0,i=0;Ua.forEach(t.nodes(),(function(t){n.setNode(t,{v:t,in:0,out:0})})),Ua.forEach(t.edges(),(function(t){var o=n.edge(t.v,t.w)||0,a=e(t),s=o+a;n.setEdge(t.v,t.w,s),i=Math.max(i,n.node(t.v).out+=a),r=Math.max(r,n.node(t.w).in+=a)}));var o=Ua.range(i+r+3).map((function(){return new ja})),a=r+1;return Ua.forEach(n.nodes(),(function(t){Ya(o,a,n.node(t))})),{graph:n,buckets:o,zeroIdx:a}}(t,e||Wa),r=function(t,e,n){var r,i=[],o=e[e.length-1],a=e[0];for(;t.nodeCount();){for(;r=a.dequeue();)za(t,e,n,r);for(;r=o.dequeue();)za(t,e,n,r);if(t.nodeCount())for(var s=e.length-2;s>0;--s)if(r=e[s].dequeue()){i=i.concat(za(t,e,n,r,!0));break}}return i}(n.graph,n.buckets,n.zeroIdx);return Ua.flatten(Ua.map(r,(function(e){return t.outEdges(e.v,e.w)})),!0)},Wa=Ua.constant(1);function za(t,e,n,r,i){var o=i?[]:void 0;return Ua.forEach(t.inEdges(r.v),(function(r){var a=t.edge(r),s=t.node(r.v);i&&o.push({v:r.v,w:r.w}),s.out-=a,Ya(e,n,s)})),Ua.forEach(t.outEdges(r.v),(function(r){var i=t.edge(r),o=r.w,a=t.node(o);a.in-=i,Ya(e,n,a)})),t.removeNode(r.v),o}function Ya(t,e,n){n.out?n.in?t[n.out-n.in+e].enqueue(n):t[t.length-1].enqueue(n):t[0].enqueue(n)}var $a={run:function(t){var e="greedy"===t.graph().acyclicer?Va(t,function(t){return function(e){return t.edge(e).weight}}(t)):function(t){var e=[],n={},r={};function i(o){Ua.has(r,o)||(r[o]=!0,n[o]=!0,Ua.forEach(t.outEdges(o),(function(t){Ua.has(n,t.w)?e.push(t):i(t.w)})),delete n[o])}return Ua.forEach(t.nodes(),i),e}(t);Ua.forEach(e,(function(e){var n=t.edge(e);t.removeEdge(e),n.forwardName=e.name,n.reversed=!0,t.setEdge(e.w,e.v,n,Ua.uniqueId("rev"))}))},undo:function(t){Ua.forEach(t.edges(),(function(e){var n=t.edge(e);if(n.reversed){t.removeEdge(e);var r=n.forwardName;delete n.reversed,delete n.forwardName,t.setEdge(e.w,e.v,n,r)}}))}};var Xa=Mo.Graph,qa={addDummyNode:Ka,simplify:function(t){var e=(new Xa).setGraph(t.graph());return Ua.forEach(t.nodes(),(function(n){e.setNode(n,t.node(n))})),Ua.forEach(t.edges(),(function(n){var r=e.edge(n.v,n.w)||{weight:0,minlen:1},i=t.edge(n);e.setEdge(n.v,n.w,{weight:r.weight+i.weight,minlen:Math.max(r.minlen,i.minlen)})})),e},asNonCompoundGraph:function(t){var e=new Xa({multigraph:t.isMultigraph()}).setGraph(t.graph());return Ua.forEach(t.nodes(),(function(n){t.children(n).length||e.setNode(n,t.node(n))})),Ua.forEach(t.edges(),(function(n){e.setEdge(n,t.edge(n))})),e},successorWeights:function(t){var e=Ua.map(t.nodes(),(function(e){var n={};return Ua.forEach(t.outEdges(e),(function(e){n[e.w]=(n[e.w]||0)+t.edge(e).weight})),n}));return Ua.zipObject(t.nodes(),e)},predecessorWeights:function(t){var e=Ua.map(t.nodes(),(function(e){var n={};return Ua.forEach(t.inEdges(e),(function(e){n[e.v]=(n[e.v]||0)+t.edge(e).weight})),n}));return Ua.zipObject(t.nodes(),e)},intersectRect:function(t,e){var n,r,i=t.x,o=t.y,a=e.x-i,s=e.y-o,u=t.width/2,c=t.height/2;if(!a&&!s)throw new Error("Not possible to find intersection inside of the rectangle");Math.abs(s)*u>Math.abs(a)*c?(s<0&&(c=-c),n=c*a/s,r=c):(a<0&&(u=-u),n=u,r=u*s/a);return{x:i+n,y:o+r}},buildLayerMatrix:function(t){var e=Ua.map(Ua.range(Qa(t)+1),(function(){return[]}));return Ua.forEach(t.nodes(),(function(n){var r=t.node(n),i=r.rank;Ua.isUndefined(i)||(e[i][r.order]=n)})),e},normalizeRanks:function(t){var e=Ua.min(Ua.map(t.nodes(),(function(e){return t.node(e).rank})));Ua.forEach(t.nodes(),(function(n){var r=t.node(n);Ua.has(r,"rank")&&(r.rank-=e)}))},removeEmptyRanks:function(t){var e=Ua.min(Ua.map(t.nodes(),(function(e){return t.node(e).rank}))),n=[];Ua.forEach(t.nodes(),(function(r){var i=t.node(r).rank-e;n[i]||(n[i]=[]),n[i].push(r)}));var r=0,i=t.graph().nodeRankFactor;Ua.forEach(n,(function(e,n){Ua.isUndefined(e)&&n%i!=0?--r:r&&Ua.forEach(e,(function(e){t.node(e).rank+=r}))}))},addBorderNode:function(t,e,n,r){var i={width:0,height:0};arguments.length>=4&&(i.rank=n,i.order=r);return Ka(t,"border",i,e)},maxRank:Qa,partition:function(t,e){var n={lhs:[],rhs:[]};return Ua.forEach(t,(function(t){e(t)?n.lhs.push(t):n.rhs.push(t)})),n},time:function(t,e){var n=Ua.now();try{return e()}finally{console.log(t+" time: "+(Ua.now()-n)+"ms")}},notime:function(t,e){return e()}};function Ka(t,e,n,r){var i;do{i=Ua.uniqueId(r)}while(t.hasNode(i));return n.dummy=e,t.setNode(i,n),i}function Qa(t){return Ua.max(Ua.map(t.nodes(),(function(e){var n=t.node(e).rank;if(!Ua.isUndefined(n))return n})))}var Za={run:function(t){t.graph().dummyChains=[],Ua.forEach(t.edges(),(function(e){!function(t,e){var n,r,i,o=e.v,a=t.node(o).rank,s=e.w,u=t.node(s).rank,c=e.name,l=t.edge(e),h=l.labelRank;if(u===a+1)return;for(t.removeEdge(e),i=0,++a;a<u;++i,++a)l.points=[],r={width:0,height:0,edgeLabel:l,edgeObj:e,rank:a},n=qa.addDummyNode(t,"edge",r,"_d"),a===h&&(r.width=l.width,r.height=l.height,r.dummy="edge-label",r.labelpos=l.labelpos),t.setEdge(o,n,{weight:l.weight},c),0===i&&t.graph().dummyChains.push(n),o=n;t.setEdge(o,s,{weight:l.weight},c)}(t,e)}))},undo:function(t){Ua.forEach(t.graph().dummyChains,(function(e){var n,r=t.node(e),i=r.edgeLabel;for(t.setEdge(r.edgeObj,i);r.dummy;)n=t.successors(e)[0],t.removeNode(e),i.points.push({x:r.x,y:r.y}),"edge-label"===r.dummy&&(i.x=r.x,i.y=r.y,i.width=r.width,i.height=r.height),e=n,r=t.node(e)}))}};var Ja=function(t){var e={};Ua.forEach(t.sources(),(function n(r){var i=t.node(r);if(Ua.has(e,r))return i.rank;e[r]=!0;var o=Ua.min(Ua.map(t.outEdges(r),(function(e){return n(e.w)-t.edge(e).minlen})));return o!==Number.POSITIVE_INFINITY&&null!=o||(o=0),i.rank=o}))},ts=function(t,e){return t.node(e.w).rank-t.node(e.v).rank-t.edge(e).minlen};var es=Mo.Graph,ns=ts,rs=function(t){var e,n,r=new es({directed:!1}),i=t.nodes()[0],o=t.nodeCount();r.setNode(i,{});for(;is(r,t)<o;)e=os(r,t),n=r.hasNode(e.v)?ns(t,e):-ns(t,e),as(r,t,n);return r};function is(t,e){return Ua.forEach(t.nodes(),(function n(r){Ua.forEach(e.nodeEdges(r),(function(i){var o=i.v,a=r===o?i.w:o;t.hasNode(a)||ns(e,i)||(t.setNode(a,{}),t.setEdge(r,a,{}),n(a))}))})),t.nodeCount()}function os(t,e){return Ua.minBy(e.edges(),(function(n){if(t.hasNode(n.v)!==t.hasNode(n.w))return ns(e,n)}))}function as(t,e,n){Ua.forEach(t.nodes(),(function(t){e.node(t).rank+=n}))}var ss=ts,us=Ja,cs=Mo.alg.preorder,ls=Mo.alg.postorder,hs=qa.simplify,fs=ds;function ds(t){t=hs(t),us(t);var e,n=rs(t);for(gs(n),ps(n,t);e=ms(n);)_s(n,t,e,ys(n,t,e))}function ps(t,e){var n=ls(t,t.nodes());n=n.slice(0,n.length-1),Ua.forEach(n,(function(n){!function(t,e,n){var r=t.node(n).parent;t.edge(n,r).cutvalue=vs(t,e,n)}(t,e,n)}))}function vs(t,e,n){var r=t.node(n).parent,i=!0,o=e.edge(n,r),a=0;return o||(i=!1,o=e.edge(r,n)),a=o.weight,Ua.forEach(e.nodeEdges(n),(function(o){var s,u,c=o.v===n,l=c?o.w:o.v;if(l!==r){var h=c===i,f=e.edge(o).weight;if(a+=h?f:-f,s=n,u=l,t.hasEdge(s,u)){var d=t.edge(n,l).cutvalue;a+=h?-d:d}}})),a}function gs(t,e){arguments.length<2&&(e=t.nodes()[0]),Es(t,{},1,e)}function Es(t,e,n,r,i){var o=n,a=t.node(r);return e[r]=!0,Ua.forEach(t.neighbors(r),(function(i){Ua.has(e,i)||(n=Es(t,e,n,i,r))})),a.low=o,a.lim=n++,i?a.parent=i:delete a.parent,n}function ms(t){return Ua.find(t.edges(),(function(e){return t.edge(e).cutvalue<0}))}function ys(t,e,n){var r=n.v,i=n.w;e.hasEdge(r,i)||(r=n.w,i=n.v);var o=t.node(r),a=t.node(i),s=o,u=!1;o.lim>a.lim&&(s=a,u=!0);var c=Ua.filter(e.edges(),(function(e){return u===Ns(t,t.node(e.v),s)&&u!==Ns(t,t.node(e.w),s)}));return Ua.minBy(c,(function(t){return ss(e,t)}))}function _s(t,e,n,r){var i=n.v,o=n.w;t.removeEdge(i,o),t.setEdge(r.v,r.w,{}),gs(t),ps(t,e),function(t,e){var n=Ua.find(t.nodes(),(function(t){return!e.node(t).parent})),r=cs(t,n);r=r.slice(1),Ua.forEach(r,(function(n){var r=t.node(n).parent,i=e.edge(n,r),o=!1;i||(i=e.edge(r,n),o=!0),e.node(n).rank=e.node(r).rank+(o?i.minlen:-i.minlen)}))}(t,e)}function Ns(t,e,n){return n.low<=e.lim&&e.lim<=n.lim}ds.initLowLimValues=gs,ds.initCutValues=ps,ds.calcCutValue=vs,ds.leaveEdge=ms,ds.enterEdge=ys,ds.exchangeEdges=_s;var Ts=Ja,ws=function(t){switch(t.graph().ranker){case"network-simplex":As(t);break;case"tight-tree":!function(t){Ts(t),rs(t)}(t);break;case"longest-path":bs(t);break;default:As(t)}};var bs=Ts;function As(t){fs(t)}var Rs=function(t){var e=function(t){var e={},n=0;function r(i){var o=n;Ua.forEach(t.children(i),r),e[i]={low:o,lim:n++}}return Ua.forEach(t.children(),r),e}(t);Ua.forEach(t.graph().dummyChains,(function(n){for(var r=t.node(n),i=r.edgeObj,o=function(t,e,n,r){var i,o,a=[],s=[],u=Math.min(e[n].low,e[r].low),c=Math.max(e[n].lim,e[r].lim);i=n;do{i=t.parent(i),a.push(i)}while(i&&(e[i].low>u||c>e[i].lim));o=i,i=r;for(;(i=t.parent(i))!==o;)s.push(i);return{path:a.concat(s.reverse()),lca:o}}(t,e,i.v,i.w),a=o.path,s=o.lca,u=0,c=a[u],l=!0;n!==i.w;){if(r=t.node(n),l){for(;(c=a[u])!==s&&t.node(c).maxRank<r.rank;)u++;c===s&&(l=!1)}if(!l){for(;u<a.length-1&&t.node(c=a[u+1]).minRank<=r.rank;)u++;c=a[u]}t.setParent(n,c),n=t.successors(n)[0]}}))};var Os={run:function(t){var e=qa.addDummyNode(t,"root",{},"_root"),n=function(t){var e={};function n(r,i){var o=t.children(r);o&&o.length&&Ua.forEach(o,(function(t){n(t,i+1)})),e[r]=i}return Ua.forEach(t.children(),(function(t){n(t,1)})),e}(t),r=Ua.max(Ua.values(n))-1,i=2*r+1;t.graph().nestingRoot=e,Ua.forEach(t.edges(),(function(e){t.edge(e).minlen*=i}));var o=function(t){return Ua.reduce(t.edges(),(function(e,n){return e+t.edge(n).weight}),0)}(t)+1;Ua.forEach(t.children(),(function(a){Ss(t,e,i,o,r,n,a)})),t.graph().nodeRankFactor=i},cleanup:function(t){var e=t.graph();t.removeNode(e.nestingRoot),delete e.nestingRoot,Ua.forEach(t.edges(),(function(e){t.edge(e).nestingEdge&&t.removeEdge(e)}))}};function Ss(t,e,n,r,i,o,a){var s=t.children(a);if(s.length){var u=qa.addBorderNode(t,"_bt"),c=qa.addBorderNode(t,"_bb"),l=t.node(a);t.setParent(u,a),l.borderTop=u,t.setParent(c,a),l.borderBottom=c,Ua.forEach(s,(function(s){Ss(t,e,n,r,i,o,s);var l=t.node(s),h=l.borderTop?l.borderTop:s,f=l.borderBottom?l.borderBottom:s,d=l.borderTop?r:2*r,p=h!==f?1:i-o[a]+1;t.setEdge(u,h,{weight:d,minlen:p,nestingEdge:!0}),t.setEdge(f,c,{weight:d,minlen:p,nestingEdge:!0})})),t.parent(a)||t.setEdge(e,u,{weight:0,minlen:i+o[a]})}else a!==e&&t.setEdge(e,a,{weight:0,minlen:n})}var Is=function(t){Ua.forEach(t.children(),(function e(n){var r=t.children(n),i=t.node(n);if(r.length&&Ua.forEach(r,e),Ua.has(i,"minRank")){i.borderLeft=[],i.borderRight=[];for(var o=i.minRank,a=i.maxRank+1;o<a;++o)Cs(t,"borderLeft","_bl",n,i,o),Cs(t,"borderRight","_br",n,i,o)}}))};function Cs(t,e,n,r,i,o){var a={width:0,height:0,rank:o,borderType:e},s=i[e][o-1],u=qa.addDummyNode(t,"border",a,n);i[e][o]=u,t.setParent(u,r),s&&t.setEdge(s,u,{weight:1})}var Ls={adjust:function(t){var e=t.graph().rankdir.toLowerCase();"lr"!==e&&"rl"!==e||Ms(t)},undo:function(t){var e=t.graph().rankdir.toLowerCase();"bt"!==e&&"rl"!==e||function(t){Ua.forEach(t.nodes(),(function(e){ks(t.node(e))})),Ua.forEach(t.edges(),(function(e){var n=t.edge(e);Ua.forEach(n.points,ks),Ua.has(n,"y")&&ks(n)}))}(t);"lr"!==e&&"rl"!==e||(!function(t){Ua.forEach(t.nodes(),(function(e){Ps(t.node(e))})),Ua.forEach(t.edges(),(function(e){var n=t.edge(e);Ua.forEach(n.points,Ps),Ua.has(n,"x")&&Ps(n)}))}(t),Ms(t))}};function Ms(t){Ua.forEach(t.nodes(),(function(e){xs(t.node(e))})),Ua.forEach(t.edges(),(function(e){xs(t.edge(e))}))}function xs(t){var e=t.width;t.width=t.height,t.height=e}function ks(t){t.y=-t.y}function Ps(t){var e=t.x;t.x=t.y,t.y=e}var Ds=function(t){var e={},n=Ua.filter(t.nodes(),(function(e){return!t.children(e).length})),r=Ua.max(Ua.map(n,(function(e){return t.node(e).rank}))),i=Ua.map(Ua.range(r+1),(function(){return[]}));function o(n){if(!Ua.has(e,n)){e[n]=!0;var r=t.node(n);i[r.rank].push(n),Ua.forEach(t.successors(n),o)}}var a=Ua.sortBy(n,(function(e){return t.node(e).rank}));return Ua.forEach(a,o),i};var Us=function(t,e){for(var n=0,r=1;r<e.length;++r)n+=js(t,e[r-1],e[r]);return n};function js(t,e,n){for(var r=Ua.zipObject(n,Ua.map(n,(function(t,e){return e}))),i=Ua.flatten(Ua.map(e,(function(e){return Ua.sortBy(Ua.map(t.outEdges(e),(function(e){return{pos:r[e.w],weight:t.edge(e).weight}})),"pos")})),!0),o=1;o<n.length;)o<<=1;var a=2*o-1;o-=1;var s=Ua.map(new Array(a),(function(){return 0})),u=0;return Ua.forEach(i.forEach((function(t){var e=t.pos+o;s[e]+=t.weight;for(var n=0;e>0;)e%2&&(n+=s[e+1]),s[e=e-1>>1]+=t.weight;u+=t.weight*n}))),u}var Gs=function(t,e){return Ua.map(e,(function(e){var n=t.inEdges(e);if(n.length){var r=Ua.reduce(n,(function(e,n){var r=t.edge(n),i=t.node(n.v);return{sum:e.sum+r.weight*i.order,weight:e.weight+r.weight}}),{sum:0,weight:0});return{v:e,barycenter:r.sum/r.weight,weight:r.weight}}return{v:e}}))};var Bs=function(t,e){var n={};return Ua.forEach(t,(function(t,e){var r=n[t.v]={indegree:0,in:[],out:[],vs:[t.v],i:e};Ua.isUndefined(t.barycenter)||(r.barycenter=t.barycenter,r.weight=t.weight)})),Ua.forEach(e.edges(),(function(t){var e=n[t.v],r=n[t.w];Ua.isUndefined(e)||Ua.isUndefined(r)||(r.indegree++,e.out.push(n[t.w]))})),function(t){var e=[];function n(t){return function(e){e.merged||(Ua.isUndefined(e.barycenter)||Ua.isUndefined(t.barycenter)||e.barycenter>=t.barycenter)&&function(t,e){var n=0,r=0;t.weight&&(n+=t.barycenter*t.weight,r+=t.weight);e.weight&&(n+=e.barycenter*e.weight,r+=e.weight);t.vs=e.vs.concat(t.vs),t.barycenter=n/r,t.weight=r,t.i=Math.min(e.i,t.i),e.merged=!0}(t,e)}}function r(e){return function(n){n.in.push(e),0==--n.indegree&&t.push(n)}}for(;t.length;){var i=t.pop();e.push(i),Ua.forEach(i.in.reverse(),n(i)),Ua.forEach(i.out,r(i))}return Ua.map(Ua.filter(e,(function(t){return!t.merged})),(function(t){return Ua.pick(t,["vs","i","barycenter","weight"])}))}(Ua.filter(n,(function(t){return!t.indegree})))};var Fs=function(t,e){var n=qa.partition(t,(function(t){return Ua.has(t,"barycenter")})),r=n.lhs,i=Ua.sortBy(n.rhs,(function(t){return-t.i})),o=[],a=0,s=0,u=0;r.sort((c=!!e,function(t,e){return t.barycenter<e.barycenter?-1:t.barycenter>e.barycenter?1:c?e.i-t.i:t.i-e.i})),u=Hs(o,i,u),Ua.forEach(r,(function(t){u+=t.vs.length,o.push(t.vs),a+=t.barycenter*t.weight,s+=t.weight,u=Hs(o,i,u)}));var c;var l={vs:Ua.flatten(o,!0)};s&&(l.barycenter=a/s,l.weight=s);return l};function Hs(t,e,n){for(var r;e.length&&(r=Ua.last(e)).i<=n;)e.pop(),t.push(r.vs),n++;return n}var Vs=function t(e,n,r,i){var o=e.children(n),a=e.node(n),s=a?a.borderLeft:void 0,u=a?a.borderRight:void 0,c={};s&&(o=Ua.filter(o,(function(t){return t!==s&&t!==u})));var l=Gs(e,o);Ua.forEach(l,(function(n){if(e.children(n.v).length){var o=t(e,n.v,r,i);c[n.v]=o,Ua.has(o,"barycenter")&&(a=n,s=o,Ua.isUndefined(a.barycenter)?(a.barycenter=s.barycenter,a.weight=s.weight):(a.barycenter=(a.barycenter*a.weight+s.barycenter*s.weight)/(a.weight+s.weight),a.weight+=s.weight))}var a,s}));var h=Bs(l,r);!function(t,e){Ua.forEach(t,(function(t){t.vs=Ua.flatten(t.vs.map((function(t){return e[t]?e[t].vs:t})),!0)}))}(h,c);var f=Fs(h,i);if(s&&(f.vs=Ua.flatten([s,f.vs,u],!0),e.predecessors(s).length)){var d=e.node(e.predecessors(s)[0]),p=e.node(e.predecessors(u)[0]);Ua.has(f,"barycenter")||(f.barycenter=0,f.weight=0),f.barycenter=(f.barycenter*f.weight+d.order+p.order)/(f.weight+2),f.weight+=2}return f};var Ws=Mo.Graph,zs=function(t,e,n){var r=function(t){var e;for(;t.hasNode(e=Ua.uniqueId("_root")););return e}(t),i=new Ws({compound:!0}).setGraph({root:r}).setDefaultNodeLabel((function(e){return t.node(e)}));return Ua.forEach(t.nodes(),(function(o){var a=t.node(o),s=t.parent(o);(a.rank===e||a.minRank<=e&&e<=a.maxRank)&&(i.setNode(o),i.setParent(o,s||r),Ua.forEach(t[n](o),(function(e){var n=e.v===o?e.w:e.v,r=i.edge(n,o),a=Ua.isUndefined(r)?0:r.weight;i.setEdge(n,o,{weight:t.edge(e).weight+a})})),Ua.has(a,"minRank")&&i.setNode(o,{borderLeft:a.borderLeft[e],borderRight:a.borderRight[e]}))})),i};var Ys=function(t,e,n){var r,i={};Ua.forEach(n,(function(n){for(var o,a,s=t.parent(n);s;){if((o=t.parent(s))?(a=i[o],i[o]=s):(a=r,r=s),a&&a!==s)return void e.setEdge(a,s);s=o}}))};var $s=Mo.Graph,Xs=function(t){var e=qa.maxRank(t),n=qs(t,Ua.range(1,e+1),"inEdges"),r=qs(t,Ua.range(e-1,-1,-1),"outEdges"),i=Ds(t);Qs(t,i);for(var o,a=Number.POSITIVE_INFINITY,s=0,u=0;u<4;++s,++u){Ks(s%2?n:r,s%4>=2),i=qa.buildLayerMatrix(t);var c=Us(t,i);c<a&&(u=0,o=Ua.cloneDeep(i),a=c)}Qs(t,o)};function qs(t,e,n){return Ua.map(e,(function(e){return zs(t,e,n)}))}function Ks(t,e){var n=new $s;Ua.forEach(t,(function(t){var r=t.graph().root,i=Vs(t,r,n,e);Ua.forEach(i.vs,(function(e,n){t.node(e).order=n})),Ys(t,n,i.vs)}))}function Qs(t,e){Ua.forEach(e,(function(e){Ua.forEach(e,(function(e,n){t.node(e).order=n}))}))}var Zs=Mo.Graph,Js=function(t){var e,n=qa.buildLayerMatrix(t),r=Ua.merge(tu(t,n),eu(t,n)),i={};Ua.forEach(["u","d"],(function(o){e="u"===o?n:Ua.values(n).reverse(),Ua.forEach(["l","r"],(function(n){"r"===n&&(e=Ua.map(e,(function(t){return Ua.values(t).reverse()})));var a=("u"===o?t.predecessors:t.successors).bind(t),s=iu(t,e,r,a),u=ou(t,e,s.root,s.align,"r"===n);"r"===n&&(u=Ua.mapValues(u,(function(t){return-t}))),i[o+n]=u}))}));var o=au(t,i);return su(i,o),uu(i,t.graph().align)};function tu(t,e){var n={};return Ua.reduce(e,(function(e,r){var i=0,o=0,a=e.length,s=Ua.last(r);return Ua.forEach(r,(function(e,u){var c=function(t,e){if(t.node(e).dummy)return Ua.find(t.predecessors(e),(function(e){return t.node(e).dummy}))}(t,e),l=c?t.node(c).order:a;(c||e===s)&&(Ua.forEach(r.slice(o,u+1),(function(e){Ua.forEach(t.predecessors(e),(function(r){var o=t.node(r),a=o.order;!(a<i||l<a)||o.dummy&&t.node(e).dummy||nu(n,r,e)}))})),o=u+1,i=l)})),r})),n}function eu(t,e){var n={};function r(e,r,i,o,a){var s;Ua.forEach(Ua.range(r,i),(function(r){s=e[r],t.node(s).dummy&&Ua.forEach(t.predecessors(s),(function(e){var r=t.node(e);r.dummy&&(r.order<o||r.order>a)&&nu(n,e,s)}))}))}return Ua.reduce(e,(function(e,n){var i,o=-1,a=0;return Ua.forEach(n,(function(s,u){if("border"===t.node(s).dummy){var c=t.predecessors(s);c.length&&(i=t.node(c[0]).order,r(n,a,u,o,i),a=u,o=i)}r(n,a,n.length,i,e.length)})),n})),n}function nu(t,e,n){if(e>n){var r=e;e=n,n=r}var i=t[e];i||(t[e]=i={}),i[n]=!0}function ru(t,e,n){if(e>n){var r=e;e=n,n=r}return Ua.has(t[e],n)}function iu(t,e,n,r){var i={},o={},a={};return Ua.forEach(e,(function(t){Ua.forEach(t,(function(t,e){i[t]=t,o[t]=t,a[t]=e}))})),Ua.forEach(e,(function(t){var e=-1;Ua.forEach(t,(function(t){var s=r(t);if(s.length)for(var u=((s=Ua.sortBy(s,(function(t){return a[t]}))).length-1)/2,c=Math.floor(u),l=Math.ceil(u);c<=l;++c){var h=s[c];o[t]===t&&e<a[h]&&!ru(n,t,h)&&(o[h]=t,o[t]=i[t]=i[h],e=a[h])}}))})),{root:i,align:o}}function ou(t,e,n,r,i){var o={},a=function(t,e,n,r){var i=new Zs,o=t.graph(),a=function(t,e,n){return function(r,i,o){var a,s=r.node(i),u=r.node(o),c=0;if(c+=s.width/2,Ua.has(s,"labelpos"))switch(s.labelpos.toLowerCase()){case"l":a=-s.width/2;break;case"r":a=s.width/2}if(a&&(c+=n?a:-a),a=0,c+=(s.dummy?e:t)/2,c+=(u.dummy?e:t)/2,c+=u.width/2,Ua.has(u,"labelpos"))switch(u.labelpos.toLowerCase()){case"l":a=u.width/2;break;case"r":a=-u.width/2}return a&&(c+=n?a:-a),a=0,c}}(o.nodesep,o.edgesep,r);return Ua.forEach(e,(function(e){var r;Ua.forEach(e,(function(e){var o=n[e];if(i.setNode(o),r){var s=n[r],u=i.edge(s,o);i.setEdge(s,o,Math.max(a(t,e,r),u||0))}r=e}))})),i}(t,e,n,i),s=i?"borderLeft":"borderRight";function u(t,e){for(var n=a.nodes(),r=n.pop(),i={};r;)i[r]?t(r):(i[r]=!0,n.push(r),n=n.concat(e(r))),r=n.pop()}return u((function(t){o[t]=a.inEdges(t).reduce((function(t,e){return Math.max(t,o[e.v]+a.edge(e))}),0)}),a.predecessors.bind(a)),u((function(e){var n=a.outEdges(e).reduce((function(t,e){return Math.min(t,o[e.w]-a.edge(e))}),Number.POSITIVE_INFINITY),r=t.node(e);n!==Number.POSITIVE_INFINITY&&r.borderType!==s&&(o[e]=Math.max(o[e],n))}),a.successors.bind(a)),Ua.forEach(r,(function(t){o[t]=o[n[t]]})),o}function au(t,e){return Ua.minBy(Ua.values(e),(function(e){var n=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY;return Ua.forIn(e,(function(e,i){var o=function(t,e){return t.node(e).width}(t,i)/2;n=Math.max(e+o,n),r=Math.min(e-o,r)})),n-r}))}function su(t,e){var n=Ua.values(e),r=Ua.min(n),i=Ua.max(n);Ua.forEach(["u","d"],(function(n){Ua.forEach(["l","r"],(function(o){var a,s=n+o,u=t[s];if(u!==e){var c=Ua.values(u);(a="l"===o?r-Ua.min(c):i-Ua.max(c))&&(t[s]=Ua.mapValues(u,(function(t){return t+a})))}}))}))}function uu(t,e){return Ua.mapValues(t.ul,(function(n,r){if(e)return t[e.toLowerCase()][r];var i=Ua.sortBy(Ua.map(t,r));return(i[1]+i[2])/2}))}var cu=Js,lu=function(t){(function(t){var e=qa.buildLayerMatrix(t),n=t.graph().ranksep,r=0;Ua.forEach(e,(function(e){var i=Ua.max(Ua.map(e,(function(e){return t.node(e).height})));Ua.forEach(e,(function(e){t.node(e).y=r+i/2})),r+=i+n}))})(t=qa.asNonCompoundGraph(t)),Ua.forEach(cu(t),(function(e,n){t.node(n).x=e}))};var hu=qa.normalizeRanks,fu=qa.removeEmptyRanks,du=qa,pu=Mo.Graph,vu=function(t,e){var n=e&&e.debugTiming?du.time:du.notime;n("layout",(function(){var e=n("  buildLayoutGraph",(function(){return function(t){var e=new pu({multigraph:!0,compound:!0}),n=Au(t.graph());return e.setGraph(Ua.merge({},Eu,bu(n,gu),Ua.pick(n,mu))),Ua.forEach(t.nodes(),(function(n){var r=Au(t.node(n));e.setNode(n,Ua.defaults(bu(r,yu),_u)),e.setParent(n,t.parent(n))})),Ua.forEach(t.edges(),(function(n){var r=Au(t.edge(n));e.setEdge(n,Ua.merge({},Tu,bu(r,Nu),Ua.pick(r,wu)))})),e}(t)}));n("  runLayout",(function(){!function(t,e){e("    makeSpaceForEdgeLabels",(function(){!function(t){var e=t.graph();e.ranksep/=2,Ua.forEach(t.edges(),(function(n){var r=t.edge(n);r.minlen*=2,"c"!==r.labelpos.toLowerCase()&&("TB"===e.rankdir||"BT"===e.rankdir?r.width+=r.labeloffset:r.height+=r.labeloffset)}))}(t)})),e("    removeSelfEdges",(function(){!function(t){Ua.forEach(t.edges(),(function(e){if(e.v===e.w){var n=t.node(e.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:e,label:t.edge(e)}),t.removeEdge(e)}}))}(t)})),e("    acyclic",(function(){$a.run(t)})),e("    nestingGraph.run",(function(){Os.run(t)})),e("    rank",(function(){ws(du.asNonCompoundGraph(t))})),e("    injectEdgeLabelProxies",(function(){!function(t){Ua.forEach(t.edges(),(function(e){var n=t.edge(e);if(n.width&&n.height){var r=t.node(e.v),i={rank:(t.node(e.w).rank-r.rank)/2+r.rank,e:e};du.addDummyNode(t,"edge-proxy",i,"_ep")}}))}(t)})),e("    removeEmptyRanks",(function(){fu(t)})),e("    nestingGraph.cleanup",(function(){Os.cleanup(t)})),e("    normalizeRanks",(function(){hu(t)})),e("    assignRankMinMax",(function(){!function(t){var e=0;Ua.forEach(t.nodes(),(function(n){var r=t.node(n);r.borderTop&&(r.minRank=t.node(r.borderTop).rank,r.maxRank=t.node(r.borderBottom).rank,e=Ua.max(e,r.maxRank))})),t.graph().maxRank=e}(t)})),e("    removeEdgeLabelProxies",(function(){!function(t){Ua.forEach(t.nodes(),(function(e){var n=t.node(e);"edge-proxy"===n.dummy&&(t.edge(n.e).labelRank=n.rank,t.removeNode(e))}))}(t)})),e("    normalize.run",(function(){Za.run(t)})),e("    parentDummyChains",(function(){Rs(t)})),e("    addBorderSegments",(function(){Is(t)})),e("    order",(function(){Xs(t)})),e("    insertSelfEdges",(function(){!function(t){var e=du.buildLayerMatrix(t);Ua.forEach(e,(function(e){var n=0;Ua.forEach(e,(function(e,r){var i=t.node(e);i.order=r+n,Ua.forEach(i.selfEdges,(function(e){du.addDummyNode(t,"selfedge",{width:e.label.width,height:e.label.height,rank:i.rank,order:r+ ++n,e:e.e,label:e.label},"_se")})),delete i.selfEdges}))}))}(t)})),e("    adjustCoordinateSystem",(function(){Ls.adjust(t)})),e("    position",(function(){lu(t)})),e("    positionSelfEdges",(function(){!function(t){Ua.forEach(t.nodes(),(function(e){var n=t.node(e);if("selfedge"===n.dummy){var r=t.node(n.e.v),i=r.x+r.width/2,o=r.y,a=n.x-i,s=r.height/2;t.setEdge(n.e,n.label),t.removeNode(e),n.label.points=[{x:i+2*a/3,y:o-s},{x:i+5*a/6,y:o-s},{x:i+a,y:o},{x:i+5*a/6,y:o+s},{x:i+2*a/3,y:o+s}],n.label.x=n.x,n.label.y=n.y}}))}(t)})),e("    removeBorderNodes",(function(){!function(t){Ua.forEach(t.nodes(),(function(e){if(t.children(e).length){var n=t.node(e),r=t.node(n.borderTop),i=t.node(n.borderBottom),o=t.node(Ua.last(n.borderLeft)),a=t.node(Ua.last(n.borderRight));n.width=Math.abs(a.x-o.x),n.height=Math.abs(i.y-r.y),n.x=o.x+n.width/2,n.y=r.y+n.height/2}})),Ua.forEach(t.nodes(),(function(e){"border"===t.node(e).dummy&&t.removeNode(e)}))}(t)})),e("    normalize.undo",(function(){Za.undo(t)})),e("    fixupEdgeLabelCoords",(function(){!function(t){Ua.forEach(t.edges(),(function(e){var n=t.edge(e);if(Ua.has(n,"x"))switch("l"!==n.labelpos&&"r"!==n.labelpos||(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset}}))}(t)})),e("    undoCoordinateSystem",(function(){Ls.undo(t)})),e("    translateGraph",(function(){!function(t){var e=Number.POSITIVE_INFINITY,n=0,r=Number.POSITIVE_INFINITY,i=0,o=t.graph(),a=o.marginx||0,s=o.marginy||0;function u(t){var o=t.x,a=t.y,s=t.width,u=t.height;e=Math.min(e,o-s/2),n=Math.max(n,o+s/2),r=Math.min(r,a-u/2),i=Math.max(i,a+u/2)}Ua.forEach(t.nodes(),(function(e){u(t.node(e))})),Ua.forEach(t.edges(),(function(e){var n=t.edge(e);Ua.has(n,"x")&&u(n)})),e-=a,r-=s,Ua.forEach(t.nodes(),(function(n){var i=t.node(n);i.x-=e,i.y-=r})),Ua.forEach(t.edges(),(function(n){var i=t.edge(n);Ua.forEach(i.points,(function(t){t.x-=e,t.y-=r})),Ua.has(i,"x")&&(i.x-=e),Ua.has(i,"y")&&(i.y-=r)})),o.width=n-e+a,o.height=i-r+s}(t)})),e("    assignNodeIntersects",(function(){!function(t){Ua.forEach(t.edges(),(function(e){var n,r,i=t.edge(e),o=t.node(e.v),a=t.node(e.w);i.points?(n=i.points[0],r=i.points[i.points.length-1]):(i.points=[],n=a,r=o),i.points.unshift(du.intersectRect(o,n)),i.points.push(du.intersectRect(a,r))}))}(t)})),e("    reversePoints",(function(){!function(t){Ua.forEach(t.edges(),(function(e){var n=t.edge(e);n.reversed&&n.points.reverse()}))}(t)})),e("    acyclic.undo",(function(){$a.undo(t)}))}(e,n)})),n("  updateInputGraph",(function(){!function(t,e){Ua.forEach(t.nodes(),(function(n){var r=t.node(n),i=e.node(n);r&&(r.x=i.x,r.y=i.y,e.children(n).length&&(r.width=i.width,r.height=i.height))})),Ua.forEach(t.edges(),(function(n){var r=t.edge(n),i=e.edge(n);r.points=i.points,Ua.has(i,"x")&&(r.x=i.x,r.y=i.y)})),t.graph().width=e.graph().width,t.graph().height=e.graph().height}(t,e)}))}))};var gu=["nodesep","edgesep","ranksep","marginx","marginy"],Eu={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},mu=["acyclicer","ranker","rankdir","align"],yu=["width","height"],_u={width:0,height:0},Nu=["minlen","weight","width","height","labeloffset"],Tu={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},wu=["labelpos"];function bu(t,e){return Ua.mapValues(Ua.pick(t,e),Number)}function Au(t){var e={};return Ua.forEach(t,(function(t,n){e[n.toLowerCase()]=t})),e}var Ru=Mo.Graph;var Ou={graphlib:Mo,layout:vu,debug:{debugOrdering:function(t){var e=qa.buildLayerMatrix(t),n=new Ru({compound:!0,multigraph:!0}).setGraph({});return Ua.forEach(t.nodes(),(function(e){n.setNode(e,{label:e}),n.setParent(e,"layer"+t.node(e).rank)})),Ua.forEach(t.edges(),(function(t){n.setEdge(t.v,t.w,{},t.name)})),Ua.forEach(e,(function(t,e){var r="layer"+e;n.setNode(r,{rank:"same"}),Ua.reduce(t,(function(t,e){return n.setEdge(t,e,{style:"invis"}),e}))})),n}},util:{time:qa.time,notime:qa.notime},version:"0.8.5"};function Su(t,e,n){return n<1?t+(e-t)*n:e}function Iu(t,e=null){const n=document.createElementNS("http://www.w3.org/2000/svg",t);return e&&n.setAttribute("class",e),n}function Cu(t){const e=[];return t.forEach((t=>{e.push([t.x,t.y])})),e}function Lu(t,e){const n=Iu("rect");return n.setAttribute("rx",0),n.setAttribute("ry",0),n.setAttribute("x",-t/2),n.setAttribute("y",-e/2),n.setAttribute("width",t),n.setAttribute("height",e),n}function Mu(t,e,n){t.element.setAttribute("transform",`translate(${e},${n})`),t.position={x:e,y:n}}class xu{constructor(t){let e="cluster--package";"HTTP-cluster"===t.id?e="cluster--http":"SQL-cluster"===t.id&&(e="cluster--database");const n=t.children>1?"cluster--bordered":"";this.element=Iu("g",`node ${t.class} ${e} ${n}`),this.element.dataset.id=t.id,Mu(this,t.x,t.y),this.element.appendChild(Lu(t.width,t.height))}move(t,e){if(this.animationOptions&&this.animationOptions.enable){const n=this.position.x,r=this.position.y,i=+new Date,{duration:o}=this.animationOptions,a=()=>{const s=(+new Date-i)/o;Mu(this,Su(n,t,s),Su(r,e,s)),s<1?window.requestAnimationFrame(a):Mu(this,t,e)};a()}else Mu(this,t,e)}resize(t,e){const n=this.element.querySelector("rect");n.setAttribute("x",-t/2),n.setAttribute("y",-e/2),n.setAttribute("width",t),n.setAttribute("height",e)}remove(){const{element:t}=this;t.parentNode.removeChild(t)}}class ku{constructor(t,e=!1){this.element=Iu("g","label"),e&&this.element.setAttribute("opacity",0);const n=Iu("text"),r=Iu("tspan");r.setAttribute("space","preserve"),r.setAttribute("dy","1em"),r.setAttribute("x","1"),r.textContent=t,n.appendChild(r),this.element.appendChild(n)}getBBox(){return this.element.getBBox()}}function Pu(t,e,n){t.element.setAttribute("transform",`translate(${e},${n})`),t.position={x:e,y:n}}class Du{constructor(t,e={}){let n;switch(this.element=Iu("g",`node ${t.class}`),this.element.dataset.id=t.id,this.element.setAttribute("opacity",0),Pu(this,t.x,t.y),this.animationOptions=e,t.shape){case"http":n=function(t,e){const n=Iu("polygon"),r=t,i=e,o=[{x:-2*i/6,y:0},{x:r-i/6,y:0},{x:r+2*i/6,y:-i},{x:i/6,y:-i}];return n.setAttribute("points",o.map((function(t){return`${t.x},${t.y}`})).join()),n.setAttribute("transform",`translate(${.5*-r}, ${.5*i})`),n}(t.width,t.height);break;case"database":n=function(t,e){const n=Iu("path"),r=t/2,i=r/(2.5+t/50),o=`M 0,${i} a ${r},${i} 0,0,0 ${t} 0 a ${r},${i} 0,0,0 ${-t} 0 l 0,${e} a ${r},${i} 0,0,0 ${t} 0 l 0, ${-e}`;return n.setAttribute("d",o),n.setAttribute("transform",`translate(${-t/2}, ${-(e/2+i)})`),n}(t.width,t.height);break;default:n=Lu(t.width,t.height)}this.element.appendChild(n);const r=new ku(t.label);r.element.setAttribute("transform",`translate(-${t.labelWidth/2},-${t.labelHeight/2})`),this.element.appendChild(r.element)}show(){if(this.animationOptions&&this.animationOptions.enable){const t=+new Date,{duration:e}=this.animationOptions,n=()=>{const r=(+new Date-t)/e;this.element.setAttribute("opacity",r),r<1?window.requestAnimationFrame(n):this.element.setAttribute("opacity",1)};n()}else this.element.setAttribute("opacity",1)}move(t,e){if(this.animationOptions&&this.animationOptions.enable){const n=this.position.x,r=this.position.y,i=+new Date,{duration:o}=this.animationOptions,a=()=>{const s=(+new Date-i)/o;Pu(this,Su(n,t,s),Su(r,e,s)),s<1?window.requestAnimationFrame(a):Pu(this,t,e)};a()}else Pu(this,t,e)}remove(){const{element:t}=this;t.parentNode.removeChild(t)}}const Uu=r.default.line().curve(r.default.curveBasis);class ju{constructor(t){this.element=Iu("path"),this.element.setAttribute("d",Uu(t))}setPoints(t){this.element.setAttribute("d",Uu(t))}}function Gu(t,e){t.points=e,t.path.setPoints(e)}class Bu{constructor(t,e={}){this.animationOptions=e,this.points=Cu(t),this.element=Iu("g","edgePath"),this.element.setAttribute("opacity",0),this.path=new ju(this.points);const n=Iu("defs"),r=function(){const t=Iu("marker");t.setAttribute("viewBox","0 0 10 10"),t.setAttribute("refX","10"),t.setAttribute("refY","5"),t.setAttribute("markerUnits","strokeWidth"),t.setAttribute("markerWidth","4"),t.setAttribute("markerHeight","4"),t.setAttribute("orient","auto");const e=Iu("path");return e.setAttribute("d","M 0 0 L 10 5 L 0 10 z"),t.appendChild(e),t}(),i=`arrowhead${Math.random().toString(16).slice(2,10)}`;r.setAttribute("id",i),this.path.element.setAttribute("marker-end",`url(#${i})`),n.appendChild(r),this.element.appendChild(this.path.element),this.element.appendChild(n)}show(){if(this.animationOptions&&this.animationOptions.enable){const t=+new Date,{duration:e}=this.animationOptions,n=()=>{const r=(+new Date-t)/e;this.element.setAttribute("opacity",r),r<1?window.requestAnimationFrame(n):this.element.setAttribute("opacity",1)};n()}else this.element.setAttribute("opacity",1)}move(t){if(this.animationOptions&&this.animationOptions.enable){const e=Array.from(this.points),n=Cu(t);!function(t,e){if(t.length===e.length)return;const n=t.length<e.length?t:e;for(let r=0,i=(e===n?t:e).length-n.length;r<i;r++)n.splice(0,0,n[0])}(e,n);const r=+new Date,{duration:i}=this.animationOptions,o=()=>{const t=(+new Date-r)/i,a=[];e.forEach(((e,r)=>{a.push([Su(e[0],n[r][0],t),Su(e[1],n[r][1],t)])})),Gu(this,a),t<1?window.requestAnimationFrame(o):Gu(this,n)};o()}else Gu(this,t)}remove(){const{element:t}=this;t.parentNode.removeChild(t)}}const Fu={animation:{enable:!0,duration:300}};class Hu{constructor(t,e={}){this.element=t,this.options=f(Fu,e),this.outputGroup=Iu("g","output"),this.edgesGroup=Iu("g","edgePaths"),this.clustersGroup=Iu("g","clusters"),this.nodesGroup=Iu("g","nodes"),this.outputGroup.appendChild(this.clustersGroup),this.outputGroup.appendChild(this.edgesGroup),this.outputGroup.appendChild(this.nodesGroup),this.element.innerHTML="",this.element.appendChild(this.outputGroup),this.graph=new Ou.graphlib.Graph({compound:!0}).setGraph({rankdir:"LR"}).setDefaultEdgeLabel((function(){return{}}))}setNode(t,e=null){const n=function(t){const e={...t};return e.label=e.label||e.id,e.class=e.class||e.type,"HTTP"===e.id?(e.label="HTTP server requests",e.shape="http",e.class="http"):"SQL"===e.id&&(e.label="Database",e.shape="database",e.class="database"),"cluster"===e.type&&(e.label=""),e}(t),r=Iu("g","node"),i=new ku(n.label,!0);r.appendChild(i.element),this.nodesGroup.appendChild(r);const o=i.getBBox();this.nodesGroup.removeChild(r),n.labelWidth=o.width,n.labelHeight=o.height,n.width=o.width+30,n.height=o.height+20;const a=this.graph.node(e);a&&"HTTP-cluster"===a.id&&(n.class="http"),this.graph.setNode(n.id,n),e&&this.graph.setParent(n.id,e)}removeNode(t){const e=this.graph.nodeEdges(t),n=this.graph.node(t);e&&e.forEach((({v:t,w:e})=>{const n=this.graph.edge(t,e);n.group&&n.group.remove(),this.graph.removeEdge(t,e)})),n.group.remove(),this.graph.removeNode(t)}setEdge(t,e){t!==e&&(this.graph.node(t)||this.setNode({id:t,type:"class"}),this.graph.node(e)||this.setNode({id:e,type:"class"}),this.graph.setEdge(t,e))}render(){Ou.layout(this.graph),this.graph.nodes().forEach((t=>{const e=this.graph.node(t);if(e.group)return e.group.move(e.x,e.y),void("cluster"===e.type&&e.group.resize(e.width,e.height));if("cluster"===e.type){const t=new xu(e);e.group=t,this.clustersGroup.appendChild(t.element)}else{const t=new Du(e,this.options.animation);e.group=t,e.element=t.element,this.nodesGroup.appendChild(t.element),t.show()}})),this.graph.edges().forEach((({v:t,w:e})=>{const n=this.graph.edge(t,e);if(n.group)n.group.move(n.points);else{const r=new Bu(n.points,this.options.animation);r.element.dataset.from=t,r.element.dataset.to=e,n.group=r,n.element=r.element,this.edgesGroup.appendChild(r.element),r.show()}})),this.element.setAttribute("width",this.graph.graph().width),this.element.setAttribute("height",this.graph.graph().height)}clearHighlights(){this.outputGroup.querySelectorAll(".highlight,.highlight--inbound").forEach((t=>{t.classList.remove("highlight"),t.classList.remove("highlight--inbound")}))}highlightNode(t){const e=this.graph.node(t);return!(!e||e.element.classList.contains("dim"))&&(e.element.classList.add("highlight"),this.graph.nodeEdges(t).forEach((e=>{const n=this.graph.edge(e).element;if(n.classList.add("highlight"),t===e.w&&n.classList.add("highlight--inbound"),!n.classList.contains("dim")){const t=n.parentNode;t.removeChild(n),t.appendChild(n)}})),!0)}clearFocus(){this.outputGroup.querySelectorAll(".dim").forEach((t=>{t.classList.remove("dim")}))}focus(t){const[e,n]=function(t,e){const n=new Set,r=new Set,i=[e];for(;i.length>0;){const e=i.pop();n.has(e)||(t.inEdges(e).forEach((t=>{r.add(t),i.push(t.v)})),n.add(e))}for(i.push(e),n.delete(e);i.length>0;){const e=i.pop();n.has(e)||(t.outEdges(e).forEach((t=>{r.add(t),i.push(t.w)})),n.add(e))}return[n,r]}(this.graph,t);this.graph.nodes().forEach((t=>{if(e.has(t))return;const n=this.graph.node(t);"cluster"!==n.type&&n.element.classList.add("dim")})),this.graph.edges().forEach((t=>{if(n.has(t))return;const e=this.graph.edge(t).element;e.classList.add("dim");const r=e.parentNode;r.removeChild(e),r.insertAdjacentElement("afterbegin",e)}))}expand(t){this.graph.edges().forEach((({v:e,w:n})=>{if(e===t||n===t){const t=this.graph.edge(e,n);t.group&&(t.group.remove(),this.graph.removeEdge(e,n))}})),this.removeNode(t),this.render()}collapse(t){this.render()}scrollToNodes(t,e){const n={top:[],left:[],right:[],bottom:[],x:[],y:[]};e.forEach((t=>{const e=this.graph.node(t);if(!e)return;const r=e.element.getBoundingClientRect();n.top.push(r.top),n.left.push(r.left),n.right.push(r.right),n.bottom.push(r.bottom),n.x.push(e.x-r.width/2),n.y.push(e.y-r.height/2)})),n.top=Math.min(...n.top),n.left=Math.min(...n.left),n.right=Math.max(...n.right),n.bottom=Math.max(...n.bottom),n.offsetTop=Math.min(...n.y),n.offsetLeft=Math.min(...n.x),n.width=n.right-n.left,n.height=n.bottom-n.top;const r=t.getBoundingClientRect();if(p.contains(r,n))return!1;const i=r.width/n.width,o=r.height/n.height;return{scale:i>1&&o>1?1:Math.min(i,o)-.01,x:n.width/2+n.offsetLeft,y:n.height/2+n.offsetTop}}makeRoot(t){const e=new Set,n=new Set,r=[t];for(;r.length>0;){const t=r.pop();e.has(t)||(this.graph.outEdges(t).forEach((t=>{n.add(t),r.push(t.w)})),e.add(t))}this.graph.nodes().forEach((t=>{e.has(t)||this.removeNode(t)})),this.render()}}function Vu(t,e){const n=new Set(e.package_classes[t.id]).size;n&&n>1&&(t.label=`${t.id} (${n})`)}function Wu(t,e,n,r){n&&n.forEach((n=>{if(t.node(n))return void r(n);const i=e.class_package[n];t.node(i)&&r(i)}))}const zu={contextMenu:t=>[e=>e.text("Set as root").selector(".nodes .node").transform((t=>t.dataset.id)).on("execute",(e=>t.makeRoot(e))),e=>e.text("Expand").selector("g.node").transform((t=>t.dataset.id)).condition((e=>t.hasPackage(e))).on("execute",(e=>t.expand(e))),e=>e.text("Collapse").selector("g.node").transform((t=>t.dataset.id)).condition((e=>!t.hasPackage(e))).on("execute",(e=>t.collapse(e))),e=>e.text("View source").selector("g.node.class").transform((e=>t.sourceLocation(e.dataset.id))).on("execute",(t=>window.open(t))),e=>e.text("Reset view").on("execute",(()=>{t.render(t.initialModel)}))]};class Yu extends C.EventSource{constructor(t,n={}){super();const r=f(zu,n);this.container=new H(t,r),this.container.containerController.setContextMenu(this),this.targetCount=1,this.element=e.select(this.container).append("svg").attr("class","appmap__component-diagram"),this.on("postrender",(()=>{this.container.containerController.fitViewport(this.container)})),this.container.containerController.element.addEventListener("click",(t=>{t.target.classList.contains("dropdown-item")||this.clearHighlights(),this.container.containerController.contextMenu&&this.container.containerController.contextMenu.close()})),this.container.containerController.element.addEventListener("move",(()=>{this.container.containerController.contextMenu&&this.container.containerController.contextMenu.close()})),this.container.containerController.element.addEventListener("dblclick",(()=>{this.clearFocus()}))}render(t){if(!t||"object"!=typeof t)return;this.initialModel||(this.initialModel={...t}),this.currentDiagramModel=T(t),this.graph=new Hu(this.element.node(),{animation:{duration:600}});const{nodes:n,edges:r}=function(t,e=1){if(!t||!t.package_calls||0===t.package_calls.length)return{};const{class_calls:n,class_callers:r,class_package:i,packages:o,package_calls:a,package_classes:s}=t,u={...a},c=t=>{let e=0;const n=s[t].length;return e+=Math.abs(1-n),e},l=[...o].sort(((t,e)=>c(e)-c(t)));for(;new Set(Object.entries(u).flat(2)).size<e&&0!==l.length;){const t=l.pop(),e=s[t];delete u[t],Object.values(u).forEach((e=>e.delete(t))),e.forEach((e=>{(r[e]||[]).forEach((n=>{const r=u[n]?n:i[n];r!==t&&(u[r]||(u[r]=new Set),u[r].add(e))}))})),e.forEach((e=>{(n[e]||[]).forEach((n=>{const r=i[n],o=u[r]?r:n;o!==t&&(u[e]||(u[e]=new Set),u[e].add(o))}))}))}const h=Object.entries(u).map((([t,e])=>[t,[...e]])).map((([t,e])=>e.map((e=>[t,e])))).flat().filter((([t,e])=>t!==e)),f=Object.values(h.flat(2).reduce(((e,n)=>(e[n]={id:n,type:o.has(n)?"package":"class"},Vu(e[n],t),e)),{}));return{edges:h,nodes:f}}(this.currentDiagramModel,this.targetCount);n.forEach((t=>{this.graph.setNode(t)})),r.forEach((([t,e])=>this.graph.setEdge(t,e))),this.graph.render(),function(t){const n=t.element.node();n.addEventListener("click",(e=>{const r=b(e.target,n,"g.nodes g.node");r&&(e.stopPropagation(),t.highlight(r.dataset.id))})),n.addEventListener("dblclick",(e=>{const r=b(e.target,n,"g.nodes g.node");r&&(e.stopPropagation(),t.focus(r.dataset.id))})),n.addEventListener("click",(r=>{const i=b(r.target,n,".edgePath > path");i&&(r.stopPropagation(),t.clearHighlights(!0),i.parentNode.classList.add("highlight"),e.select(n).selectAll(".edgePath.highlight").raise(),t.emit("edge",[i.parentNode.dataset.from,i.parentNode.dataset.to]))}))}(this),Object.entries(this.currentDiagramModel.package_classes).forEach((([t,e])=>{1===new Set(e).size&&this.expand(t,!1)})),this.emit("postrender")}clearHighlights(t=!1){this.graph.clearHighlights(),t||this.emit("highlight",null)}highlight(t){this.clearHighlights(!0);let e=[];Array.isArray(t)?e=t:"string"==typeof t&&(e=[t]);let n=!1;return e.forEach((t=>{this.graph.highlightNode(t)&&(n=!0)})),n?(this.scrollTo(t),this.emit("highlight",e)):this.emit("highlight",null),n}clearFocus(){this.graph.clearFocus(),this.emit("focus",null)}focus(t){this.graph.clearFocus(),this.graph.focus(t),this.scrollTo(t),this.emit("focus",t)}scrollTo(t){let e=[];Array.isArray(t)?e=t:"string"==typeof t&&(e=[t]);const{containerController:n}=this.container,r=this.graph.scrollToNodes(n.element,e);r&&(n.scaleTo(r.scale),setTimeout((()=>{n.translateTo(r.x,r.y)}),200),this.emit("scrollTo",e))}expand(t,e=!0){const n=Array.from(new Set(this.currentDiagramModel.package_classes[t]));if(0===n.length||n[0]===t)return;const r=`${t}-cluster`,i={id:r,type:"cluster",children:n.length};this.graph.setNode(i),n.forEach((t=>{this.graph.setNode({id:t,type:"class"},r);const e=this.currentDiagramModel;Wu(this.graph.graph,e,e.class_calls[t],(e=>{t!==e&&this.graph.setEdge(t,e)})),Wu(this.graph.graph,e,e.class_callers[t],(e=>{t!==e&&this.graph.setEdge(e,t)}))})),this.graph.expand(t,r),e&&this.scrollTo(n),this.emit("expand",t)}collapse(t,e=!0){const n=this.currentDiagramModel.class_package[t];if(!n)return;const r=this.currentDiagramModel.package_classes[n];if(!r)return;this.graph.removeNode(`${n}-cluster`);const i={id:n,type:"package"};Vu(i,this.currentDiagramModel),this.graph.setNode(i),r.forEach((t=>{this.graph.removeNode(t);const e=this.currentDiagramModel;Wu(this.graph.graph,e,e.class_calls[t],(t=>{t!==n&&this.graph.setEdge(n,t)})),Wu(this.graph.graph,e,e.class_callers[t],(t=>{t!==n&&this.graph.setEdge(t,n)}))})),this.graph.collapse(n),e&&this.scrollTo(n),this.emit("collapse",n)}makeRoot(t){this.graph.makeRoot(t),this.scrollTo(t)}sourceLocation(t){const e=this.currentDiagramModel.class_locations[t];if(!e)return null;const{url:n,commit:r}=this.currentDiagramModel.source_control;return function(t,e,n="master",r=null){if(!t||!e)return;const i={url:t,path:e,lineNumber:r,commit:n},o=Object.values(N);for(let t=0;t<o.length;++t){const e=o[t](i);if(e)return e}}(n,e,r)}hasPackage(t){return this.currentDiagramModel.packages.has(t)}}var $u=function(t,e,n){var r=-1,i=t.length;e<0&&(e=-e>i?0:i+e),(n=n>i?i:n)<0&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var o=Array(i);++r<i;)o[r]=t[r+e];return o};var Xu=function(t,e,n){var r=t.length;return n=void 0===n?r:n,!e&&n>=r?t:$u(t,e,n)};var qu=function(t,e){for(var n=t.length;n--&&Wi(e,t[n],0)>-1;);return n};var Ku=function(t){return t.split("")},Qu="[\\ud800-\\udfff]",Zu="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Ju="\\ud83c[\\udffb-\\udfff]",tc="[^\\ud800-\\udfff]",ec="(?:\\ud83c[\\udde6-\\uddff]){2}",nc="[\\ud800-\\udbff][\\udc00-\\udfff]",rc="(?:"+Zu+"|"+Ju+")"+"?",ic="[\\ufe0e\\ufe0f]?",oc=ic+rc+("(?:\\u200d(?:"+[tc,ec,nc].join("|")+")"+ic+rc+")*"),ac="(?:"+[tc+Zu+"?",Zu,ec,nc,Qu].join("|")+")",sc=RegExp(Ju+"(?="+Ju+")|"+ac+oc,"g");var uc=function(t){return t.match(sc)||[]};var cc=function(t){return vi(t)?uc(t):Ku(t)},lc=/\s+$/;var hc=function(t,e,n){if((t=Fr(t))&&(n||void 0===e))return t.replace(lc,"");if(!t||!(e=Br(e)))return t;var r=cc(t),i=qu(r,cc(e))+1;return Xu(r,0,i).join("")},fc=O((function(t,e){e.__esModule=!0,e.default={WHITESPACE:"whitespace",WORD:"word",STRING:"string",RESERVED:"reserved",RESERVED_TOPLEVEL:"reserved-toplevel",RESERVED_NEWLINE:"reserved-newline",OPERATOR:"operator",OPEN_PAREN:"open-paren",CLOSE_PAREN:"close-paren",LINE_COMMENT:"line-comment",BLOCK_COMMENT:"block-comment",NUMBER:"number",PLACEHOLDER:"placeholder"},t.exports=e.default})),dc=Math.floor;var pc=function(t,e){var n="";if(!t||e<1||e>9007199254740991)return n;do{e%2&&(n+=t),(e=dc(e/2))&&(t+=t)}while(e);return n};var vc=function(t,e,n){return e=(n?ko(t,e,n):void 0===e)?1:$o(e),pc(Fr(t),e)},gc=O((function(t,e){e.__esModule=!0;var n=i(vc),r=i(Zo);function i(t){return t&&t.__esModule?t:{default:t}}var o="top-level",a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.indent=e||"  ",this.indentTypes=[]}return t.prototype.getIndent=function(){return(0,n.default)(this.indent,this.indentTypes.length)},t.prototype.increaseToplevel=function(){this.indentTypes.push(o)},t.prototype.increaseBlockLevel=function(){this.indentTypes.push("block-level")},t.prototype.decreaseTopLevel=function(){(0,r.default)(this.indentTypes)===o&&this.indentTypes.pop()},t.prototype.decreaseBlockLevel=function(){for(;this.indentTypes.length>0;){if(this.indentTypes.pop()!==o)break}},t}();e.default=a,t.exports=e.default})),Ec=O((function(t,e){e.__esModule=!0;var n,r=(n=fc)&&n.__esModule?n:{default:n};var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.level=0}return t.prototype.beginIfPossible=function(t,e){0===this.level&&this.isInlineBlock(t,e)?this.level=1:this.level>0?this.level++:this.level=0},t.prototype.end=function(){this.level--},t.prototype.isActive=function(){return this.level>0},t.prototype.isInlineBlock=function(t,e){for(var n=0,i=0,o=e;o<t.length;o++){var a=t[o];if((n+=a.value.length)>50)return!1;if(a.type===r.default.OPEN_PAREN)i++;else if(a.type===r.default.CLOSE_PAREN&&0===--i)return!0;if(this.isForbiddenToken(a))return!1}return!1},t.prototype.isForbiddenToken=function(t){var e=t.type,n=t.value;return e===r.default.RESERVED_TOPLEVEL||e===r.default.RESERVED_NEWLINE||e===r.default.COMMENT||e===r.default.BLOCK_COMMENT||";"===n},t}();e.default=i,t.exports=e.default})),mc=O((function(t,e){e.__esModule=!0;var n=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.params=e,this.index=0}return t.prototype.get=function(t){var e=t.key,n=t.value;return this.params?e?this.params[e]:this.params[this.index++]:n},t}();e.default=n,t.exports=e.default})),yc=O((function(t,e){e.__esModule=!0;var n=s(hc),r=s(fc),i=s(gc),o=s(Ec),a=s(mc);function s(t){return t&&t.__esModule?t:{default:t}}var u=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cfg=e||{},this.indentation=new i.default(this.cfg.indent),this.inlineBlock=new o.default,this.params=new a.default(this.cfg.params),this.tokenizer=n,this.previousReservedWord={},this.tokens=[],this.index=0}return t.prototype.format=function(t){return this.tokens=this.tokenizer.tokenize(t),this.getFormattedQueryFromTokens().trim()},t.prototype.getFormattedQueryFromTokens=function(){var t=this,e="";return this.tokens.forEach((function(n,i){t.index=i,n.type===r.default.WHITESPACE||(n.type===r.default.LINE_COMMENT?e=t.formatLineComment(n,e):n.type===r.default.BLOCK_COMMENT?e=t.formatBlockComment(n,e):n.type===r.default.RESERVED_TOPLEVEL?(e=t.formatToplevelReservedWord(n,e),t.previousReservedWord=n):n.type===r.default.RESERVED_NEWLINE?(e=t.formatNewlineReservedWord(n,e),t.previousReservedWord=n):n.type===r.default.RESERVED?(e=t.formatWithSpaces(n,e),t.previousReservedWord=n):e=n.type===r.default.OPEN_PAREN?t.formatOpeningParentheses(n,e):n.type===r.default.CLOSE_PAREN?t.formatClosingParentheses(n,e):n.type===r.default.PLACEHOLDER?t.formatPlaceholder(n,e):","===n.value?t.formatComma(n,e):":"===n.value?t.formatWithSpaceAfter(n,e):"."===n.value?t.formatWithoutSpaces(n,e):";"===n.value?t.formatQuerySeparator(n,e):t.formatWithSpaces(n,e))})),e},t.prototype.formatLineComment=function(t,e){return this.addNewline(e+t.value)},t.prototype.formatBlockComment=function(t,e){return this.addNewline(this.addNewline(e)+this.indentComment(t.value))},t.prototype.indentComment=function(t){return t.replace(/\n/g,"\n"+this.indentation.getIndent())},t.prototype.formatToplevelReservedWord=function(t,e){return this.indentation.decreaseTopLevel(),e=this.addNewline(e),this.indentation.increaseToplevel(),e+=this.equalizeWhitespace(t.value),this.addNewline(e)},t.prototype.formatNewlineReservedWord=function(t,e){return this.addNewline(e)+this.equalizeWhitespace(t.value)+" "},t.prototype.equalizeWhitespace=function(t){return t.replace(/\s+/g," ")},t.prototype.formatOpeningParentheses=function(t,e){return[r.default.WHITESPACE,r.default.OPEN_PAREN,r.default.LINE_COMMENT].includes(this.previousToken().type)||(e=(0,n.default)(e)),e+=t.value,this.inlineBlock.beginIfPossible(this.tokens,this.index),this.inlineBlock.isActive()||(this.indentation.increaseBlockLevel(),e=this.addNewline(e)),e},t.prototype.formatClosingParentheses=function(t,e){return this.inlineBlock.isActive()?(this.inlineBlock.end(),this.formatWithSpaceAfter(t,e)):(this.indentation.decreaseBlockLevel(),this.formatWithSpaces(t,this.addNewline(e)))},t.prototype.formatPlaceholder=function(t,e){return e+this.params.get(t)+" "},t.prototype.formatComma=function(t,e){return e=this.trimTrailingWhitespace(e)+t.value+" ",this.inlineBlock.isActive()||/^LIMIT$/i.test(this.previousReservedWord.value)?e:this.addNewline(e)},t.prototype.formatWithSpaceAfter=function(t,e){return this.trimTrailingWhitespace(e)+t.value+" "},t.prototype.formatWithoutSpaces=function(t,e){return this.trimTrailingWhitespace(e)+t.value},t.prototype.formatWithSpaces=function(t,e){return e+t.value+" "},t.prototype.formatQuerySeparator=function(t,e){return this.trimTrailingWhitespace(e)+t.value+"\n"},t.prototype.addNewline=function(t){return(0,n.default)(t)+"\n"+this.indentation.getIndent()},t.prototype.trimTrailingWhitespace=function(t){return this.previousNonWhitespaceToken().type===r.default.LINE_COMMENT?(0,n.default)(t)+"\n":(0,n.default)(t)},t.prototype.previousNonWhitespaceToken=function(){for(var t=1;this.previousToken(t).type===r.default.WHITESPACE;)t++;return this.previousToken(t)},t.prototype.previousToken=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.tokens[this.index-t]||{}},t}();e.default=u,t.exports=e.default})),_c=/[\\^$.*+?()[\]{}|]/g,Nc=RegExp(_c.source);var Tc=function(t){return(t=Fr(t))&&Nc.test(t)?t.replace(_c,"\\$&"):t},wc=O((function(t,e){e.__esModule=!0;var n=o(oi),r=o(Tc),i=o(fc);function o(t){return t&&t.__esModule?t:{default:t}}var a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.WHITESPACE_REGEX=/^(\s+)/,this.NUMBER_REGEX=/^((-\s*)?[0-9]+(\.[0-9]+)?|0x[0-9a-fA-F]+|0b[01]+)\b/,this.OPERATOR_REGEX=/^(!=|<>|==|<=|>=|!<|!>|\|\||::|->>|->|~~\*|~~|!~~\*|!~~|~\*|!~\*|!~|.)/,this.BLOCK_COMMENT_REGEX=/^(\/\*[^]*?(?:\*\/|$))/,this.LINE_COMMENT_REGEX=this.createLineCommentRegex(e.lineCommentTypes),this.RESERVED_TOPLEVEL_REGEX=this.createReservedWordRegex(e.reservedToplevelWords),this.RESERVED_NEWLINE_REGEX=this.createReservedWordRegex(e.reservedNewlineWords),this.RESERVED_PLAIN_REGEX=this.createReservedWordRegex(e.reservedWords),this.WORD_REGEX=this.createWordRegex(e.specialWordChars),this.STRING_REGEX=this.createStringRegex(e.stringTypes),this.OPEN_PAREN_REGEX=this.createParenRegex(e.openParens),this.CLOSE_PAREN_REGEX=this.createParenRegex(e.closeParens),this.INDEXED_PLACEHOLDER_REGEX=this.createPlaceholderRegex(e.indexedPlaceholderTypes,"[0-9]*"),this.IDENT_NAMED_PLACEHOLDER_REGEX=this.createPlaceholderRegex(e.namedPlaceholderTypes,"[a-zA-Z0-9._$]+"),this.STRING_NAMED_PLACEHOLDER_REGEX=this.createPlaceholderRegex(e.namedPlaceholderTypes,this.createStringPattern(e.stringTypes))}return t.prototype.createLineCommentRegex=function(t){return new RegExp("^((?:"+t.map((function(t){return(0,r.default)(t)})).join("|")+").*?(?:\n|$))")},t.prototype.createReservedWordRegex=function(t){var e=t.join("|").replace(/ /g,"\\s+");return new RegExp("^("+e+")\\b","i")},t.prototype.createWordRegex=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return new RegExp("^([\\w"+t.join("")+"]+)")},t.prototype.createStringRegex=function(t){return new RegExp("^("+this.createStringPattern(t)+")")},t.prototype.createStringPattern=function(t){var e={"``":"((`[^`]*($|`))+)","[]":"((\\[[^\\]]*($|\\]))(\\][^\\]]*($|\\]))*)",'""':'(("[^"\\\\]*(?:\\\\.[^"\\\\]*)*("|$))+)',"''":"(('[^'\\\\]*(?:\\\\.[^'\\\\]*)*('|$))+)","N''":"((N'[^N'\\\\]*(?:\\\\.[^N'\\\\]*)*('|$))+)"};return t.map((function(t){return e[t]})).join("|")},t.prototype.createParenRegex=function(t){var e=this;return new RegExp("^("+t.map((function(t){return e.escapeParen(t)})).join("|")+")","i")},t.prototype.escapeParen=function(t){return 1===t.length?(0,r.default)(t):"\\b"+t+"\\b"},t.prototype.createPlaceholderRegex=function(t,e){if((0,n.default)(t))return!1;var i=t.map(r.default).join("|");return new RegExp("^((?:"+i+")(?:"+e+"))")},t.prototype.tokenize=function(t){for(var e=[],n=void 0;t.length;)n=this.getNextToken(t,n),t=t.substring(n.value.length),e.push(n);return e},t.prototype.getNextToken=function(t,e){return this.getWhitespaceToken(t)||this.getCommentToken(t)||this.getStringToken(t)||this.getOpenParenToken(t)||this.getCloseParenToken(t)||this.getPlaceholderToken(t)||this.getNumberToken(t)||this.getReservedWordToken(t,e)||this.getWordToken(t)||this.getOperatorToken(t)},t.prototype.getWhitespaceToken=function(t){return this.getTokenOnFirstMatch({input:t,type:i.default.WHITESPACE,regex:this.WHITESPACE_REGEX})},t.prototype.getCommentToken=function(t){return this.getLineCommentToken(t)||this.getBlockCommentToken(t)},t.prototype.getLineCommentToken=function(t){return this.getTokenOnFirstMatch({input:t,type:i.default.LINE_COMMENT,regex:this.LINE_COMMENT_REGEX})},t.prototype.getBlockCommentToken=function(t){return this.getTokenOnFirstMatch({input:t,type:i.default.BLOCK_COMMENT,regex:this.BLOCK_COMMENT_REGEX})},t.prototype.getStringToken=function(t){return this.getTokenOnFirstMatch({input:t,type:i.default.STRING,regex:this.STRING_REGEX})},t.prototype.getOpenParenToken=function(t){return this.getTokenOnFirstMatch({input:t,type:i.default.OPEN_PAREN,regex:this.OPEN_PAREN_REGEX})},t.prototype.getCloseParenToken=function(t){return this.getTokenOnFirstMatch({input:t,type:i.default.CLOSE_PAREN,regex:this.CLOSE_PAREN_REGEX})},t.prototype.getPlaceholderToken=function(t){return this.getIdentNamedPlaceholderToken(t)||this.getStringNamedPlaceholderToken(t)||this.getIndexedPlaceholderToken(t)},t.prototype.getIdentNamedPlaceholderToken=function(t){return this.getPlaceholderTokenWithKey({input:t,regex:this.IDENT_NAMED_PLACEHOLDER_REGEX,parseKey:function(t){return t.slice(1)}})},t.prototype.getStringNamedPlaceholderToken=function(t){var e=this;return this.getPlaceholderTokenWithKey({input:t,regex:this.STRING_NAMED_PLACEHOLDER_REGEX,parseKey:function(t){return e.getEscapedPlaceholderKey({key:t.slice(2,-1),quoteChar:t.slice(-1)})}})},t.prototype.getIndexedPlaceholderToken=function(t){return this.getPlaceholderTokenWithKey({input:t,regex:this.INDEXED_PLACEHOLDER_REGEX,parseKey:function(t){return t.slice(1)}})},t.prototype.getPlaceholderTokenWithKey=function(t){var e=t.input,n=t.regex,r=t.parseKey,o=this.getTokenOnFirstMatch({input:e,regex:n,type:i.default.PLACEHOLDER});return o&&(o.key=r(o.value)),o},t.prototype.getEscapedPlaceholderKey=function(t){var e=t.key,n=t.quoteChar;return e.replace(new RegExp((0,r.default)("\\")+n,"g"),n)},t.prototype.getNumberToken=function(t){return this.getTokenOnFirstMatch({input:t,type:i.default.NUMBER,regex:this.NUMBER_REGEX})},t.prototype.getOperatorToken=function(t){return this.getTokenOnFirstMatch({input:t,type:i.default.OPERATOR,regex:this.OPERATOR_REGEX})},t.prototype.getReservedWordToken=function(t,e){if(!e||!e.value||"."!==e.value)return this.getToplevelReservedToken(t)||this.getNewlineReservedToken(t)||this.getPlainReservedToken(t)},t.prototype.getToplevelReservedToken=function(t){return this.getTokenOnFirstMatch({input:t,type:i.default.RESERVED_TOPLEVEL,regex:this.RESERVED_TOPLEVEL_REGEX})},t.prototype.getNewlineReservedToken=function(t){return this.getTokenOnFirstMatch({input:t,type:i.default.RESERVED_NEWLINE,regex:this.RESERVED_NEWLINE_REGEX})},t.prototype.getPlainReservedToken=function(t){return this.getTokenOnFirstMatch({input:t,type:i.default.RESERVED,regex:this.RESERVED_PLAIN_REGEX})},t.prototype.getWordToken=function(t){return this.getTokenOnFirstMatch({input:t,type:i.default.WORD,regex:this.WORD_REGEX})},t.prototype.getTokenOnFirstMatch=function(t){var e=t.input,n=t.type,r=t.regex,i=e.match(r);if(i)return{type:n,value:i[1]}},t}();e.default=a,t.exports=e.default})),bc=O((function(t,e){e.__esModule=!0;var n=i(yc),r=i(wc);function i(t){return t&&t.__esModule?t:{default:t}}var o=["ABS","ACTIVATE","ALIAS","ALL","ALLOCATE","ALLOW","ALTER","ANY","ARE","ARRAY","AS","ASC","ASENSITIVE","ASSOCIATE","ASUTIME","ASYMMETRIC","AT","ATOMIC","ATTRIBUTES","AUDIT","AUTHORIZATION","AUX","AUXILIARY","AVG","BEFORE","BEGIN","BETWEEN","BIGINT","BINARY","BLOB","BOOLEAN","BOTH","BUFFERPOOL","BY","CACHE","CALL","CALLED","CAPTURE","CARDINALITY","CASCADED","CASE","CAST","CCSID","CEIL","CEILING","CHAR","CHARACTER","CHARACTER_LENGTH","CHAR_LENGTH","CHECK","CLOB","CLONE","CLOSE","CLUSTER","COALESCE","COLLATE","COLLECT","COLLECTION","COLLID","COLUMN","COMMENT","COMMIT","CONCAT","CONDITION","CONNECT","CONNECTION","CONSTRAINT","CONTAINS","CONTINUE","CONVERT","CORR","CORRESPONDING","COUNT","COUNT_BIG","COVAR_POP","COVAR_SAMP","CREATE","CROSS","CUBE","CUME_DIST","CURRENT","CURRENT_DATE","CURRENT_DEFAULT_TRANSFORM_GROUP","CURRENT_LC_CTYPE","CURRENT_PATH","CURRENT_ROLE","CURRENT_SCHEMA","CURRENT_SERVER","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_TIMEZONE","CURRENT_TRANSFORM_GROUP_FOR_TYPE","CURRENT_USER","CURSOR","CYCLE","DATA","DATABASE","DATAPARTITIONNAME","DATAPARTITIONNUM","DATE","DAY","DAYS","DB2GENERAL","DB2GENRL","DB2SQL","DBINFO","DBPARTITIONNAME","DBPARTITIONNUM","DEALLOCATE","DEC","DECIMAL","DECLARE","DEFAULT","DEFAULTS","DEFINITION","DELETE","DENSERANK","DENSE_RANK","DEREF","DESCRIBE","DESCRIPTOR","DETERMINISTIC","DIAGNOSTICS","DISABLE","DISALLOW","DISCONNECT","DISTINCT","DO","DOCUMENT","DOUBLE","DROP","DSSIZE","DYNAMIC","EACH","EDITPROC","ELEMENT","ELSE","ELSEIF","ENABLE","ENCODING","ENCRYPTION","END","END-EXEC","ENDING","ERASE","ESCAPE","EVERY","EXCEPTION","EXCLUDING","EXCLUSIVE","EXEC","EXECUTE","EXISTS","EXIT","EXP","EXPLAIN","EXTENDED","EXTERNAL","EXTRACT","FALSE","FENCED","FETCH","FIELDPROC","FILE","FILTER","FINAL","FIRST","FLOAT","FLOOR","FOR","FOREIGN","FREE","FULL","FUNCTION","FUSION","GENERAL","GENERATED","GET","GLOBAL","GOTO","GRANT","GRAPHIC","GROUP","GROUPING","HANDLER","HASH","HASHED_VALUE","HINT","HOLD","HOUR","HOURS","IDENTITY","IF","IMMEDIATE","IN","INCLUDING","INCLUSIVE","INCREMENT","INDEX","INDICATOR","INDICATORS","INF","INFINITY","INHERIT","INNER","INOUT","INSENSITIVE","INSERT","INT","INTEGER","INTEGRITY","INTERSECTION","INTERVAL","INTO","IS","ISOBID","ISOLATION","ITERATE","JAR","JAVA","KEEP","KEY","LABEL","LANGUAGE","LARGE","LATERAL","LC_CTYPE","LEADING","LEAVE","LEFT","LIKE","LINKTYPE","LN","LOCAL","LOCALDATE","LOCALE","LOCALTIME","LOCALTIMESTAMP","LOCATOR","LOCATORS","LOCK","LOCKMAX","LOCKSIZE","LONG","LOOP","LOWER","MAINTAINED","MATCH","MATERIALIZED","MAX","MAXVALUE","MEMBER","MERGE","METHOD","MICROSECOND","MICROSECONDS","MIN","MINUTE","MINUTES","MINVALUE","MOD","MODE","MODIFIES","MODULE","MONTH","MONTHS","MULTISET","NAN","NATIONAL","NATURAL","NCHAR","NCLOB","NEW","NEW_TABLE","NEXTVAL","NO","NOCACHE","NOCYCLE","NODENAME","NODENUMBER","NOMAXVALUE","NOMINVALUE","NONE","NOORDER","NORMALIZE","NORMALIZED","NOT","NULL","NULLIF","NULLS","NUMERIC","NUMPARTS","OBID","OCTET_LENGTH","OF","OFFSET","OLD","OLD_TABLE","ON","ONLY","OPEN","OPTIMIZATION","OPTIMIZE","OPTION","ORDER","OUT","OUTER","OVER","OVERLAPS","OVERLAY","OVERRIDING","PACKAGE","PADDED","PAGESIZE","PARAMETER","PART","PARTITION","PARTITIONED","PARTITIONING","PARTITIONS","PASSWORD","PATH","PERCENTILE_CONT","PERCENTILE_DISC","PERCENT_RANK","PIECESIZE","PLAN","POSITION","POWER","PRECISION","PREPARE","PREVVAL","PRIMARY","PRIQTY","PRIVILEGES","PROCEDURE","PROGRAM","PSID","PUBLIC","QUERY","QUERYNO","RANGE","RANK","READ","READS","REAL","RECOVERY","RECURSIVE","REF","REFERENCES","REFERENCING","REFRESH","REGR_AVGX","REGR_AVGY","REGR_COUNT","REGR_INTERCEPT","REGR_R2","REGR_SLOPE","REGR_SXX","REGR_SXY","REGR_SYY","RELEASE","RENAME","REPEAT","RESET","RESIGNAL","RESTART","RESTRICT","RESULT","RESULT_SET_LOCATOR","RETURN","RETURNS","REVOKE","RIGHT","ROLE","ROLLBACK","ROLLUP","ROUND_CEILING","ROUND_DOWN","ROUND_FLOOR","ROUND_HALF_DOWN","ROUND_HALF_EVEN","ROUND_HALF_UP","ROUND_UP","ROUTINE","ROW","ROWNUMBER","ROWS","ROWSET","ROW_NUMBER","RRN","RUN","SAVEPOINT","SCHEMA","SCOPE","SCRATCHPAD","SCROLL","SEARCH","SECOND","SECONDS","SECQTY","SECURITY","SENSITIVE","SEQUENCE","SESSION","SESSION_USER","SIGNAL","SIMILAR","SIMPLE","SMALLINT","SNAN","SOME","SOURCE","SPECIFIC","SPECIFICTYPE","SQL","SQLEXCEPTION","SQLID","SQLSTATE","SQLWARNING","SQRT","STACKED","STANDARD","START","STARTING","STATEMENT","STATIC","STATMENT","STAY","STDDEV_POP","STDDEV_SAMP","STOGROUP","STORES","STYLE","SUBMULTISET","SUBSTRING","SUM","SUMMARY","SYMMETRIC","SYNONYM","SYSFUN","SYSIBM","SYSPROC","SYSTEM","SYSTEM_USER","TABLE","TABLESAMPLE","TABLESPACE","THEN","TIME","TIMESTAMP","TIMEZONE_HOUR","TIMEZONE_MINUTE","TO","TRAILING","TRANSACTION","TRANSLATE","TRANSLATION","TREAT","TRIGGER","TRIM","TRUE","TRUNCATE","TYPE","UESCAPE","UNDO","UNIQUE","UNKNOWN","UNNEST","UNTIL","UPPER","USAGE","USER","USING","VALIDPROC","VALUE","VARCHAR","VARIABLE","VARIANT","VARYING","VAR_POP","VAR_SAMP","VCAT","VERSION","VIEW","VOLATILE","VOLUMES","WHEN","WHENEVER","WHILE","WIDTH_BUCKET","WINDOW","WITH","WITHIN","WITHOUT","WLM","WRITE","XMLELEMENT","XMLEXISTS","XMLNAMESPACES","YEAR","YEARS"],a=["ADD","AFTER","ALTER COLUMN","ALTER TABLE","DELETE FROM","EXCEPT","FETCH FIRST","FROM","GROUP BY","GO","HAVING","INSERT INTO","INTERSECT","LIMIT","ORDER BY","SELECT","SET CURRENT SCHEMA","SET SCHEMA","SET","UNION ALL","UPDATE","VALUES","WHERE"],s=["AND","CROSS JOIN","INNER JOIN","JOIN","LEFT JOIN","LEFT OUTER JOIN","OR","OUTER JOIN","RIGHT JOIN","RIGHT OUTER JOIN"],u=void 0,c=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cfg=e}return t.prototype.format=function(t){return u||(u=new r.default({reservedWords:o,reservedToplevelWords:a,reservedNewlineWords:s,stringTypes:['""',"''","``","[]"],openParens:["("],closeParens:[")"],indexedPlaceholderTypes:["?"],namedPlaceholderTypes:[":"],lineCommentTypes:["--"],specialWordChars:["#","@"]})),new n.default(this.cfg,u).format(t)},t}();e.default=c,t.exports=e.default})),Ac=O((function(t,e){e.__esModule=!0;var n=i(yc),r=i(wc);function i(t){return t&&t.__esModule?t:{default:t}}var o=["ALL","ALTER","ANALYZE","AND","ANY","ARRAY","AS","ASC","BEGIN","BETWEEN","BINARY","BOOLEAN","BREAK","BUCKET","BUILD","BY","CALL","CASE","CAST","CLUSTER","COLLATE","COLLECTION","COMMIT","CONNECT","CONTINUE","CORRELATE","COVER","CREATE","DATABASE","DATASET","DATASTORE","DECLARE","DECREMENT","DELETE","DERIVED","DESC","DESCRIBE","DISTINCT","DO","DROP","EACH","ELEMENT","ELSE","END","EVERY","EXCEPT","EXCLUDE","EXECUTE","EXISTS","EXPLAIN","FALSE","FETCH","FIRST","FLATTEN","FOR","FORCE","FROM","FUNCTION","GRANT","GROUP","GSI","HAVING","IF","IGNORE","ILIKE","IN","INCLUDE","INCREMENT","INDEX","INFER","INLINE","INNER","INSERT","INTERSECT","INTO","IS","JOIN","KEY","KEYS","KEYSPACE","KNOWN","LAST","LEFT","LET","LETTING","LIKE","LIMIT","LSM","MAP","MAPPING","MATCHED","MATERIALIZED","MERGE","MINUS","MISSING","NAMESPACE","NEST","NOT","NULL","NUMBER","OBJECT","OFFSET","ON","OPTION","OR","ORDER","OUTER","OVER","PARSE","PARTITION","PASSWORD","PATH","POOL","PREPARE","PRIMARY","PRIVATE","PRIVILEGE","PROCEDURE","PUBLIC","RAW","REALM","REDUCE","RENAME","RETURN","RETURNING","REVOKE","RIGHT","ROLE","ROLLBACK","SATISFIES","SCHEMA","SELECT","SELF","SEMI","SET","SHOW","SOME","START","STATISTICS","STRING","SYSTEM","THEN","TO","TRANSACTION","TRIGGER","TRUE","TRUNCATE","UNDER","UNION","UNIQUE","UNKNOWN","UNNEST","UNSET","UPDATE","UPSERT","USE","USER","USING","VALIDATE","VALUE","VALUED","VALUES","VIA","VIEW","WHEN","WHERE","WHILE","WITH","WITHIN","WORK","XOR"],a=["DELETE FROM","EXCEPT ALL","EXCEPT","EXPLAIN DELETE FROM","EXPLAIN UPDATE","EXPLAIN UPSERT","FROM","GROUP BY","HAVING","INFER","INSERT INTO","INTERSECT ALL","INTERSECT","LET","LIMIT","MERGE","NEST","ORDER BY","PREPARE","SELECT","SET CURRENT SCHEMA","SET SCHEMA","SET","UNION ALL","UNION","UNNEST","UPDATE","UPSERT","USE KEYS","VALUES","WHERE"],s=["AND","INNER JOIN","JOIN","LEFT JOIN","LEFT OUTER JOIN","OR","OUTER JOIN","RIGHT JOIN","RIGHT OUTER JOIN","XOR"],u=void 0,c=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cfg=e}return t.prototype.format=function(t){return u||(u=new r.default({reservedWords:o,reservedToplevelWords:a,reservedNewlineWords:s,stringTypes:['""',"''","``"],openParens:["(","[","{"],closeParens:[")","]","}"],namedPlaceholderTypes:["$"],lineCommentTypes:["#","--"]})),new n.default(this.cfg,u).format(t)},t}();e.default=c,t.exports=e.default})),Rc=O((function(t,e){e.__esModule=!0;var n=i(yc),r=i(wc);function i(t){return t&&t.__esModule?t:{default:t}}var o=["A","ACCESSIBLE","AGENT","AGGREGATE","ALL","ALTER","ANY","ARRAY","AS","ASC","AT","ATTRIBUTE","AUTHID","AVG","BETWEEN","BFILE_BASE","BINARY_INTEGER","BINARY","BLOB_BASE","BLOCK","BODY","BOOLEAN","BOTH","BOUND","BULK","BY","BYTE","C","CALL","CALLING","CASCADE","CASE","CHAR_BASE","CHAR","CHARACTER","CHARSET","CHARSETFORM","CHARSETID","CHECK","CLOB_BASE","CLONE","CLOSE","CLUSTER","CLUSTERS","COALESCE","COLAUTH","COLLECT","COLUMNS","COMMENT","COMMIT","COMMITTED","COMPILED","COMPRESS","CONNECT","CONSTANT","CONSTRUCTOR","CONTEXT","CONTINUE","CONVERT","COUNT","CRASH","CREATE","CREDENTIAL","CURRENT","CURRVAL","CURSOR","CUSTOMDATUM","DANGLING","DATA","DATE_BASE","DATE","DAY","DECIMAL","DEFAULT","DEFINE","DELETE","DESC","DETERMINISTIC","DIRECTORY","DISTINCT","DO","DOUBLE","DROP","DURATION","ELEMENT","ELSIF","EMPTY","ESCAPE","EXCEPTIONS","EXCLUSIVE","EXECUTE","EXISTS","EXIT","EXTENDS","EXTERNAL","EXTRACT","FALSE","FETCH","FINAL","FIRST","FIXED","FLOAT","FOR","FORALL","FORCE","FROM","FUNCTION","GENERAL","GOTO","GRANT","GROUP","HASH","HEAP","HIDDEN","HOUR","IDENTIFIED","IF","IMMEDIATE","IN","INCLUDING","INDEX","INDEXES","INDICATOR","INDICES","INFINITE","INSTANTIABLE","INT","INTEGER","INTERFACE","INTERVAL","INTO","INVALIDATE","IS","ISOLATION","JAVA","LANGUAGE","LARGE","LEADING","LENGTH","LEVEL","LIBRARY","LIKE","LIKE2","LIKE4","LIKEC","LIMITED","LOCAL","LOCK","LONG","MAP","MAX","MAXLEN","MEMBER","MERGE","MIN","MINUS","MINUTE","MLSLABEL","MOD","MODE","MONTH","MULTISET","NAME","NAN","NATIONAL","NATIVE","NATURAL","NATURALN","NCHAR","NEW","NEXTVAL","NOCOMPRESS","NOCOPY","NOT","NOWAIT","NULL","NULLIF","NUMBER_BASE","NUMBER","OBJECT","OCICOLL","OCIDATE","OCIDATETIME","OCIDURATION","OCIINTERVAL","OCILOBLOCATOR","OCINUMBER","OCIRAW","OCIREF","OCIREFCURSOR","OCIROWID","OCISTRING","OCITYPE","OF","OLD","ON","ONLY","OPAQUE","OPEN","OPERATOR","OPTION","ORACLE","ORADATA","ORDER","ORGANIZATION","ORLANY","ORLVARY","OTHERS","OUT","OVERLAPS","OVERRIDING","PACKAGE","PARALLEL_ENABLE","PARAMETER","PARAMETERS","PARENT","PARTITION","PASCAL","PCTFREE","PIPE","PIPELINED","PLS_INTEGER","PLUGGABLE","POSITIVE","POSITIVEN","PRAGMA","PRECISION","PRIOR","PRIVATE","PROCEDURE","PUBLIC","RAISE","RANGE","RAW","READ","REAL","RECORD","REF","REFERENCE","RELEASE","RELIES_ON","REM","REMAINDER","RENAME","RESOURCE","RESULT_CACHE","RESULT","RETURN","RETURNING","REVERSE","REVOKE","ROLLBACK","ROW","ROWID","ROWNUM","ROWTYPE","SAMPLE","SAVE","SAVEPOINT","SB1","SB2","SB4","SECOND","SEGMENT","SELF","SEPARATE","SEQUENCE","SERIALIZABLE","SHARE","SHORT","SIZE_T","SIZE","SMALLINT","SOME","SPACE","SPARSE","SQL","SQLCODE","SQLDATA","SQLERRM","SQLNAME","SQLSTATE","STANDARD","START","STATIC","STDDEV","STORED","STRING","STRUCT","STYLE","SUBMULTISET","SUBPARTITION","SUBSTITUTABLE","SUBTYPE","SUCCESSFUL","SUM","SYNONYM","SYSDATE","TABAUTH","TABLE","TDO","THE","THEN","TIME","TIMESTAMP","TIMEZONE_ABBR","TIMEZONE_HOUR","TIMEZONE_MINUTE","TIMEZONE_REGION","TO","TRAILING","TRANSACTION","TRANSACTIONAL","TRIGGER","TRUE","TRUSTED","TYPE","UB1","UB2","UB4","UID","UNDER","UNIQUE","UNPLUG","UNSIGNED","UNTRUSTED","USE","USER","USING","VALIDATE","VALIST","VALUE","VARCHAR","VARCHAR2","VARIABLE","VARIANCE","VARRAY","VARYING","VIEW","VIEWS","VOID","WHENEVER","WHILE","WITH","WORK","WRAPPED","WRITE","YEAR","ZONE"],a=["ADD","ALTER COLUMN","ALTER TABLE","BEGIN","CONNECT BY","DECLARE","DELETE FROM","DELETE","END","EXCEPT","EXCEPTION","FETCH FIRST","FROM","GROUP BY","HAVING","INSERT INTO","INSERT","INTERSECT","LIMIT","LOOP","MODIFY","ORDER BY","SELECT","SET CURRENT SCHEMA","SET SCHEMA","SET","START WITH","UNION ALL","UNION","UPDATE","VALUES","WHERE"],s=["AND","CROSS APPLY","CROSS JOIN","ELSE","END","INNER JOIN","JOIN","LEFT JOIN","LEFT OUTER JOIN","OR","OUTER APPLY","OUTER JOIN","RIGHT JOIN","RIGHT OUTER JOIN","WHEN","XOR"],u=void 0,c=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cfg=e}return t.prototype.format=function(t){return u||(u=new r.default({reservedWords:o,reservedToplevelWords:a,reservedNewlineWords:s,stringTypes:['""',"N''","''","``"],openParens:["(","CASE"],closeParens:[")","END"],indexedPlaceholderTypes:["?"],namedPlaceholderTypes:[":"],lineCommentTypes:["--"],specialWordChars:["_","$","#",".","@"]})),new n.default(this.cfg,u).format(t)},t}();e.default=c,t.exports=e.default})),Oc=O((function(t,e){e.__esModule=!0;var n=i(yc),r=i(wc);function i(t){return t&&t.__esModule?t:{default:t}}var o=["ACCESSIBLE","ACTION","AGAINST","AGGREGATE","ALGORITHM","ALL","ALTER","ANALYSE","ANALYZE","AS","ASC","AUTOCOMMIT","AUTO_INCREMENT","BACKUP","BEGIN","BETWEEN","BINLOG","BOTH","CASCADE","CASE","CHANGE","CHANGED","CHARACTER SET","CHARSET","CHECK","CHECKSUM","COLLATE","COLLATION","COLUMN","COLUMNS","COMMENT","COMMIT","COMMITTED","COMPRESSED","CONCURRENT","CONSTRAINT","CONTAINS","CONVERT","CREATE","CROSS","CURRENT_TIMESTAMP","DATABASE","DATABASES","DAY","DAY_HOUR","DAY_MINUTE","DAY_SECOND","DEFAULT","DEFINER","DELAYED","DELETE","DESC","DESCRIBE","DETERMINISTIC","DISTINCT","DISTINCTROW","DIV","DO","DROP","DUMPFILE","DUPLICATE","DYNAMIC","ELSE","ENCLOSED","END","ENGINE","ENGINES","ENGINE_TYPE","ESCAPE","ESCAPED","EVENTS","EXEC","EXECUTE","EXISTS","EXPLAIN","EXTENDED","FAST","FETCH","FIELDS","FILE","FIRST","FIXED","FLUSH","FOR","FORCE","FOREIGN","FULL","FULLTEXT","FUNCTION","GLOBAL","GRANT","GRANTS","GROUP_CONCAT","HEAP","HIGH_PRIORITY","HOSTS","HOUR","HOUR_MINUTE","HOUR_SECOND","IDENTIFIED","IF","IFNULL","IGNORE","IN","INDEX","INDEXES","INFILE","INSERT","INSERT_ID","INSERT_METHOD","INTERVAL","INTO","INVOKER","IS","ISOLATION","KEY","KEYS","KILL","LAST_INSERT_ID","LEADING","LEVEL","LIKE","LINEAR","LINES","LOAD","LOCAL","LOCK","LOCKS","LOGS","LOW_PRIORITY","MARIA","MASTER","MASTER_CONNECT_RETRY","MASTER_HOST","MASTER_LOG_FILE","MATCH","MAX_CONNECTIONS_PER_HOUR","MAX_QUERIES_PER_HOUR","MAX_ROWS","MAX_UPDATES_PER_HOUR","MAX_USER_CONNECTIONS","MEDIUM","MERGE","MINUTE","MINUTE_SECOND","MIN_ROWS","MODE","MODIFY","MONTH","MRG_MYISAM","MYISAM","NAMES","NATURAL","NOT","NOW()","NULL","OFFSET","ON DELETE","ON UPDATE","ON","ONLY","OPEN","OPTIMIZE","OPTION","OPTIONALLY","OUTFILE","PACK_KEYS","PAGE","PARTIAL","PARTITION","PARTITIONS","PASSWORD","PRIMARY","PRIVILEGES","PROCEDURE","PROCESS","PROCESSLIST","PURGE","QUICK","RAID0","RAID_CHUNKS","RAID_CHUNKSIZE","RAID_TYPE","RANGE","READ","READ_ONLY","READ_WRITE","REFERENCES","REGEXP","RELOAD","RENAME","REPAIR","REPEATABLE","REPLACE","REPLICATION","RESET","RESTORE","RESTRICT","RETURN","RETURNS","REVOKE","RLIKE","ROLLBACK","ROW","ROWS","ROW_FORMAT","SECOND","SECURITY","SEPARATOR","SERIALIZABLE","SESSION","SHARE","SHOW","SHUTDOWN","SLAVE","SONAME","SOUNDS","SQL","SQL_AUTO_IS_NULL","SQL_BIG_RESULT","SQL_BIG_SELECTS","SQL_BIG_TABLES","SQL_BUFFER_RESULT","SQL_CACHE","SQL_CALC_FOUND_ROWS","SQL_LOG_BIN","SQL_LOG_OFF","SQL_LOG_UPDATE","SQL_LOW_PRIORITY_UPDATES","SQL_MAX_JOIN_SIZE","SQL_NO_CACHE","SQL_QUOTE_SHOW_CREATE","SQL_SAFE_UPDATES","SQL_SELECT_LIMIT","SQL_SLAVE_SKIP_COUNTER","SQL_SMALL_RESULT","SQL_WARNINGS","START","STARTING","STATUS","STOP","STORAGE","STRAIGHT_JOIN","STRING","STRIPED","SUPER","TABLE","TABLES","TEMPORARY","TERMINATED","THEN","TO","TRAILING","TRANSACTIONAL","TRUE","TRUNCATE","TYPE","TYPES","UNCOMMITTED","UNIQUE","UNLOCK","UNSIGNED","USAGE","USE","USING","VARIABLES","VIEW","WHEN","WITH","WORK","WRITE","YEAR_MONTH"],a=["ADD","AFTER","ALTER COLUMN","ALTER TABLE","DELETE FROM","EXCEPT","FETCH FIRST","FROM","GROUP BY","GO","HAVING","INSERT INTO","INSERT","INTERSECT","LIMIT","MODIFY","ORDER BY","SELECT","SET CURRENT SCHEMA","SET SCHEMA","SET","UNION ALL","UNION","UPDATE","VALUES","WHERE"],s=["AND","CROSS APPLY","CROSS JOIN","ELSE","INNER JOIN","JOIN","LEFT JOIN","LEFT OUTER JOIN","OR","OUTER APPLY","OUTER JOIN","RIGHT JOIN","RIGHT OUTER JOIN","WHEN","XOR"],u=void 0,c=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cfg=e}return t.prototype.format=function(t){return u||(u=new r.default({reservedWords:o,reservedToplevelWords:a,reservedNewlineWords:s,stringTypes:['""',"N''","''","``","[]"],openParens:["(","CASE"],closeParens:[")","END"],indexedPlaceholderTypes:["?"],namedPlaceholderTypes:["@",":"],lineCommentTypes:["#","--"]})),new n.default(this.cfg,u).format(t)},t}();e.default=c,t.exports=e.default})),Sc=R(O((function(t,e){e.__esModule=!0;var n=a(bc),r=a(Ac),i=a(Rc),o=a(Oc);function a(t){return t&&t.__esModule?t:{default:t}}e.default={format:function(t,e){switch((e=e||{}).language){case"db2":return new n.default(e).format(t);case"n1ql":return new r.default(e).format(t);case"pl/sql":return new i.default(e).format(t);case"sql":case void 0:return new o.default(e).format(t);default:throw Error("Unsupported SQL dialect: "+e.language)}}},t.exports=e.default})));const Ic="event",Cc="sql",Lc="static",Mc="non-static",xc=t=>kc(t.match(/[^.|:]+$/)[0]||t),kc=t=>(t=>{const e=[];return(t||"").split(/[\$.:#\-_]/).forEach((t=>{e.push(...m(t))})),e})(t).map((t=>g(t))).join(" "),Pc=(t,e)=>v.call(t,e);function Dc(t){switch(t){case"boolean":case"TrueClass":case"FalseClass":case"java.lang.Boolean":return"bool";case"status":case"byte":case"short":case"int":case"long":case"Number":case"Integer":case"java.lang.Byte":case"java.lang.Short":case"java.lang.Integer":case"java.lang.Long":return"int";case"float":case"double":case"BigDecimal":case"Float":case"java.lang.Float":case"java.lang.Double":return"float";case"mime_type":case"char":case"String":case"java.lang.Char":case"java.lang.String":return"string";default:return"object"}}function Uc(t){return v.call(t.input,"http_server_request")?Ic:v.call(t.input,"sql_query")?Cc:t.input.static?Lc:Mc}function jc(t,e,n,r){const[i,o]=[t-n,e-r],a=Math.sqrt(i*i+o*o),s=Math.min(.5*a,Math.abs(i));return`M${t},${e} C${t+s},${e} ${n-s},${r}, ${n},${r}`}function Gc(t,e){const n=document.querySelector(`.node[data-node-id='${t}'] ${e}`);if(!n)return null;const{offsetLeft:r,offsetTop:i,offsetHeight:o,offsetWidth:a}=n;return{left:r,right:r+a,x:r+a/2,y:i+o/2}}function Bc(t,e){return Gc(t,`.connector[data-connection-type="${e}"]`)}function Fc(t,e){return Gc(t,`.item[data-port-id="${e}"]`)}function Hc(t,e){if(!e||!e.behavior)return;e.behavior.out.forEach((n=>{if(!n.value||!n.value.object_id)return;const r=n.value.object_id;t[r]||(t[r]={nodeId:e.behavior.id,outputId:r})}))}function Vc(t){const e=[],n=[],r=[];return t.preOrderForEach((t=>{if(!t.input.id)return;const n=function(t){const{input:e,displayName:n}=t,r={id:e.id,event_id:e.id,type:Uc(t),name:n,in:[],out:[],exceptions:[],x:0,y:0};Object.defineProperty(r,"data",{enumerable:!1,writable:!0}),r.data=t,t.behavior=r,r.type===Cc&&(r.value=Sc.format(t.input.sql_query.sql)),r.type===Mc&&r.in.push({name:xc(e.defined_class),type:Dc(e.defined_class),value:e.receiver}),v.call(e,"parameters")&&Array.isArray(e.parameters)&&e.parameters.forEach((t=>{r.in.push({name:kc(t.name),type:Dc(t.class),value:t})}));const i=t.output.return_value;if(i&&i.value){const t=Dc(i.class);let e=t;"object"===t&&(e=i.class),r.out.push({name:xc(e),type:t,value:i})}const{exceptions:o}=t.output;if(o&&(r.exceptions=o),v.call(e,"message")){e.message.forEach((t=>{r.in.push({name:kc(t.name),type:Dc(t.class),value:t})}));const n=t.output.http_server_response||{};Object.keys(n).forEach((t=>{r.out.push({name:kc(t),type:Dc(t),value:{value:n[t]}})}))}return r}(t);e.push(n)})),e.forEach((t=>{const e=function(t){const e={},n=t.data.caller;if(!n)return e;Hc(e,n);const r=n.caller;if(!r)return e;if(!r.caller)return e;const i=r.children.findIndex((t=>t===n));if(i>0)for(let t=i-1;t>=0;t-=1){const n=r.children[t];Hc(e,n)}return n.ancestors().forEach((t=>Hc(e,t))),e}(t);t.in.forEach((n=>{if(!n.value||!n.value.object_id)return;const i=n.value.object_id,o=e[i];o&&r.push({type:n.type,input:{nodeId:t.id,portId:i},output:{nodeId:o.nodeId,portId:o.outputId}})}));const{caller:i}=t.data;i&&i.behavior&&n.push({source:i.behavior.id,target:t.id})})),[n,r]}function Wc(t,e,n,r){t.valuePopper.text(n&&n.value?n.value:"null").attr("data-show","").attr("data-placement",r).append("div").attr("id","arrow");const i=t.valuePopper.node(),{offsetWidth:o,offsetHeight:a}=i;let s=0;s="left"===r?e.offsetLeft-o:e.offsetLeft+e.offsetWidth;const u=e.offsetTop+.5*(e.offsetHeight-a);t.valuePopper.style("transform",`translate3d(${s}px, ${u}px, 0px)`),t.emit("popper",i)}class zc extends C.EventSource{constructor(t,n={}){super(),this.container=new H(t,n),this.element=document.createElement("div"),this.element.className="appmap__flow-view",this.container.appendChild(this.element),this.svg=e.select(this.element).append("svg").attr("width",window.innerWidth).attr("height",window.innerHeight),this.nodeGroup=e.select(this.element).append("ul").attr("id","nodes"),this.linkGroup=this.svg.append("g").attr("id","links"),this.valuePopper=e.select(this.element).append("div").attr("class","appmap__flow-view-popper"),document.addEventListener("click",(()=>this.hidePopper())),this.on("popper",(t=>function(t,e,n=0){if(!e)return;let{x:r,y:i}=p.delta(t.element.getBoundingClientRect(),e.getBoundingClientRect());r+=Math.sign(r)*n,i+=Math.sign(i)*n;const{k:o}=t.transform;r/=o,i/=o,t.translateBy(r,i)}(this.container.containerController,t,10)))}setCallTree(t){this.callTree=t,this.callTree.on("selectedEvent",(t=>{!function(t,n){if(!n||w(t,n))return;let r;const i=t.element.querySelector(".node.highlight");if(w(t,i)){const t=e.zoomTransform(i),n=getComputedStyle(i);r=t.apply([i.offsetLeft+Number.parseInt(n.borderLeftWidth,10),i.offsetTop+Number.parseInt(n.borderTopWidth,10)])}t.translateTo(n.offsetLeft,n.offsetTop,r)}(this.container.containerController,t.element),this.highlight(t?t.id:null)})),this.callTree.on("rootEvent",(()=>{this.render()}))}render(){const{rootEvent:t}=this.callTree,[n,r]=Vc(t),i=n.reduce(((t,e)=>(t[e.source]=e.target,t)),{}),o=n.reduce(((t,e)=>(t[e.target]=e.source,t)),{}),a=n=>{const r=n.filter((t=>t.data.behavior)).append("div").datum((t=>t.data.behavior)).classed("node",!0).classed("exception",(t=>t.exceptions.length>0)).attr("data-node-id",(t=>t.id)).attr("data-event-id",(t=>t.event_id)).on("click",(t=>this.callTree.selectedEvent=t.data)).on("dblclick",(t=>this.emit("dblclick",t.data))).on("contextmenu",(t=>this.callTree.selectedEvent=t.data));r.append("div").attr("data-type",(t=>t.type)).classed("header",!0).attr("draggable",!0).append("p").html((t=>t.name)).attr("draggable",!0);const a=r.append("div").classed("io",!0),s=a.append("div").classed("column left",!0);s.append("div").attr("data-connection-type","input").classed("connector",!0).classed("in-use",(t=>Pc(o,t.id))),s.selectAll(null).data((t=>t.in.map((e=>({...e,id:t.id}))))).enter().append("div").classed("item",!0).classed("has-data",(t=>t&&t.value&&t.value.value)).attr("data-type",(t=>t.type)).attr("data-port-type","input").attr("data-port-id",(t=>t&&t.value&&t.value.object_id)).text((t=>t.name)).on("click",((n,r,i)=>{this.callTree.selectedEvent=t.find((t=>t.id===n.id)),Wc(this,i[r],n.value,"left"),e.event.stopPropagation()}));const u=a.append("div").classed("column right",!0);u.append("div").attr("data-connection-type","output").classed("connector",!0).classed("in-use",(t=>Pc(i,t.id))),u.selectAll(null).data((t=>t.out.map((e=>({...e,id:t.id}))))).enter().append("div").classed("item",!0).classed("has-data",(t=>t&&t.value&&t.value.value)).attr("data-type",(t=>t.type)).attr("data-port-type","output").attr("data-port-id",(t=>t&&t.value&&t.value.object_id)).text((t=>t.name)).on("click",((n,r,i)=>{this.callTree.selectedEvent=t.find((t=>t.id===n.id)),Wc(this,i[r],n.value,"right"),e.event.stopPropagation()})),r.filter((t=>"sql"===t.type)).append("div").classed("sql",!0).text((t=>t.value))};this.nodeGroup.text(null),this.linkGroup.text(null),this.nodeGroup.datum(e.hierarchy(t)).call((function t(e){e.empty()||e.append("li").call(a).append("ul").selectAll(":scope > li").data((t=>t.children||[]),(t=>t.data.behavior.id)).join(t)})),this.nodeGroup.selectAll(".node").each(((t,e,n)=>t.data.element=n[e])),this.linkGroup.selectAll(".node-connection").data(n).enter().append("path").classed("connection",!0).classed("node-connection",!0).attr("d",(t=>{const e=Bc(t.source,"output"),n=Bc(t.target,"input");return e&&n?jc(e.right,e.y,n.left,n.y):null})),this.linkGroup.selectAll(".port-connection").data(r).enter().append("path").attr("class",(t=>`type-${t.type}`)).classed("connection",!0).classed("port-connection",!0).attr("d",(t=>{const e=Fc(t.output.nodeId,t.output.portId),n=Fc(t.input.nodeId,t.input.portId);return e&&n?jc(e.right,e.y,n.left,n.y):null}))}highlight(t){this.hidePopper(),this.nodeGroup.selectAll(".node").classed("highlight",!1).filter((e=>e.id===t)).classed("highlight",!0)}hidePopper(){this.valuePopper.attr("data-show",null)}}var Yc=R(O((function(t,e){var n;window,n=function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=7)}({7:function(t,e,n){function r(){}n.r(e);var i=function(t){return null==t?r:function(){return this.querySelector(t)}};function o(){return[]}var a=function(t){return null==t?o:function(){return this.querySelectorAll(t)}},s=function(t){return function(){return this.matches(t)}},u=function(t){return new Array(t.length)};function c(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function l(t,e,n,r,i,o){for(var a,s=0,u=e.length,l=o.length;s<l;++s)(a=e[s])?(a.__data__=o[s],r[s]=a):n[s]=new c(t,o[s]);for(;s<u;++s)(a=e[s])&&(i[s]=a)}function h(t,e,n,r,i,o,a){var s,u,l,h={},f=e.length,d=o.length,p=new Array(f);for(s=0;s<f;++s)(u=e[s])&&(p[s]=l="$"+a.call(u,u.__data__,s,e),l in h?i[s]=u:h[l]=u);for(s=0;s<d;++s)(u=h[l="$"+a.call(t,o[s],s,o)])?(r[s]=u,u.__data__=o[s],h[l]=null):n[s]=new c(t,o[s]);for(s=0;s<f;++s)(u=e[s])&&h[p[s]]===u&&(i[s]=u)}function f(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}c.prototype={constructor:c,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var d="http://www.w3.org/1999/xhtml",p={svg:"http://www.w3.org/2000/svg",xhtml:d,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},v=function(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),p.hasOwnProperty(e)?{space:p[e],local:t}:t};function g(t){return function(){this.removeAttribute(t)}}function E(t){return function(){this.removeAttributeNS(t.space,t.local)}}function m(t,e){return function(){this.setAttribute(t,e)}}function y(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function _(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function N(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}var T=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView};function w(t){return function(){this.style.removeProperty(t)}}function b(t,e,n){return function(){this.style.setProperty(t,e,n)}}function A(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function R(t,e){return t.style.getPropertyValue(e)||T(t).getComputedStyle(t,null).getPropertyValue(e)}function O(t){return function(){delete this[t]}}function S(t,e){return function(){this[t]=e}}function I(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function C(t){return t.trim().split(/^|\s+/)}function L(t){return t.classList||new M(t)}function M(t){this._node=t,this._names=C(t.getAttribute("class")||"")}function x(t,e){for(var n=L(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function k(t,e){for(var n=L(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function P(t){return function(){x(this,t)}}function D(t){return function(){k(this,t)}}function U(t,e){return function(){(e.apply(this,arguments)?x:k)(this,t)}}function j(){this.textContent=""}function G(t){return function(){this.textContent=t}}function B(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function F(){this.innerHTML=""}function H(t){return function(){this.innerHTML=t}}function V(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function W(){this.nextSibling&&this.parentNode.appendChild(this)}function z(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Y(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===d&&e.documentElement.namespaceURI===d?e.createElement(t):e.createElementNS(n,t)}}function $(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}M.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var X=function(t){var e=v(t);return(e.local?$:Y)(e)};function q(){return null}function K(){var t=this.parentNode;t&&t.removeChild(this)}function Q(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Z(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}var J={};function tt(t,e,n){return t=et(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function et(t,e,n){return function(r){try{t.call(this,this.__data__,e,n)}finally{}}}function nt(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function rt(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,o=e.length;r<o;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?e.length=i:delete this.__on}}}function it(t,e,n){var r=J.hasOwnProperty(t.type)?tt:et;return function(i,o,a){var s,u=this.__on,c=r(e,o,a);if(u)for(var l=0,h=u.length;l<h;++l)if((s=u[l]).type===t.type&&s.name===t.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=c,s.capture=n),void(s.value=e);this.addEventListener(t.type,c,n),s={type:t.type,name:t.name,value:e,listener:c,capture:n},u?u.push(s):this.__on=[s]}}function ot(t,e,n){var r=T(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function at(t,e){return function(){return ot(this,t,e)}}function st(t,e){return function(){return ot(this,t,e.apply(this,arguments))}}"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(J={mouseenter:"mouseover",mouseleave:"mouseout"}));var ut=[null];function ct(t,e){this._groups=t,this._parents=e}function lt(){return new ct([[document.documentElement]],ut)}ct.prototype=lt.prototype={constructor:ct,select:function(t){"function"!=typeof t&&(t=i(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var a,s,u=e[o],c=u.length,l=r[o]=new Array(c),h=0;h<c;++h)(a=u[h])&&(s=t.call(a,a.__data__,h,u))&&("__data__"in a&&(s.__data__=a.__data__),l[h]=s);return new ct(r,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=a(t));for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var s,u=e[o],c=u.length,l=0;l<c;++l)(s=u[l])&&(r.push(t.call(s,s.__data__,l,u)),i.push(s));return new ct(r,i)},filter:function(t){"function"!=typeof t&&(t=s(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a=e[i],u=a.length,c=r[i]=[],l=0;l<u;++l)(o=a[l])&&t.call(o,o.__data__,l,a)&&c.push(o);return new ct(r,this._parents)},data:function(t,e){if(!t)return g=new Array(this.size()),f=-1,this.each((function(t){g[++f]=t})),g;var n,r=e?h:l,i=this._parents,o=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var a=o.length,s=new Array(a),u=new Array(a),c=new Array(a),f=0;f<a;++f){var d=i[f],p=o[f],v=p.length,g=t.call(d,d&&d.__data__,f,i),E=g.length,m=u[f]=new Array(E),y=s[f]=new Array(E);r(d,p,m,y,c[f]=new Array(v),g,e);for(var _,N,T=0,w=0;T<E;++T)if(_=m[T]){for(T>=w&&(w=T+1);!(N=y[w])&&++w<E;);_._next=N||null}}return(s=new ct(s,i))._enter=u,s._exit=c,s},enter:function(){return new ct(this._enter||this._groups.map(u),this._parents)},exit:function(){return new ct(this._exit||this._groups.map(u),this._parents)},join:function(t,e,n){var r=this.enter(),i=this,o=this.exit();return r="function"==typeof t?t(r):r.append(t+""),null!=e&&(i=e(i)),null==n?o.remove():n(o),r&&i?r.merge(i).order():i},merge:function(t){for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var u,c=e[s],l=n[s],h=c.length,f=a[s]=new Array(h),d=0;d<h;++d)(u=c[d]||l[d])&&(f[d]=u);for(;s<r;++s)a[s]=e[s];return new ct(a,this._parents)},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=f);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a,s=n[o],u=s.length,c=i[o]=new Array(u),l=0;l<u;++l)(a=s[l])&&(c[l]=a);c.sort(e)}return new ct(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each((function(){t[++e]=this})),t},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){var t=0;return this.each((function(){++t})),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,o=e[n],a=0,s=o.length;a<s;++a)(i=o[a])&&t.call(i,i.__data__,a,o);return this},attr:function(t,e){var n=v(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?E:g:"function"==typeof e?n.local?N:_:n.local?y:m)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?w:"function"==typeof e?A:b)(t,e,null==n?"":n)):R(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?O:"function"==typeof e?I:S)(t,e)):this.node()[t]},classed:function(t,e){var n=C(t+"");if(arguments.length<2){for(var r=L(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?U:e?P:D)(n,e))},text:function(t){return arguments.length?this.each(null==t?j:("function"==typeof t?B:G)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?F:("function"==typeof t?V:H)(t)):this.node().innerHTML},raise:function(){return this.each(W)},lower:function(){return this.each(z)},append:function(t){var e="function"==typeof t?t:X(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:X(t),r=null==e?q:"function"==typeof e?e:i(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(K)},clone:function(t){return this.select(t?Z:Q)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,o=nt(t+""),a=o.length;if(!(arguments.length<2)){for(s=e?it:rt,null==n&&(n=!1),r=0;r<a;++r)this.each(s(o[r],e,n));return this}var s=this.node().__on;if(s)for(var u,c=0,l=s.length;c<l;++c)for(r=0,u=s[c];r<a;++r)if((i=o[r]).type===u.type&&i.name===u.name)return u.value},dispatch:function(t,e){return this.each(("function"==typeof e?st:at)(t,e))}};var ht=lt,ft=function(t){return"string"==typeof t?new ct([[document.querySelector(t)]],[document.documentElement]):new ct([[t]],ut)},dt=function(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]},pt=function(t){return(t=dt(Math.abs(t)))?t[1]:NaN},vt=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function gt(t){if(!(e=vt.exec(t)))throw new Error("invalid format: "+t);var e;return new Et({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Et(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}gt.prototype=Et.prototype,Et.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var mt,yt,_t,Nt,Tt=function(t,e){var n=dt(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},wt={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return Tt(100*t,e)},r:Tt,s:function(t,e){var n=dt(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(mt=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+dt(t,Math.max(0,e+o-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},bt=function(t){return t},At=Array.prototype.map,Rt=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];yt=function(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?bt:(e=At.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,o=[],a=0,s=e[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),o.push(t.substring(i-=s,i+s)),!((u+=s+1)>r));)s=e[a=(a+1)%e.length];return o.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",a=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?bt:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(At.call(t.numerals,String)),u=void 0===t.percent?"%":t.percent+"",c=void 0===t.minus?"-":t.minus+"",l=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=gt(t)).fill,n=t.align,h=t.sign,f=t.symbol,d=t.zero,p=t.width,v=t.comma,g=t.precision,E=t.trim,m=t.type;"n"===m?(v=!0,m="g"):wt[m]||(void 0===g&&(g=12),E=!0,m="g"),(d||"0"===e&&"="===n)&&(d=!0,e="0",n="=");var y="$"===f?i:"#"===f&&/[boxX]/.test(m)?"0"+m.toLowerCase():"",_="$"===f?o:/[%p]/.test(m)?u:"",N=wt[m],T=/[defgprs%]/.test(m);function w(t){var i,o,u,f=y,w=_;if("c"===m)w=N(t)+w,t="";else{var b=(t=+t)<0;if(t=isNaN(t)?l:N(Math.abs(t),g),E&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),b&&0==+t&&(b=!1),f=(b?"("===h?h:c:"-"===h||"("===h?"":h)+f,w=("s"===m?Rt[8+mt/3]:"")+w+(b&&"("===h?")":""),T)for(i=-1,o=t.length;++i<o;)if(48>(u=t.charCodeAt(i))||u>57){w=(46===u?a+t.slice(i+1):t.slice(i))+w,t=t.slice(0,i);break}}v&&!d&&(t=r(t,1/0));var A=f.length+t.length+w.length,R=A<p?new Array(p-A+1).join(e):"";switch(v&&d&&(t=r(R+t,R.length?p-w.length:1/0),R=""),n){case"<":t=f+t+w+R;break;case"=":t=f+R+t+w;break;case"^":t=R.slice(0,A=R.length>>1)+f+t+w+R.slice(A);break;default:t=R+f+t+w}return s(t)}return g=void 0===g?6:/[gprs]/.test(m)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),w.toString=function(){return t+""},w}return{format:h,formatPrefix:function(t,e){var n=h(((t=gt(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(pt(e)/3))),i=Math.pow(10,-r),o=Rt[8+r/3];return function(t){return n(i*t)+o}}}}({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),_t=yt.format,Nt=yt.formatPrefix;var Ot=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},St=function(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)},It=function(){var t=1,e=1,n=0,r=!1;function i(i){var o=i.height+1;return i.x0=i.y0=n,i.x1=t,i.y1=e/o,i.eachBefore(function(t,e){return function(r){r.children&&function(t,e,n,r,i){for(var o,a=t.children,s=-1,u=a.length,c=t.value&&(r-e)/t.value;++s<u;)(o=a[s]).y0=n,o.y1=i,o.x0=e,o.x1=e+=o.value*c}(r,r.x0,t*(r.depth+1)/e,r.x1,t*(r.depth+2)/e);var i=r.x0,o=r.y0,a=r.x1-n,s=r.y1-n;a<i&&(i=a=(i+a)/2),s<o&&(o=s=(o+s)/2),r.x0=i,r.y0=o,r.x1=a,r.y1=s}}(e,o)),r&&i.eachBefore(St),i}return i.round=function(t){return arguments.length?(r=!!t,i):r},i.size=function(n){return arguments.length?(t=+n[0],e=+n[1],i):[t,e]},i.padding=function(t){return arguments.length?(n=+t,i):n},i};function Ct(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function Lt(t,e){var n,r,i,o,a,s=new Pt(t),u=+t.value&&(s.value=t.value),c=[s];for(null==e&&(e=Mt);n=c.pop();)if(u&&(n.value=+n.data.value),(i=e(n.data))&&(a=i.length))for(n.children=new Array(a),o=a-1;o>=0;--o)c.push(r=n.children[o]=new Pt(i[o])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(kt)}function Mt(t){return t.children}function xt(t){t.data=t.data.data}function kt(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function Pt(t){this.data=t,this.depth=this.height=0,this.parent=null}Pt.prototype=Lt.prototype={constructor:Pt,count:function(){return this.eachAfter(Ct)},each:function(t){var e,n,r,i,o=this,a=[o];do{for(e=a.reverse(),a=[];o=e.pop();)if(t(o),n=o.children)for(r=0,i=n.length;r<i;++r)a.push(n[r])}while(a.length);return this},eachAfter:function(t){for(var e,n,r,i=this,o=[i],a=[];i=o.pop();)if(a.push(i),e=i.children)for(n=0,r=e.length;n<r;++n)o.push(e[n]);for(;i=a.pop();)t(i);return this},eachBefore:function(t){for(var e,n,r=this,i=[r];r=i.pop();)if(t(r),e=r.children)for(n=e.length-1;n>=0;--n)i.push(e[n]);return this},sum:function(t){return this.eachAfter((function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n}))},sort:function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;for(t=n.pop(),e=r.pop();t===e;)i=t,t=n.pop(),e=r.pop();return i}(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){var t=[];return this.each((function(e){t.push(e)})),t},leaves:function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},links:function(){var t=this,e=[];return t.each((function(n){n!==t&&e.push({source:n.parent,target:n})})),e},copy:function(){return Lt(this).eachBefore(xt)}};var Dt=Math.sqrt(50),Ut=Math.sqrt(10),jt=Math.sqrt(2);function Gt(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=Dt?10:o>=Ut?5:o>=jt?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=Dt?10:o>=Ut?5:o>=jt?2:1)}var Bt,Ft,Ht=(1===(Bt=Ot).length&&(Ft=Bt,Bt=function(t,e){return Ot(Ft(t),e)}),{left:function(t,e,n,r){for(null==n&&(n=0),null==r&&(r=t.length);n<r;){var i=n+r>>>1;Bt(t[i],e)<0?n=i+1:r=i}return n},right:function(t,e,n,r){for(null==n&&(n=0),null==r&&(r=t.length);n<r;){var i=n+r>>>1;Bt(t[i],e)>0?r=i:n=i+1}return n}}).right,Vt=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t};function Wt(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function zt(){}var Yt=.7,$t=1/Yt,Xt="\\s*([+-]?\\d+)\\s*",qt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Kt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Qt=/^#([0-9a-f]{3,8})$/,Zt=new RegExp("^rgb\\("+[Xt,Xt,Xt]+"\\)$"),Jt=new RegExp("^rgb\\("+[Kt,Kt,Kt]+"\\)$"),te=new RegExp("^rgba\\("+[Xt,Xt,Xt,qt]+"\\)$"),ee=new RegExp("^rgba\\("+[Kt,Kt,Kt,qt]+"\\)$"),ne=new RegExp("^hsl\\("+[qt,Kt,Kt]+"\\)$"),re=new RegExp("^hsla\\("+[qt,Kt,Kt,qt]+"\\)$"),ie={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function oe(){return this.rgb().formatHex()}function ae(){return this.rgb().formatRgb()}function se(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Qt.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?ue(e):3===n?new fe(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?new fe(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?new fe(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Zt.exec(t))?new fe(e[1],e[2],e[3],1):(e=Jt.exec(t))?new fe(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=te.exec(t))?ce(e[1],e[2],e[3],e[4]):(e=ee.exec(t))?ce(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=ne.exec(t))?ge(e[1],e[2]/100,e[3]/100,1):(e=re.exec(t))?ge(e[1],e[2]/100,e[3]/100,e[4]):ie.hasOwnProperty(t)?ue(ie[t]):"transparent"===t?new fe(NaN,NaN,NaN,0):null}function ue(t){return new fe(t>>16&255,t>>8&255,255&t,1)}function ce(t,e,n,r){return r<=0&&(t=e=n=NaN),new fe(t,e,n,r)}function le(t){return t instanceof zt||(t=se(t)),t?new fe((t=t.rgb()).r,t.g,t.b,t.opacity):new fe}function he(t,e,n,r){return 1===arguments.length?le(t):new fe(t,e,n,null==r?1:r)}function fe(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function de(){return"#"+ve(this.r)+ve(this.g)+ve(this.b)}function pe(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function ve(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function ge(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new me(t,e,n,r)}function Ee(t){if(t instanceof me)return new me(t.h,t.s,t.l,t.opacity);if(t instanceof zt||(t=se(t)),!t)return new me;if(t instanceof me)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(a=e===o?(n-r)/s+6*(n<r):n===o?(r-e)/s+2:(e-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new me(a,s,u,t.opacity)}function me(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function ye(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}Vt(zt,se,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:oe,formatHex:oe,formatHsl:function(){return Ee(this).formatHsl()},formatRgb:ae,toString:ae}),Vt(fe,he,Wt(zt,{brighter:function(t){return t=null==t?$t:Math.pow($t,t),new fe(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?Yt:Math.pow(Yt,t),new fe(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:de,formatHex:de,formatRgb:pe,toString:pe})),Vt(me,(function(t,e,n,r){return 1===arguments.length?Ee(t):new me(t,e,n,null==r?1:r)}),Wt(zt,{brighter:function(t){return t=null==t?$t:Math.pow($t,t),new me(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?Yt:Math.pow(Yt,t),new me(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new fe(ye(t>=240?t-240:t+120,i,r),ye(t,i,r),ye(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var _e=function(t){return function(){return t}};function Ne(t){return 1==(t=+t)?Te:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):_e(isNaN(e)?n:e)}}function Te(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):_e(isNaN(t)?e:t)}var we=function t(e){var n=Ne(e);function r(t,e){var r=n((t=he(t)).r,(e=he(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),a=Te(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=a(e),t+""}}return r.gamma=t,r}(1),be=function(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(o){for(n=0;n<r;++n)i[n]=t[n]*(1-o)+e[n]*o;return i}};function Ae(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=Me(t[n],e[n]);for(;n<r;++n)a[n]=e[n];return function(t){for(n=0;n<i;++n)a[n]=o[n](t);return a}}var Re=function(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}},Oe=function(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}},Se=function(t,e){var n,r={},i={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=Me(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}},Ie=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ce=new RegExp(Ie.source,"g"),Le=function(t,e){var n,r,i,o=Ie.lastIndex=Ce.lastIndex=0,a=-1,s=[],u=[];for(t+="",e+="";(n=Ie.exec(t))&&(r=Ce.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,u.push({i:a,x:Oe(n,r)})),o=Ce.lastIndex;return o<e.length&&(i=e.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?u[0]?function(t){return function(e){return t(e)+""}}(u[0].x):function(t){return function(){return t}}(e):(e=u.length,function(t){for(var n,r=0;r<e;++r)s[(n=u[r]).i]=n.x(t);return s.join("")})},Me=function(t,e){var n,r,i=typeof e;return null==e||"boolean"===i?_e(e):("number"===i?Oe:"string"===i?(n=se(e))?(e=n,we):Le:e instanceof se?we:e instanceof Date?Re:(r=e,!ArrayBuffer.isView(r)||r instanceof DataView?Array.isArray(e)?Ae:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?Se:Oe:be))(t,e)},xe=function(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}},ke=function(t){return+t},Pe=[0,1];function De(t){return t}function Ue(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function je(t,e,n){var r=t[0],i=t[1],o=e[0],a=e[1];return i<r?(r=Ue(i,r),o=n(a,o)):(r=Ue(r,i),o=n(o,a)),function(t){return o(r(t))}}function Ge(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)i[a]=Ue(t[a],t[a+1]),o[a]=n(e[a],e[a+1]);return function(e){var n=Ht(t,e,1,r)-1;return o[n](i[n](e))}}function Be(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Fe(){var t,e,n,r,i,o,a=Pe,s=Pe,u=Me,c=De;function l(){var t,e,n,u=Math.min(a.length,s.length);return c!==De&&(t=a[0],e=a[u-1],t>e&&(n=t,t=e,e=n),c=function(n){return Math.max(t,Math.min(e,n))}),r=u>2?Ge:je,i=o=null,h}function h(e){return isNaN(e=+e)?n:(i||(i=r(a.map(t),s,u)))(t(c(e)))}return h.invert=function(n){return c(e((o||(o=r(s,a.map(t),Oe)))(n)))},h.domain=function(t){return arguments.length?(a=Array.from(t,ke),l()):a.slice()},h.range=function(t){return arguments.length?(s=Array.from(t),l()):s.slice()},h.rangeRound=function(t){return s=Array.from(t),u=xe,l()},h.clamp=function(t){return arguments.length?(c=!!t||De,l()):c!==De},h.interpolate=function(t){return arguments.length?(u=t,l()):u},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,r){return t=n,e=r,l()}}function He(){return Fe()(De,De)}function Ve(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}var We=function(t,e,n,r){var i,o=function(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=Dt?i*=10:o>=Ut?i*=5:o>=jt&&(i*=2),e<t?-i:i}(t,e,n);switch((r=gt(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(pt(e)/3)))-pt(Math.abs(t)))}(o,a))||(r.precision=i),Nt(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,pt(e)-pt(t))+1}(o,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(t){return Math.max(0,-pt(Math.abs(t)))}(o))||(r.precision=i-2*("%"===r.type))}return _t(r)};function ze(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){var r,i,o,a,s=-1;if(n=+n,(t=+t)==(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(a=Gt(t,e,n))||!isFinite(a))return[];if(a>0)for(t=Math.ceil(t/a),e=Math.floor(e/a),o=new Array(i=Math.ceil(e-t+1));++s<i;)o[s]=(t+s)*a;else for(t=Math.floor(t*a),e=Math.ceil(e*a),o=new Array(i=Math.ceil(t-e+1));++s<i;)o[s]=(t-s)/a;return r&&o.reverse(),o}(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return We(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i=e(),o=0,a=i.length-1,s=i[o],u=i[a];return u<s&&(r=s,s=u,u=r,r=o,o=a,a=r),(r=Gt(s,u,n))>0?r=Gt(s=Math.floor(s/r)*r,u=Math.ceil(u/r)*r,n):r<0&&(r=Gt(s=Math.ceil(s*r)/r,u=Math.floor(u*r)/r,n)),r>0?(i[o]=Math.floor(s/r)*r,i[a]=Math.ceil(u/r)*r,e(i)):r<0&&(i[o]=Math.ceil(s*r)/r,i[a]=Math.floor(u*r)/r,e(i)),t},t}function Ye(){var t=He();return t.copy=function(){return Be(t,Ye())},Ve.apply(t,arguments),ze(t)}function $e(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Xe={value:function(){}};function qe(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new Ke(r)}function Ke(t){this._=t}function Qe(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function Ze(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function Je(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=Xe,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}Ke.prototype=qe.prototype={constructor:Ke,on:function(t,e){var n,r=this._,i=Qe(t+"",r),o=-1,a=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<a;)if(n=(t=i[o]).type)r[n]=Je(r[n],t.name,e);else if(null==e)for(n in r)r[n]=Je(r[n],t.name,null);return this}for(;++o<a;)if((n=(t=i[o]).type)&&(n=Ze(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Ke(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};var tn,en,nn=qe,rn=0,on=0,an=0,sn=0,un=0,cn=0,ln="object"==typeof performance&&performance.now?performance:Date,hn="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function fn(){return un||(hn(dn),un=ln.now()+cn)}function dn(){un=0}function pn(){this._call=this._time=this._next=null}function vn(t,e,n){var r=new pn;return r.restart(t,e,n),r}function gn(){un=(sn=ln.now())+cn,rn=on=0;try{!function(){fn(),++rn;for(var t,e=tn;e;)(t=un-e._time)>=0&&e._call.call(null,t),e=e._next;--rn}()}finally{rn=0,function(){for(var t,e,n=tn,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:tn=e);en=t,mn(r)}(),un=0}}function En(){var t=ln.now(),e=t-sn;e>1e3&&(cn-=e,sn=t)}function mn(t){rn||(on&&(on=clearTimeout(on)),t-un>24?(t<1/0&&(on=setTimeout(gn,t-ln.now()-cn)),an&&(an=clearInterval(an))):(an||(sn=ln.now(),an=setInterval(En,1e3)),rn=1,hn(gn)))}pn.prototype=vn.prototype={constructor:pn,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?fn():+n)+(null==e?0:+e),this._next||en===this||(en?en._next=this:tn=this,en=this),this._call=t,this._time=n,mn()},stop:function(){this._call&&(this._call=null,this._time=1/0,mn())}};var yn=function(t,e,n){var r=new pn;return e=null==e?0:+e,r.restart((function(n){r.stop(),t(n+e)}),e,n),r},_n=nn("start","end","cancel","interrupt"),Nn=[],Tn=function(t,e,n,r,i,o){var a=t.__transition;if(a){if(n in a)return}else t.__transition={};!function(t,e,n){var r,i=t.__transition;function o(t){n.state=1,n.timer.restart(a,n.delay,n.time),n.delay<=t&&a(t-n.delay)}function a(o){var c,l,h,f;if(1!==n.state)return u();for(c in i)if((f=i[c]).name===n.name){if(3===f.state)return yn(a);4===f.state?(f.state=6,f.timer.stop(),f.on.call("interrupt",t,t.__data__,f.index,f.group),delete i[c]):+c<e&&(f.state=6,f.timer.stop(),f.on.call("cancel",t,t.__data__,f.index,f.group),delete i[c])}if(yn((function(){3===n.state&&(n.state=4,n.timer.restart(s,n.delay,n.time),s(o))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(h=n.tween.length),c=0,l=-1;c<h;++c)(f=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(r[++l]=f);r.length=l+1}}function s(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(u),n.state=5,1),o=-1,a=r.length;++o<a;)r[o].call(t,i);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),u())}function u(){for(var r in n.state=6,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=vn(o,0,n.time)}(t,n,{name:e,index:r,group:i,on:_n,tween:Nn,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})};function wn(t,e){var n=An(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function bn(t,e){var n=An(t,e);if(n.state>3)throw new Error("too late; already running");return n}function An(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}var Rn,On,Sn,In,Cn=180/Math.PI,Ln={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},Mn=function(t,e,n,r,i,o){var a,s,u;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(u=t*n+e*r)&&(n-=t*u,r-=e*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),t*r<e*n&&(t=-t,e=-e,u=-u,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*Cn,skewX:Math.atan(u)*Cn,scaleX:a,scaleY:s}};function xn(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(o,a){var s=[],u=[];return o=t(o),a=t(a),function(t,r,i,o,a,s){if(t!==i||r!==o){var u=a.push("translate(",null,e,null,n);s.push({i:u-4,x:Oe(t,i)},{i:u-2,x:Oe(r,o)})}else(i||o)&&a.push("translate("+i+e+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,s,u),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:Oe(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(o.rotate,a.rotate,s,u),function(t,e,n,o){t!==e?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:Oe(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(o.skewX,a.skewX,s,u),function(t,e,n,r,o,a){if(t!==n||e!==r){var s=o.push(i(o)+"scale(",null,",",null,")");a.push({i:s-4,x:Oe(t,n)},{i:s-2,x:Oe(e,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,s,u),o=a=null,function(t){for(var e,n=-1,r=u.length;++n<r;)s[(e=u[n]).i]=e.x(t);return s.join("")}}}var kn=xn((function(t){return"none"===t?Ln:(Rn||(Rn=document.createElement("DIV"),On=document.documentElement,Sn=document.defaultView),Rn.style.transform=t,t=Sn.getComputedStyle(On.appendChild(Rn),null).getPropertyValue("transform"),On.removeChild(Rn),t=t.slice(7,-1).split(","),Mn(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}),"px, ","px)","deg)"),Pn=xn((function(t){return null==t?Ln:(In||(In=document.createElementNS("http://www.w3.org/2000/svg","g")),In.setAttribute("transform",t),(t=In.transform.baseVal.consolidate())?(t=t.matrix,Mn(t.a,t.b,t.c,t.d,t.e,t.f)):Ln)}),", ",")",")");function Dn(t,e){var n,r;return function(){var i=bn(this,t),o=i.tween;if(o!==n)for(var a=0,s=(r=n=o).length;a<s;++a)if(r[a].name===e){(r=r.slice()).splice(a,1);break}i.tween=r}}function Un(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var o=bn(this,t),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:e,value:n},u=0,c=i.length;u<c;++u)if(i[u].name===e){i[u]=s;break}u===c&&i.push(s)}o.tween=i}}function jn(t,e,n){var r=t._id;return t.each((function(){var t=bn(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return An(t,r).value[e]}}var Gn=function(t,e){var n;return("number"==typeof e?Oe:e instanceof se?we:(n=se(e))?(e=n,we):Le)(t,e)};function Bn(t){return function(){this.removeAttribute(t)}}function Fn(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Hn(t,e,n){var r,i,o=n+"";return function(){var a=this.getAttribute(t);return a===o?null:a===r?i:i=e(r=a,n)}}function Vn(t,e,n){var r,i,o=n+"";return function(){var a=this.getAttributeNS(t.space,t.local);return a===o?null:a===r?i:i=e(r=a,n)}}function Wn(t,e,n){var r,i,o;return function(){var a,s,u=n(this);if(null!=u)return(a=this.getAttribute(t))===(s=u+"")?null:a===r&&s===i?o:(i=s,o=e(r=a,u));this.removeAttribute(t)}}function zn(t,e,n){var r,i,o;return function(){var a,s,u=n(this);if(null!=u)return(a=this.getAttributeNS(t.space,t.local))===(s=u+"")?null:a===r&&s===i?o:(i=s,o=e(r=a,u));this.removeAttributeNS(t.space,t.local)}}function Yn(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function $n(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Xn(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&$n(t,i)),n}return i._value=e,i}function qn(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&Yn(t,i)),n}return i._value=e,i}function Kn(t,e){return function(){wn(this,t).delay=+e.apply(this,arguments)}}function Qn(t,e){return e=+e,function(){wn(this,t).delay=e}}function Zn(t,e){return function(){bn(this,t).duration=+e.apply(this,arguments)}}function Jn(t,e){return e=+e,function(){bn(this,t).duration=e}}function tr(t,e){if("function"!=typeof e)throw new Error;return function(){bn(this,t).ease=e}}function er(t,e,n){var r,i,o=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?wn:bn;return function(){var a=o(this,t),s=a.on;s!==r&&(i=(r=s).copy()).on(e,n),a.on=i}}var nr=ht.prototype.constructor;function rr(t){return function(){this.style.removeProperty(t)}}function ir(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function or(t,e,n){var r,i;function o(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&ir(t,o,n)),r}return o._value=e,o}function ar(t){return function(e){this.textContent=t.call(this,e)}}function sr(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&ar(r)),e}return r._value=t,r}var ur=0;function cr(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function lr(){return++ur}var hr=ht.prototype;cr.prototype={constructor:cr,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=i(t));for(var r=this._groups,o=r.length,a=new Array(o),s=0;s<o;++s)for(var u,c,l=r[s],h=l.length,f=a[s]=new Array(h),d=0;d<h;++d)(u=l[d])&&(c=t.call(u,u.__data__,d,l))&&("__data__"in u&&(c.__data__=u.__data__),f[d]=c,Tn(f[d],e,n,d,f,An(u,n)));return new cr(a,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=a(t));for(var r=this._groups,i=r.length,o=[],s=[],u=0;u<i;++u)for(var c,l=r[u],h=l.length,f=0;f<h;++f)if(c=l[f]){for(var d,p=t.call(c,c.__data__,f,l),v=An(c,n),g=0,E=p.length;g<E;++g)(d=p[g])&&Tn(d,e,n,g,p,v);o.push(p),s.push(c)}return new cr(o,s,e,n)},filter:function(t){"function"!=typeof t&&(t=s(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a=e[i],u=a.length,c=r[i]=[],l=0;l<u;++l)(o=a[l])&&t.call(o,o.__data__,l,a)&&c.push(o);return new cr(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var u,c=e[s],l=n[s],h=c.length,f=a[s]=new Array(h),d=0;d<h;++d)(u=c[d]||l[d])&&(f[d]=u);for(;s<r;++s)a[s]=e[s];return new cr(a,this._parents,this._name,this._id)},selection:function(){return new nr(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=lr(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],u=s.length,c=0;c<u;++c)if(a=s[c]){var l=An(a,e);Tn(a,t,n,c,s,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new cr(r,this._parents,t,n)},call:hr.call,nodes:hr.nodes,node:hr.node,size:hr.size,empty:hr.empty,each:hr.each,on:function(t,e){var n=this._id;return arguments.length<2?An(this.node(),n).on.on(t):this.each(er(n,t,e))},attr:function(t,e){var n=v(t),r="transform"===n?Pn:Gn;return this.attrTween(t,"function"==typeof e?(n.local?zn:Wn)(n,r,jn(this,"attr."+t,e)):null==e?(n.local?Fn:Bn)(n):(n.local?Vn:Hn)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=v(t);return this.tween(n,(r.local?Xn:qn)(r,e))},style:function(t,e,n){var r="transform"==(t+="")?kn:Gn;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var o=R(this,t),a=(this.style.removeProperty(t),R(this,t));return o===a?null:o===n&&a===r?i:i=e(n=o,r=a)}}(t,r)).on("end.style."+t,rr(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var r,i,o;return function(){var a=R(this,t),s=n(this),u=s+"";return null==s&&(this.style.removeProperty(t),u=s=R(this,t)),a===u?null:a===r&&u===i?o:(i=u,o=e(r=a,s))}}(t,r,jn(this,"style."+t,e))).each(function(t,e){var n,r,i,o,a="style."+e,s="end."+a;return function(){var u=bn(this,t),c=u.on,l=null==u.value[a]?o||(o=rr(e)):void 0;c===n&&i===l||(r=(n=c).copy()).on(s,i=l),u.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,i,o=n+"";return function(){var a=R(this,t);return a===o?null:a===r?i:i=e(r=a,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,or(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(jn(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,sr(t))},remove:function(){return this.on("end.remove",(t=this._id,function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}));var t},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=An(this.node(),n).tween,o=0,a=i.length;o<a;++o)if((r=i[o]).name===t)return r.value;return null}return this.each((null==e?Dn:Un)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Kn:Qn)(e,t)):An(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Zn:Jn)(e,t)):An(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(tr(e,t)):An(this.node(),e).ease},end:function(){var t,e,n=this,r=n._id,i=n.size();return new Promise((function(o,a){var s={value:a},u={value:function(){0==--i&&o()}};n.each((function(){var n=bn(this,r),i=n.on;i!==t&&((e=(t=i).copy())._.cancel.push(s),e._.interrupt.push(s),e._.end.push(u)),n.on=e}))}))}};var fr={time:null,delay:0,duration:250,ease:$e};function dr(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return fr.time=fn(),fr;return n}ht.prototype.interrupt=function(t){return this.each((function(){!function(t,e){var n,r,i,o=t.__transition,a=!0;if(o){for(i in e=null==e?null:e+"",o)(n=o[i]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete o[i]):a=!1;a&&delete t.__transition}}(this,t)}))},ht.prototype.transition=function(t){var e,n;t instanceof cr?(e=t._id,t=t._name):(e=lr(),(n=fr).time=fn(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],u=s.length,c=0;c<u;++c)(a=s[c])&&Tn(a,t,e,c,s,n||dr(a,e));return new cr(r,this._parents,t,e)},e.default=function(){var t=960,e=null,n=18,r=null,i=null,o="",a=750,s=$e,u=!1,c=!1,l=null,h=0,f=null,d=!1,p=!1,v=!1,g=0,E=0,m=0,y=!1,_=!1,N=null,T=function(t){return t.data.n||t.data.name},w=function(t){return"v"in t?t.v:t.value},b=function(t){return t.c||t.children},A=function(t){return t.data.l||t.data.libtype},R=function(t){return"d"in t.data?t.data.d:t.data.delta},O=function(){f&&P()},S=O;let I=(t,e)=>{if(!e)return!1;const n=new RegExp(e),r=T(t);return void 0!==r&&r&&r.match(n)};const C=I;var L,M=function(t){f&&(t?f.innerHTML=t:g?P():f.innerHTML="")},x=M,k=function(t){return T(t)+" ("+_t(".3f")(100*(t.x1-t.x0),3)+"%, "+w(t)+" samples)"};function P(){f.innerHTML=g+" of "+E+" samples ( "+_t(".3f")(g/E*100,3)+"%)"}var D=function(t){return t.highlight?"#E600E6":function(t,e,n){var r,i,o;if(p)r=220,i=220,o=220,n||(n=0),n>0?i=o=Math.round(210*(m-n)/m):n<0&&(i=r=Math.round(210*(m+n)/m));else{var a=v?"cold":"warm";v||void 0===e||""===e||(a="red",void 0!==t&&t&&t.match(/::/)&&(a="yellow"),"kernel"===e?a="orange":"jit"===e?a="green":"inlined"===e&&(a="aqua"));var s=0;if(t){var u=t.split("`");u.length>1&&(t=u[u.length-1]),s=function(t){const e=6;var n=0,r=0,i=1,o=10;if(t){for(var a=0;a<t.length&&!(a>e);a++)n+=i*(t.charCodeAt(a)%o),r+=i*(o-1),i*=.7;r>0&&(n/=r)}return n}(t=t.split("(")[0])}"red"===a?(r=200+Math.round(55*s),o=i=50+Math.round(80*s)):"orange"===a?(r=190+Math.round(65*s),i=90+Math.round(65*s),o=0):"yellow"===a?(i=r=175+Math.round(55*s),o=50+Math.round(20*s)):"green"===a?(r=50+Math.round(60*s),i=200+Math.round(55*s),o=r):"aqua"===a?(r=50+Math.round(60*s),o=i=165+Math.round(55*s)):"cold"===a?(r=0+Math.round(55*(1-s)),i=0+Math.round(230*(1-s)),o=200+Math.round(55*s)):(r=200+Math.round(55*s),i=0+Math.round(230*(1-s)),o=0+Math.round(55*(1-s)))}return"rgb("+r+","+i+","+o+")"}(T(t),A(t),R(t))},U=D;function j(t){t.data.fade=!1,t.data.hide=!1,t.children&&t.children.forEach(j)}function G(t){t.parent&&(t.parent.data.fade=!0,G(t.parent))}function B(t){if(i&&i.hide(),function(t){let e,n,r,i=t,o=i.parent;for(;o;){for(e=o.children,n=e.length;n--;)r=e[n],r!==i&&(r.data.hide=!0);i=o,o=i.parent}}(t),j(t),G(t),z(),_){const e=L._groups[0][0].parentNode.offsetTop,r=(window.innerHeight-e)/n,i=(t.height-r+10)*n;window.scrollTo({top:e+i,left:0,behavior:"smooth"})}"function"==typeof l&&l(t)}function F(t,e){if(t.id===e)return t;var n=b(t);if(n)for(var r=0;r<n.length;r++){var i=F(n[r],e);if(i)return i}}function H(t){t.highlight=!1,b(t)&&b(t).forEach((function(t){H(t)}))}function V(t,e){return"function"==typeof u?u(t,e):u?Ot(T(t),T(e)):void 0}var W=It();function z(){r.each((function(r){var o=Ye().range([0,t]),l=Ye().range([0,n]);!function(t){let e,n,r,i,o,a,s,u;const c=[],l=[],h=[],f=!d;let p=t.data;for(p.hide?(t.value=0,n=t.children,n&&h.push(n)):(t.value=p.fade?0:w(p),c.push(t));e=c.pop();)if(n=e.children,n&&(o=n.length)){for(i=0;o--;)s=n[o],p=s.data,p.hide?(s.value=0,r=s.children,r&&h.push(r)):(p.fade?s.value=0:(u=w(p),s.value=u,i+=u),c.push(s));f&&e.value&&(e.value-=i),l.push(n)}for(o=l.length;o--;){for(n=l[o],i=0,a=n.length;a--;)i+=n[a].value;n[0].parent.value+=i}for(;h.length;)for(n=h.pop(),a=n.length;a--;)s=n[a],s.value=0,r=s.children,r&&h.push(r)}(r),E=r.value,u&&r.sort(V),W(r);var f=t/(r.x1-r.x0);function p(t){return(t.x1-t.x0)*f}var v=function(e){var n=e.descendants();if(h>0){var r=t/(e.x1-e.x0);n=n.filter((function(t){return(t.x1-t.x0)*r>h}))}return n}(r),g=ft(this).select("svg").selectAll("g").data(v,(function(t){return t.id}));if(!e||y){var m=Math.max.apply(null,v.map((function(t){return t.depth})));(e=(m+3)*n)<N&&(e=N),ft(this).select("svg").attr("height",e)}g.transition().duration(a).ease(s).attr("transform",(function(t){return"translate("+o(t.x0)+","+(c?l(t.depth):e-l(t.depth)-n)+")"})),g.select("rect").transition().duration(a).ease(s).attr("width",p);var _=g.enter().append("svg:g").attr("transform",(function(t){return"translate("+o(t.x0)+","+(c?l(t.depth):e-l(t.depth)-n)+")"}));_.append("svg:rect").transition().delay(a/2).attr("width",p),i||_.append("svg:title"),_.append("foreignObject").append("xhtml:div"),(g=ft(this).select("svg").selectAll("g").data(v,(function(t){return t.id}))).attr("width",p).attr("height",(function(t){return n})).attr("name",(function(t){return T(t)})).attr("class",(function(t){return t.data.fade?"frame fade":"frame"})),g.select("rect").attr("height",(function(t){return n})).attr("fill",(function(t){return D(t)})),i||g.select("title").text(k),g.select("foreignObject").attr("width",p).attr("height",(function(t){return n})).select("div").attr("class","d3-flame-graph-label").style("display",(function(t){return p(t)<35?"none":"block"})).transition().delay(a).text(T),g.on("click",B),g.exit().remove(),g.on("mouseover",(function(t){i&&i.show(t,this),M(k(t))})).on("mouseout",(function(){i&&i.hide(),M(null)}))}))}function Y(t,e){e.forEach((function(e){var n=t.find((function(t){return t.name===e.name}));n?(n.original?n.original+=e.value:n.value+=e.value,e.children&&(n.children||(n.children=[]),Y(n.children,e.children))):t.push(e)}))}function $(t){m=0;let e=0,n=0;const r=p;!function(t,e){e(t);let n=t.children;if(n){const t=[n];let r,i,o;for(;t.length;)for(n=t.pop(),r=n.length;r--;)i=n[r],e(i),o=i.children,o&&t.push(o)}}(t,(function(t){t.id=e++,r&&(n=Math.abs(R(t)),m<n&&(m=n))}))}function X(n){const a=Lt(n.datum(),b);if($(a),r=n.datum(a),!arguments.length)return X;r.each((function(n){L||(L=ft(this).append("svg:svg").attr("width",t).attr("class","partition d3-flame-graph"),e&&(e<N&&(e=N),L.attr("height",e)),L.append("svg:text").attr("class","title").attr("text-anchor","middle").attr("y","25").attr("x",t/2).attr("fill","#808080").text(o),i&&L.call(i))})),z()}return X.height=function(t){return arguments.length?(e=t,X):e},X.minHeight=function(t){return arguments.length?(N=t,X):N},X.width=function(e){return arguments.length?(t=e,X):t},X.cellHeight=function(t){return arguments.length?(n=t,X):n},X.tooltip=function(t){return arguments.length?("function"==typeof t&&(i=t),X):i},X.title=function(t){return arguments.length?(o=t,X):o},X.transitionDuration=function(t){return arguments.length?(a=t,X):a},X.transitionEase=function(t){return arguments.length?(s=t,X):s},X.sort=function(t){return arguments.length?(u=t,X):u},X.inverted=function(t){return arguments.length?(c=t,X):c},X.differential=function(t){return arguments.length?(p=t,X):p},X.elided=function(t){return arguments.length?(v=t,X):v},X.setLabelHandler=function(t){return arguments.length?(k=t,X):k},X.label=X.setLabelHandler,X.search=function(t){r.each((function(e){!function(t,e){var n=[],r=0;!function t(i,o){var a=!1;I(i,e)?(i.highlight=!0,a=!0,o||(r+=w(i)),n.push(i)):i.highlight=!1,b(i)&&b(i).forEach((function(e){t(e,o||a)}))}(t,!1),g=r,O(n,r,E)}(e,t),z()}))},X.findById=function(t){if(null==t)return null;let e=null;return r.each((function(n){null===e&&(e=F(n,t))})),e},X.clear=function(){g=0,M(null),r.each((function(t){H(t),z()}))},X.zoomTo=function(t){B(t)},X.resetZoom=function(){r.each((function(t){B(t)}))},X.onClick=function(t){return arguments.length?(l=t,X):l},X.merge=function(t){return r?(r.each((function(n){Y([n.data],[t]),$(e=Lt(n.data,b))})),r=r.datum(e),z(),X):X;var e},X.update=function(t){return r?(r.each((function(n){n.data=t,$(e=Lt(n.data,b))})),r=r.datum(e),z(),X):X;var e},X.destroy=function(){return r?(i&&i.hide(),r.selectAll("svg").remove(),X):X},X.setColorMapper=function(t){return arguments.length?(D=e=>{const n=U(e);return t(e,n)},X):(D=U,X)},X.color=X.setColorMapper,X.minFrameSize=function(t){return arguments.length?(h=t,X):h},X.setDetailsElement=function(t){return arguments.length?(f=t,X):f},X.details=X.setDetailsElement,X.selfValue=function(t){return arguments.length?(d=t,X):d},X.resetHeightOnZoom=function(t){return arguments.length?(y=t,X):y},X.scrollOnZoom=function(t){return arguments.length?(_=t,X):_},X.getName=function(t){return arguments.length?(T=t,X):T},X.getValue=function(t){return arguments.length?(w=t,X):w},X.getChildren=function(t){return arguments.length?(b=t,X):b},X.getLibtype=function(t){return arguments.length?(A=t,X):A},X.getDelta=function(t){return arguments.length?(R=t,X):R},X.setSearchHandler=function(t){return arguments.length?(O=t,X):(O=S,X)},X.setDetailsHandler=function(t){return arguments.length?(M=t,X):(M=x,X)},X.setSearchMatch=function(t){return arguments.length?(I=t,X):(I=C,X)},X}}}).default},t.exports=n()})));O((function(t,e){var n;window,n=function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=6)}({6:function(t,e,n){function r(t){return t.highlight?"rgb(230, 0, 230)":`rgb(${function(t,e,n){const r=n,i=1-r;return[Math.round(t[0]*r+e[0]*i),Math.round(t[1]*r+e[1]*i),Math.round(t[2]*r+e[2]*i)]}([0,255,40],[196,245,233],t.data.value/t.value).join()})`}function i(t){if(t.highlight)return"#E600E6";let e=t.data.n||t.data.name,n=0;const r=e.split("`");return r.length>1&&(e=r[r.length-1]),e=e.split("(")[0],n=function(t){var e=0,n=0,r=1;if(t){for(var i=0;i<t.length&&!(i>6);i++)e+=r*(t.charCodeAt(i)%10),n+=9*r,r*=.7;n>0&&(e/=n)}return e}(e),"rgb("+(0+Math.round(55*(1-n)))+","+(0+Math.round(230*(1-n)))+","+(200+Math.round(55*n))+")"}function o(t,e){let n=e;const{v8_jit:r,javascript:i,optimized:o}=t.data.extras||{};if(r&&!i&&(n="#dadada"),i){let e=(o||0)/t.value,r=255,i=0,a=0;e<.4?(e*=2.5,r=240-200*e):e<.9?(e=2*(e-.4),r=0,a=200-200*e,i=100*e):(e=10*(e-.9),r=0,a=0,i=100+150*e),n=`rgb(${r} , ${i}, ${a})`}return n}n.r(e),n.d(e,"allocationColorMapper",(function(){return r})),n.d(e,"offCpuColorMapper",(function(){return i})),n.d(e,"nodeJsColorMapper",(function(){return o}))}})},t.exports=n()})),O((function(t,e){var n;window,n=function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=7)}({7:function(t,e,n){function r(){}n.r(e),n.d(e,"defaultFlamegraphTooltip",(function(){return mn}));var i=function(t){return null==t?r:function(){return this.querySelector(t)}};function o(){return[]}var a=function(t){return null==t?o:function(){return this.querySelectorAll(t)}},s=function(t){return function(){return this.matches(t)}},u=function(t){return new Array(t.length)};function c(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function l(t,e,n,r,i,o){for(var a,s=0,u=e.length,l=o.length;s<l;++s)(a=e[s])?(a.__data__=o[s],r[s]=a):n[s]=new c(t,o[s]);for(;s<u;++s)(a=e[s])&&(i[s]=a)}function h(t,e,n,r,i,o,a){var s,u,l,h={},f=e.length,d=o.length,p=new Array(f);for(s=0;s<f;++s)(u=e[s])&&(p[s]=l="$"+a.call(u,u.__data__,s,e),l in h?i[s]=u:h[l]=u);for(s=0;s<d;++s)(u=h[l="$"+a.call(t,o[s],s,o)])?(r[s]=u,u.__data__=o[s],h[l]=null):n[s]=new c(t,o[s]);for(s=0;s<f;++s)(u=e[s])&&h[p[s]]===u&&(i[s]=u)}function f(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}c.prototype={constructor:c,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var d="http://www.w3.org/1999/xhtml",p={svg:"http://www.w3.org/2000/svg",xhtml:d,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},v=function(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),p.hasOwnProperty(e)?{space:p[e],local:t}:t};function g(t){return function(){this.removeAttribute(t)}}function E(t){return function(){this.removeAttributeNS(t.space,t.local)}}function m(t,e){return function(){this.setAttribute(t,e)}}function y(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function _(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function N(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}var T=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView};function w(t){return function(){this.style.removeProperty(t)}}function b(t,e,n){return function(){this.style.setProperty(t,e,n)}}function A(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function R(t,e){return t.style.getPropertyValue(e)||T(t).getComputedStyle(t,null).getPropertyValue(e)}function O(t){return function(){delete this[t]}}function S(t,e){return function(){this[t]=e}}function I(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function C(t){return t.trim().split(/^|\s+/)}function L(t){return t.classList||new M(t)}function M(t){this._node=t,this._names=C(t.getAttribute("class")||"")}function x(t,e){for(var n=L(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function k(t,e){for(var n=L(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function P(t){return function(){x(this,t)}}function D(t){return function(){k(this,t)}}function U(t,e){return function(){(e.apply(this,arguments)?x:k)(this,t)}}function j(){this.textContent=""}function G(t){return function(){this.textContent=t}}function B(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function F(){this.innerHTML=""}function H(t){return function(){this.innerHTML=t}}function V(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function W(){this.nextSibling&&this.parentNode.appendChild(this)}function z(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Y(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===d&&e.documentElement.namespaceURI===d?e.createElement(t):e.createElementNS(n,t)}}function $(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}M.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var X=function(t){var e=v(t);return(e.local?$:Y)(e)};function q(){return null}function K(){var t=this.parentNode;t&&t.removeChild(this)}function Q(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Z(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}var J={};function tt(t,e,n){return t=et(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function et(t,e,n){return function(r){try{t.call(this,this.__data__,e,n)}finally{}}}function nt(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function rt(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,o=e.length;r<o;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?e.length=i:delete this.__on}}}function it(t,e,n){var r=J.hasOwnProperty(t.type)?tt:et;return function(i,o,a){var s,u=this.__on,c=r(e,o,a);if(u)for(var l=0,h=u.length;l<h;++l)if((s=u[l]).type===t.type&&s.name===t.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=c,s.capture=n),void(s.value=e);this.addEventListener(t.type,c,n),s={type:t.type,name:t.name,value:e,listener:c,capture:n},u?u.push(s):this.__on=[s]}}function ot(t,e,n){var r=T(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function at(t,e){return function(){return ot(this,t,e)}}function st(t,e){return function(){return ot(this,t,e.apply(this,arguments))}}"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(J={mouseenter:"mouseover",mouseleave:"mouseout"}));var ut=[null];function ct(t,e){this._groups=t,this._parents=e}function lt(){return new ct([[document.documentElement]],ut)}ct.prototype=lt.prototype={constructor:ct,select:function(t){"function"!=typeof t&&(t=i(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var a,s,u=e[o],c=u.length,l=r[o]=new Array(c),h=0;h<c;++h)(a=u[h])&&(s=t.call(a,a.__data__,h,u))&&("__data__"in a&&(s.__data__=a.__data__),l[h]=s);return new ct(r,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=a(t));for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var s,u=e[o],c=u.length,l=0;l<c;++l)(s=u[l])&&(r.push(t.call(s,s.__data__,l,u)),i.push(s));return new ct(r,i)},filter:function(t){"function"!=typeof t&&(t=s(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a=e[i],u=a.length,c=r[i]=[],l=0;l<u;++l)(o=a[l])&&t.call(o,o.__data__,l,a)&&c.push(o);return new ct(r,this._parents)},data:function(t,e){if(!t)return g=new Array(this.size()),f=-1,this.each((function(t){g[++f]=t})),g;var n,r=e?h:l,i=this._parents,o=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var a=o.length,s=new Array(a),u=new Array(a),c=new Array(a),f=0;f<a;++f){var d=i[f],p=o[f],v=p.length,g=t.call(d,d&&d.__data__,f,i),E=g.length,m=u[f]=new Array(E),y=s[f]=new Array(E);r(d,p,m,y,c[f]=new Array(v),g,e);for(var _,N,T=0,w=0;T<E;++T)if(_=m[T]){for(T>=w&&(w=T+1);!(N=y[w])&&++w<E;);_._next=N||null}}return(s=new ct(s,i))._enter=u,s._exit=c,s},enter:function(){return new ct(this._enter||this._groups.map(u),this._parents)},exit:function(){return new ct(this._exit||this._groups.map(u),this._parents)},join:function(t,e,n){var r=this.enter(),i=this,o=this.exit();return r="function"==typeof t?t(r):r.append(t+""),null!=e&&(i=e(i)),null==n?o.remove():n(o),r&&i?r.merge(i).order():i},merge:function(t){for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var u,c=e[s],l=n[s],h=c.length,f=a[s]=new Array(h),d=0;d<h;++d)(u=c[d]||l[d])&&(f[d]=u);for(;s<r;++s)a[s]=e[s];return new ct(a,this._parents)},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=f);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a,s=n[o],u=s.length,c=i[o]=new Array(u),l=0;l<u;++l)(a=s[l])&&(c[l]=a);c.sort(e)}return new ct(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each((function(){t[++e]=this})),t},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){var t=0;return this.each((function(){++t})),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,o=e[n],a=0,s=o.length;a<s;++a)(i=o[a])&&t.call(i,i.__data__,a,o);return this},attr:function(t,e){var n=v(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?E:g:"function"==typeof e?n.local?N:_:n.local?y:m)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?w:"function"==typeof e?A:b)(t,e,null==n?"":n)):R(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?O:"function"==typeof e?I:S)(t,e)):this.node()[t]},classed:function(t,e){var n=C(t+"");if(arguments.length<2){for(var r=L(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?U:e?P:D)(n,e))},text:function(t){return arguments.length?this.each(null==t?j:("function"==typeof t?B:G)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?F:("function"==typeof t?V:H)(t)):this.node().innerHTML},raise:function(){return this.each(W)},lower:function(){return this.each(z)},append:function(t){var e="function"==typeof t?t:X(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:X(t),r=null==e?q:"function"==typeof e?e:i(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(K)},clone:function(t){return this.select(t?Z:Q)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,o=nt(t+""),a=o.length;if(!(arguments.length<2)){for(s=e?it:rt,null==n&&(n=!1),r=0;r<a;++r)this.each(s(o[r],e,n));return this}var s=this.node().__on;if(s)for(var u,c=0,l=s.length;c<l;++c)for(r=0,u=s[c];r<a;++r)if((i=o[r]).type===u.type&&i.name===u.name)return u.value},dispatch:function(t,e){return this.each(("function"==typeof e?st:at)(t,e))}};var ht=lt,ft={value:function(){}};function dt(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new pt(r)}function pt(t){this._=t}function vt(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function gt(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function Et(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=ft,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}pt.prototype=dt.prototype={constructor:pt,on:function(t,e){var n,r=this._,i=vt(t+"",r),o=-1,a=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<a;)if(n=(t=i[o]).type)r[n]=Et(r[n],t.name,e);else if(null==e)for(n in r)r[n]=Et(r[n],t.name,null);return this}for(;++o<a;)if((n=(t=i[o]).type)&&(n=gt(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new pt(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};var mt,yt,_t=dt,Nt=0,Tt=0,wt=0,bt=0,At=0,Rt=0,Ot="object"==typeof performance&&performance.now?performance:Date,St="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function It(){return At||(St(Ct),At=Ot.now()+Rt)}function Ct(){At=0}function Lt(){this._call=this._time=this._next=null}function Mt(t,e,n){var r=new Lt;return r.restart(t,e,n),r}function xt(){At=(bt=Ot.now())+Rt,Nt=Tt=0;try{!function(){It(),++Nt;for(var t,e=mt;e;)(t=At-e._time)>=0&&e._call.call(null,t),e=e._next;--Nt}()}finally{Nt=0,function(){for(var t,e,n=mt,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:mt=e);yt=t,Pt(r)}(),At=0}}function kt(){var t=Ot.now(),e=t-bt;e>1e3&&(Rt-=e,bt=t)}function Pt(t){Nt||(Tt&&(Tt=clearTimeout(Tt)),t-At>24?(t<1/0&&(Tt=setTimeout(xt,t-Ot.now()-Rt)),wt&&(wt=clearInterval(wt))):(wt||(bt=Ot.now(),wt=setInterval(kt,1e3)),Nt=1,St(xt)))}Lt.prototype=Mt.prototype={constructor:Lt,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?It():+n)+(null==e?0:+e),this._next||yt===this||(yt?yt._next=this:mt=this,yt=this),this._call=t,this._time=n,Pt()},stop:function(){this._call&&(this._call=null,this._time=1/0,Pt())}};var Dt=function(t,e,n){var r=new Lt;return e=null==e?0:+e,r.restart((function(n){r.stop(),t(n+e)}),e,n),r},Ut=_t("start","end","cancel","interrupt"),jt=[],Gt=function(t,e,n,r,i,o){var a=t.__transition;if(a){if(n in a)return}else t.__transition={};!function(t,e,n){var r,i=t.__transition;function o(t){n.state=1,n.timer.restart(a,n.delay,n.time),n.delay<=t&&a(t-n.delay)}function a(o){var c,l,h,f;if(1!==n.state)return u();for(c in i)if((f=i[c]).name===n.name){if(3===f.state)return Dt(a);4===f.state?(f.state=6,f.timer.stop(),f.on.call("interrupt",t,t.__data__,f.index,f.group),delete i[c]):+c<e&&(f.state=6,f.timer.stop(),f.on.call("cancel",t,t.__data__,f.index,f.group),delete i[c])}if(Dt((function(){3===n.state&&(n.state=4,n.timer.restart(s,n.delay,n.time),s(o))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(h=n.tween.length),c=0,l=-1;c<h;++c)(f=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(r[++l]=f);r.length=l+1}}function s(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(u),n.state=5,1),o=-1,a=r.length;++o<a;)r[o].call(t,i);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),u())}function u(){for(var r in n.state=6,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=Mt(o,0,n.time)}(t,n,{name:e,index:r,group:i,on:Ut,tween:jt,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})};function Bt(t,e){var n=Ht(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function Ft(t,e){var n=Ht(t,e);if(n.state>3)throw new Error("too late; already running");return n}function Ht(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}var Vt,Wt,zt,Yt,$t=function(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}},Xt=180/Math.PI,qt={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},Kt=function(t,e,n,r,i,o){var a,s,u;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(u=t*n+e*r)&&(n-=t*u,r-=e*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),t*r<e*n&&(t=-t,e=-e,u=-u,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*Xt,skewX:Math.atan(u)*Xt,scaleX:a,scaleY:s}};function Qt(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(o,a){var s=[],u=[];return o=t(o),a=t(a),function(t,r,i,o,a,s){if(t!==i||r!==o){var u=a.push("translate(",null,e,null,n);s.push({i:u-4,x:$t(t,i)},{i:u-2,x:$t(r,o)})}else(i||o)&&a.push("translate("+i+e+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,s,u),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:$t(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(o.rotate,a.rotate,s,u),function(t,e,n,o){t!==e?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:$t(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(o.skewX,a.skewX,s,u),function(t,e,n,r,o,a){if(t!==n||e!==r){var s=o.push(i(o)+"scale(",null,",",null,")");a.push({i:s-4,x:$t(t,n)},{i:s-2,x:$t(e,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,s,u),o=a=null,function(t){for(var e,n=-1,r=u.length;++n<r;)s[(e=u[n]).i]=e.x(t);return s.join("")}}}var Zt=Qt((function(t){return"none"===t?qt:(Vt||(Vt=document.createElement("DIV"),Wt=document.documentElement,zt=document.defaultView),Vt.style.transform=t,t=zt.getComputedStyle(Wt.appendChild(Vt),null).getPropertyValue("transform"),Wt.removeChild(Vt),t=t.slice(7,-1).split(","),Kt(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}),"px, ","px)","deg)"),Jt=Qt((function(t){return null==t?qt:(Yt||(Yt=document.createElementNS("http://www.w3.org/2000/svg","g")),Yt.setAttribute("transform",t),(t=Yt.transform.baseVal.consolidate())?(t=t.matrix,Kt(t.a,t.b,t.c,t.d,t.e,t.f)):qt)}),", ",")",")");function te(t,e){var n,r;return function(){var i=Ft(this,t),o=i.tween;if(o!==n)for(var a=0,s=(r=n=o).length;a<s;++a)if(r[a].name===e){(r=r.slice()).splice(a,1);break}i.tween=r}}function ee(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var o=Ft(this,t),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:e,value:n},u=0,c=i.length;u<c;++u)if(i[u].name===e){i[u]=s;break}u===c&&i.push(s)}o.tween=i}}function ne(t,e,n){var r=t._id;return t.each((function(){var t=Ft(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return Ht(t,r).value[e]}}var re=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t};function ie(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function oe(){}var ae=.7,se=1/ae,ue="\\s*([+-]?\\d+)\\s*",ce="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",le="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",he=/^#([0-9a-f]{3,8})$/,fe=new RegExp("^rgb\\("+[ue,ue,ue]+"\\)$"),de=new RegExp("^rgb\\("+[le,le,le]+"\\)$"),pe=new RegExp("^rgba\\("+[ue,ue,ue,ce]+"\\)$"),ve=new RegExp("^rgba\\("+[le,le,le,ce]+"\\)$"),ge=new RegExp("^hsl\\("+[ce,le,le]+"\\)$"),Ee=new RegExp("^hsla\\("+[ce,le,le,ce]+"\\)$"),me={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function ye(){return this.rgb().formatHex()}function _e(){return this.rgb().formatRgb()}function Ne(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=he.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Te(e):3===n?new Re(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?new Re(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?new Re(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=fe.exec(t))?new Re(e[1],e[2],e[3],1):(e=de.exec(t))?new Re(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=pe.exec(t))?we(e[1],e[2],e[3],e[4]):(e=ve.exec(t))?we(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=ge.exec(t))?Ce(e[1],e[2]/100,e[3]/100,1):(e=Ee.exec(t))?Ce(e[1],e[2]/100,e[3]/100,e[4]):me.hasOwnProperty(t)?Te(me[t]):"transparent"===t?new Re(NaN,NaN,NaN,0):null}function Te(t){return new Re(t>>16&255,t>>8&255,255&t,1)}function we(t,e,n,r){return r<=0&&(t=e=n=NaN),new Re(t,e,n,r)}function be(t){return t instanceof oe||(t=Ne(t)),t?new Re((t=t.rgb()).r,t.g,t.b,t.opacity):new Re}function Ae(t,e,n,r){return 1===arguments.length?be(t):new Re(t,e,n,null==r?1:r)}function Re(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function Oe(){return"#"+Ie(this.r)+Ie(this.g)+Ie(this.b)}function Se(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function Ie(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Ce(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Me(t,e,n,r)}function Le(t){if(t instanceof Me)return new Me(t.h,t.s,t.l,t.opacity);if(t instanceof oe||(t=Ne(t)),!t)return new Me;if(t instanceof Me)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(a=e===o?(n-r)/s+6*(n<r):n===o?(r-e)/s+2:(e-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new Me(a,s,u,t.opacity)}function Me(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function xe(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}re(oe,Ne,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:ye,formatHex:ye,formatHsl:function(){return Le(this).formatHsl()},formatRgb:_e,toString:_e}),re(Re,Ae,ie(oe,{brighter:function(t){return t=null==t?se:Math.pow(se,t),new Re(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?ae:Math.pow(ae,t),new Re(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Oe,formatHex:Oe,formatRgb:Se,toString:Se})),re(Me,(function(t,e,n,r){return 1===arguments.length?Le(t):new Me(t,e,n,null==r?1:r)}),ie(oe,{brighter:function(t){return t=null==t?se:Math.pow(se,t),new Me(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?ae:Math.pow(ae,t),new Me(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Re(xe(t>=240?t-240:t+120,i,r),xe(t,i,r),xe(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var ke=function(t){return function(){return t}};function Pe(t){return 1==(t=+t)?De:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):ke(isNaN(e)?n:e)}}function De(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):ke(isNaN(t)?e:t)}var Ue=function t(e){var n=Pe(e);function r(t,e){var r=n((t=Ae(t)).r,(e=Ae(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),a=De(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=a(e),t+""}}return r.gamma=t,r}(1),je=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ge=new RegExp(je.source,"g"),Be=function(t,e){var n,r,i,o=je.lastIndex=Ge.lastIndex=0,a=-1,s=[],u=[];for(t+="",e+="";(n=je.exec(t))&&(r=Ge.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,u.push({i:a,x:$t(n,r)})),o=Ge.lastIndex;return o<e.length&&(i=e.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?u[0]?function(t){return function(e){return t(e)+""}}(u[0].x):function(t){return function(){return t}}(e):(e=u.length,function(t){for(var n,r=0;r<e;++r)s[(n=u[r]).i]=n.x(t);return s.join("")})},Fe=function(t,e){var n;return("number"==typeof e?$t:e instanceof Ne?Ue:(n=Ne(e))?(e=n,Ue):Be)(t,e)};function He(t){return function(){this.removeAttribute(t)}}function Ve(t){return function(){this.removeAttributeNS(t.space,t.local)}}function We(t,e,n){var r,i,o=n+"";return function(){var a=this.getAttribute(t);return a===o?null:a===r?i:i=e(r=a,n)}}function ze(t,e,n){var r,i,o=n+"";return function(){var a=this.getAttributeNS(t.space,t.local);return a===o?null:a===r?i:i=e(r=a,n)}}function Ye(t,e,n){var r,i,o;return function(){var a,s,u=n(this);if(null!=u)return(a=this.getAttribute(t))===(s=u+"")?null:a===r&&s===i?o:(i=s,o=e(r=a,u));this.removeAttribute(t)}}function $e(t,e,n){var r,i,o;return function(){var a,s,u=n(this);if(null!=u)return(a=this.getAttributeNS(t.space,t.local))===(s=u+"")?null:a===r&&s===i?o:(i=s,o=e(r=a,u));this.removeAttributeNS(t.space,t.local)}}function Xe(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function qe(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Ke(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&qe(t,i)),n}return i._value=e,i}function Qe(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&Xe(t,i)),n}return i._value=e,i}function Ze(t,e){return function(){Bt(this,t).delay=+e.apply(this,arguments)}}function Je(t,e){return e=+e,function(){Bt(this,t).delay=e}}function tn(t,e){return function(){Ft(this,t).duration=+e.apply(this,arguments)}}function en(t,e){return e=+e,function(){Ft(this,t).duration=e}}function nn(t,e){if("function"!=typeof e)throw new Error;return function(){Ft(this,t).ease=e}}function rn(t,e,n){var r,i,o=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?Bt:Ft;return function(){var a=o(this,t),s=a.on;s!==r&&(i=(r=s).copy()).on(e,n),a.on=i}}var on=ht.prototype.constructor;function an(t){return function(){this.style.removeProperty(t)}}function sn(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function un(t,e,n){var r,i;function o(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&sn(t,o,n)),r}return o._value=e,o}function cn(t){return function(e){this.textContent=t.call(this,e)}}function ln(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&cn(r)),e}return r._value=t,r}var hn=0;function fn(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function dn(){return++hn}var pn=ht.prototype;fn.prototype={constructor:fn,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=i(t));for(var r=this._groups,o=r.length,a=new Array(o),s=0;s<o;++s)for(var u,c,l=r[s],h=l.length,f=a[s]=new Array(h),d=0;d<h;++d)(u=l[d])&&(c=t.call(u,u.__data__,d,l))&&("__data__"in u&&(c.__data__=u.__data__),f[d]=c,Gt(f[d],e,n,d,f,Ht(u,n)));return new fn(a,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=a(t));for(var r=this._groups,i=r.length,o=[],s=[],u=0;u<i;++u)for(var c,l=r[u],h=l.length,f=0;f<h;++f)if(c=l[f]){for(var d,p=t.call(c,c.__data__,f,l),v=Ht(c,n),g=0,E=p.length;g<E;++g)(d=p[g])&&Gt(d,e,n,g,p,v);o.push(p),s.push(c)}return new fn(o,s,e,n)},filter:function(t){"function"!=typeof t&&(t=s(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a=e[i],u=a.length,c=r[i]=[],l=0;l<u;++l)(o=a[l])&&t.call(o,o.__data__,l,a)&&c.push(o);return new fn(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var u,c=e[s],l=n[s],h=c.length,f=a[s]=new Array(h),d=0;d<h;++d)(u=c[d]||l[d])&&(f[d]=u);for(;s<r;++s)a[s]=e[s];return new fn(a,this._parents,this._name,this._id)},selection:function(){return new on(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=dn(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],u=s.length,c=0;c<u;++c)if(a=s[c]){var l=Ht(a,e);Gt(a,t,n,c,s,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new fn(r,this._parents,t,n)},call:pn.call,nodes:pn.nodes,node:pn.node,size:pn.size,empty:pn.empty,each:pn.each,on:function(t,e){var n=this._id;return arguments.length<2?Ht(this.node(),n).on.on(t):this.each(rn(n,t,e))},attr:function(t,e){var n=v(t),r="transform"===n?Jt:Fe;return this.attrTween(t,"function"==typeof e?(n.local?$e:Ye)(n,r,ne(this,"attr."+t,e)):null==e?(n.local?Ve:He)(n):(n.local?ze:We)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=v(t);return this.tween(n,(r.local?Ke:Qe)(r,e))},style:function(t,e,n){var r="transform"==(t+="")?Zt:Fe;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var o=R(this,t),a=(this.style.removeProperty(t),R(this,t));return o===a?null:o===n&&a===r?i:i=e(n=o,r=a)}}(t,r)).on("end.style."+t,an(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var r,i,o;return function(){var a=R(this,t),s=n(this),u=s+"";return null==s&&(this.style.removeProperty(t),u=s=R(this,t)),a===u?null:a===r&&u===i?o:(i=u,o=e(r=a,s))}}(t,r,ne(this,"style."+t,e))).each(function(t,e){var n,r,i,o,a="style."+e,s="end."+a;return function(){var u=Ft(this,t),c=u.on,l=null==u.value[a]?o||(o=an(e)):void 0;c===n&&i===l||(r=(n=c).copy()).on(s,i=l),u.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,i,o=n+"";return function(){var a=R(this,t);return a===o?null:a===r?i:i=e(r=a,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,un(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(ne(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,ln(t))},remove:function(){return this.on("end.remove",(t=this._id,function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}));var t},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=Ht(this.node(),n).tween,o=0,a=i.length;o<a;++o)if((r=i[o]).name===t)return r.value;return null}return this.each((null==e?te:ee)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Ze:Je)(e,t)):Ht(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?tn:en)(e,t)):Ht(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(nn(e,t)):Ht(this.node(),e).ease},end:function(){var t,e,n=this,r=n._id,i=n.size();return new Promise((function(o,a){var s={value:a},u={value:function(){0==--i&&o()}};n.each((function(){var n=Ft(this,r),i=n.on;i!==t&&((e=(t=i).copy())._.cancel.push(s),e._.interrupt.push(s),e._.end.push(u)),n.on=e}))}))}};var vn={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function gn(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return vn.time=It(),vn;return n}function En(t){return t.data.name}function mn(){var t,e="string"==typeof(t="body")?new ct([[document.querySelector(t)]],[document.documentElement]):new ct([[t]],ut),n=null,r=En;function i(){n=e.append("div").style("display","none").style("position","absolute").style("opacity",0).style("pointer-events","none").attr("class","d3-flame-graph-tip")}return i.show=function(t){return n.style("display","block").transition().duration(200).style("opacity",1).style("pointer-events","all"),n.html(r(t)).style("left",event.pageX+5+"px").style("top",event.pageY+5+"px"),i},i.hide=function(){return n.style("display","none").transition().duration(200).style("opacity",0).style("pointer-events","none"),i},i.html=function(t){return arguments.length?(r=t,i):r},i}ht.prototype.interrupt=function(t){return this.each((function(){!function(t,e){var n,r,i,o=t.__transition,a=!0;if(o){for(i in e=null==e?null:e+"",o)(n=o[i]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete o[i]):a=!1;a&&delete t.__transition}}(this,t)}))},ht.prototype.transition=function(t){var e,n;t instanceof fn?(e=t._id,t=t._name):(e=dn(),(n=vn).time=It(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],u=s.length,c=0;c<u;++c)(a=s[c])&&Gt(a,t,e,c,s,n||gn(a,e));return new fn(r,this._parents,t,e)}}})},t.exports=n()}));const $c=Object.prototype.hasOwnProperty;function Xc(t){const{input:e}=t,n=C.getLabel(e);if(n)return n;if(t.isRoot())return"Main.main";return function(t){const{defined_class:e,method_id:n}=t;return e&&n?[e,n].join(t.static?".":"#"):_(t)}({defined_class:(e.defined_class||"<unknown>").split(/_|\/|\$|\(.*\)/).filter((t=>t)).pop(),method_id:e.method_id,static:e.static})}const qc={zoom:!1};class Kc extends C.EventSource{constructor(t,n={}){super();const r=f(qc,n);this.container=new H(t,r),this.container.style.display="block",this.timelineGroup=e.select(this.container).append("div").classed("appmap__timeline",!0),this.timelineSelection=this.timelineGroup.append("svg").classed("appmap__timiline-graph",!0)}setCallTree(t){this.callTree=t,this.callTree.on("selectedEvent",(t=>{this.highlight(t,this.callTree.rootEvent)})),this.callTree.on("rootEvent",(()=>{this.render()}))}render(){const{rootEvent:t}=this.callTree;t.postOrderForEach((t=>{t.label=Xc(t),t.value=t.label.length,t.valueChildren=t.children.reduce(((t,e)=>{const n=e.valueChildren||0;return e.value>n?t+e.value:t+n}),0)})),t.preOrderForEach((e=>{e.value=Math.max(e.value,e.valueChildren);const n=e.caller;e!==t&&n&&n.value>n.valueChildren&&(e.value*=n.value/n.valueChildren)}));const e=Yc().width(9*t.value).cellHeight(22).minFrameSize(3).tooltip(!1).getName((t=>t.data.label)).setColorMapper((t=>t.highlight?"#4175ea":$c.call(t.data.input,"http_server_request")?"#471553":$c.call(t.data.input,"sql_query")?"rgba(17, 61, 128, 1)":"rgb(59, 72, 107)"));return this.timelineSelection.html(""),this.timelineSelection.datum(t).call(e),this.timelineSelection.attr("height",e.height()).attr("width",e.width()),this.timelineSelection.selectAll(".frame").on("click",(t=>this.callTree.selectedEvent=t.data)),this}select(t){const e=this.timelineSelection.selectAll("g.frame");e.selectAll("rect").style("opacity","0.4"),e.selectAll("div.d3-flame-graph-label").style("color","#404040");const n=e.filter((e=>e.data===t)).datum().descendants().map((t=>t.data.id)),r=e.filter((t=>n.includes(t.data.id)));r.selectAll("rect").style("opacity",null),r.selectAll("div.d3-flame-graph-label").style("color",null)}highlight(t,n,r=!0){if(this.timelineSelection.select("polyline").remove(),this.highlighted&&this.highlighted.remove(),!t)return;let i=[t,...t.ancestors()].reverse();const o=i.indexOf(n);i=i.slice(o);const a=this.timelineSelection.append("polyline").classed("highlight",!0),s=[],u=[];i.forEach((t=>{const e=this.timelineSelection.selectAll("g.frame").filter((e=>e&&e.data===t)),{x:n,y:r}=function(t){const e=t.node().transform.baseVal.getItem(0).matrix;return{x:e.e,y:e.f}}(e),i=Number(e.attr("width")),o=Number(e.attr("height"));s.push(n,r+o,n,r),u.unshift(n+i,r,n+i,r+o)})),a.attr("points",`${s.join(" ")} ${u.join(" ")}`);const c=this.timelineSelection.selectAll("g").filter((e=>e&&e.data===t));if(this.highlighted=c.insert("rect",":last-child").attr("class","highlight").attr("width",(function(){return e.select(this.parentElement).attr("width")})).attr("height",(function(){return e.select(this.parentElement).attr("height")})),c.node()){const{node:t,label:e}=function(t,e){const n=e.node().transform.baseVal.getItem(0).matrix,r=e.attr("width"),i=e.attr("height"),o=n.e,a=n.f,{clientWidth:s,clientHeight:u}=t.node(),{data:c}=e.data()[0];let l=9*c.value*.5;2*l>s&&(l=9*c.label.length*.5);const h=o+l-.5*s,f=a-.5*u,d=c.label.length;return{node:{top:a,left:o,right:o+r,bottom:a+i,center:{x:h,y:f}},label:{top:a,left:o,right:o+9*d,bottom:a+9,center:{x:o+9*d*.5,y:a+4.5}}}}(this.timelineGroup,c),n=this.timelineGroup.node(),{scrollLeft:i,clientWidth:o}=n,a=.1,s=i+a,u=i+o-a;if(t.left<s||e.right>u){const e={left:t.center.x};r&&(e.behavior="smooth"),n.scrollTo(e)}}}nearestNeighbor(t,e){const n=this.timelineSelection.selectAll("g").filter((e=>e&&e.data&&e.data.id===t.id)).datum();let r,i;return this.timelineSelection.selectAll("g").filter((t=>t&&t.data&&t.depth===n.depth&&(e<0?n.x0>t.x0:n.x0<t.x0))).data().forEach((t=>{const e=Math.abs(t.x0-n.x0);(!r||e&&e<i)&&(r=t,i=e)})),r?r.data:null}}t.ComponentDiagram=Yu,t.FlowView=zc,t.Models=C,t.Timeline=Kc,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=diagrams.js.map
